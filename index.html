&#60;!DOCTYPE html&#62; &#60;html lang="es"&#62; &#60;head&#62; &#60;meta charset="UTF-8"&#62; &#60;meta name="viewport" content="width=device-width, initial-scale=1.0"&#62; &#60;title&#62;Scripts Manager&#60;/title&#62; &#60;style&#62; * { margin: 0;
padding: 0; box-sizing: border-box; } body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Inter', sans-serif; background: #f5f5f5; display: flex; height: 100vh; width: 100vw; margin: 0; padding: 0; overflow: hidden; } /* ============================================
SISTEMA DE SIDEBAR RESPONSIVA CON HAMBURGUESA ============================================ */ /* Bot&#243;n Hamburguesa */ .hamburger-btn { display: none; position: fixed; top: 16px; left: 16px; z-index: 1001; width: 48px; height: 48px; background: white;
border: 1.5px solid #e5e5e5; border-radius: 12px; cursor: pointer; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); transition: all 0.3s ease; } .hamburger-btn:hover { background: #f5f5f5; transform: scale(1.05);
} .hamburger-btn:active { transform: scale(0.95); } /* Overlay para cerrar sidebar */ .sidebar-overlay { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); z-index: 999; opacity: 0; transition: opacity
0.3s ease; } .sidebar-overlay.active { display: block; opacity: 1; } /* Sidebar */ .sidebar { width: 260px; background: white; border-right: 1px solid #e5e5e5; display: flex; flex-direction: column; padding: 20px 14px; overflow-y: auto; transition: transform
0.3s ease; position: relative; } /* Bot&#243;n cerrar sidebar (solo m&#243;viles) */ .sidebar-close-btn { display: none; position: absolute; top: 12px; right: 12px; width: 32px; height: 32px; background: #f5f5f5; border: none; border-radius: 8px; cursor:
pointer; align-items: center; justify-content: center; color: #525252; transition: all 0.2s; z-index: 10; } .sidebar-close-btn:hover { background: #e5e5e5; transform: rotate(90deg); } .sidebar-header { margin-bottom: 32px; } .sidebar-header h1 { font-size:
20px; font-weight: 700; color: #1a1a1a; margin-bottom: 4px; } .sidebar-subtitle { font-size: 13px; color: #737373; } .stats-section { margin-bottom: 32px; } .stat-item { display: flex; justify-content: space-between; align-items: center; padding: 10px
12px; margin-bottom: 4px; border-radius: 8px; font-size: 14px; color: #525252; } .stat-number { font-weight: 700; color: #1a1a1a; font-size: 16px; } .categories-section h3 { font-size: 11px; font-weight: 700; color: #737373; text-transform: uppercase;
letter-spacing: 0.05em; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; } .add-category-btn { background: none; border: none; color: #737373; cursor: pointer; font-size: 16px; padding: 0; width: 20px; height: 20px;
display: flex; align-items: center; justify-content: center; border-radius: 4px; } .add-category-btn:hover { background: #f5f5f5; } .category-input { display: none; margin-bottom: 12px; } .category-input.active { display: flex; gap: 8px; } .category-input
input { flex: 1; padding: 8px 10px; border: 1.5px solid #e5e5e5; border-radius: 6px; font-size: 13px; } .category-input input:focus { outline: none; border-color: #2563eb; } .category-input button { padding: 8px 12px; background: #2563eb; color: white;
border: none; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600; } .category-list { display: flex; flex-direction: column; gap: 2px; } .category-item { padding: 10px 12px; background: transparent; border-radius: 8px; cursor: pointer;
transition: all 0.15s; display: flex; justify-content: space-between; align-items: center; font-size: 14px; color: #525252; } .category-item:hover { background: #f5f5f5; } .category-item.active { background: #2563eb; color: white; } .category-badge {
font-size: 12px; font-weight: 600; color: #737373; } .category-item.active .category-badge { color: rgba(255, 255, 255, 0.8); } .category-icon { margin-right: 8px; } /* Buscador de categor&#237;as */ .category-search-container { position: relative; margin-bottom:
12px; } .category-search-input { width: 100%; padding: 8px 10px 8px 32px; border: 1.5px solid #e5e5e5; border-radius: 6px; font-size: 12px; background: #fafafa; transition: all 0.15s; } .category-search-input:focus { outline: none; border-color: #2563eb;
background: white; } .category-search-input::placeholder { color: #a3a3a3; } .category-search-icon { position: absolute; left: 10px; top: 50%; transform: translateY(-50%); color: #a3a3a3; pointer-events: none; } .category-search-clear { position: absolute;
right: 8px; top: 50%; transform: translateY(-50%); background: none; border: none; color: #737373; cursor: pointer; padding: 4px; display: flex; align-items: center; justify-content: center; border-radius: 4px; transition: all 0.15s; } .category-search-clear:hover
{ background: #e5e5e5; color: #1a1a1a; } .category-item.hidden { display: none; } .category-no-results { padding: 16px 12px; text-align: center; color: #a3a3a3; font-size: 12px; } /* Scrollbar personalizado para sidebar */ .sidebar::-webkit-scrollbar
{ width: 6px; } .sidebar::-webkit-scrollbar-track { background: #f5f5f5; } .sidebar::-webkit-scrollbar-thumb { background: #d4d4d4; border-radius: 3px; } .sidebar::-webkit-scrollbar-thumb:hover { background: #a3a3a3; } /* Main Content */ .main-content
{ flex: 1; display: flex; flex-direction: column; overflow: hidden; width: 100%; height: 100vh; margin: 0; padding: 0; } .main-header { background: white; padding: 12px 20px; border-bottom: 1px solid #e5e5e5; width: 100%; margin: 0; box-sizing: border-box;
} .header-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; } .header-top h2 { font-size: 24px; font-weight: 700; color: #1a1a1a; } .header-subtitle { font-size: 14px; color: #737373; } .btn-new-script { padding:
10px 20px; background: #2563eb; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 14px; display: flex; align-items: center; gap: 6px; transition: all 0.15s; } .btn-new-script:hover { background: #1d4ed8; } .search-container
{ position: relative; } .search-input { width: 100%; padding: 10px 14px 10px 38px; border: 1.5px solid #e5e5e5; border-radius: 8px; font-size: 14px; background: #fafafa; } .search-input:focus { outline: none; border-color: #2563eb; background: white;
} .search-icon { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: #a3a3a3; } /* Sistema de Filtros */ .filters-toggle { display: flex; align-items: center; gap: 8px; margin-top: 16px; padding: 8px 0; } .toggle-filters-btn
{ display: flex; align-items: center; gap: 6px; padding: 8px 14px; background: #f5f5f5; border: 1px solid #e5e5e5; border-radius: 8px; cursor: pointer; font-size: 13px; font-weight: 600; color: #525252; transition: all 0.2s; } .toggle-filters-btn:hover
{ background: #e5e5e5; } .toggle-filters-btn.active { background: #2563eb; border-color: #2563eb; color: white; } .toggle-filters-btn svg { transition: transform 0.2s; } .toggle-filters-btn.active svg { transform: rotate(180deg); } .filters-panel { display:
none; gap: 12px; padding: 16px; background: #fafafa; border: 1px solid #e5e5e5; border-radius: 10px; margin-top: 12px; animation: slideDown 0.3s ease-out; } .filters-panel.active { display: flex; flex-wrap: wrap; } @keyframes slideDown { from { opacity:
0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } } .filter-group { display: flex; flex-direction: column; gap: 8px; flex: 1; min-width: 200px; } .filter-label { font-size: 11px; font-weight: 700; color: #737373; text-transform:
uppercase; letter-spacing: 0.05em; } .filter-options { display: flex; gap: 6px; flex-wrap: wrap; } .filter-option { padding: 8px 14px; background: white; border: 1.5px solid #e5e5e5; border-radius: 8px; cursor: pointer; font-size: 13px; color: #525252;
transition: all 0.15s; font-weight: 500; } .filter-option:hover { border-color: #2563eb; background: #eff6ff; } .filter-option.active { background: #2563eb; border-color: #2563eb; color: white; font-weight: 600; } .filter-divider { width: 1px; background:
#e5e5e5; margin: 0 8px; } .active-filters-count { display: inline-flex; align-items: center; justify-content: center; min-width: 18px; height: 18px; padding: 0 5px; background: #2563eb; color: white; border-radius: 9px; font-size: 11px; font-weight: 700;
margin-left: 4px; } /* Botones de acci&#243;n r&#225;pida */ .quick-action-buttons { display: flex; gap: 8px; margin-left: auto; } .btn-quick-action { display: flex; align-items: center; gap: 8px; padding: 8px 16px; background: white; border: 1.5px solid
#e5e5e5; border-radius: 8px; cursor: pointer; font-size: 13px; font-weight: 600; color: #525252; transition: all 0.2s; } .btn-quick-action:hover { background: #f5f5f5; border-color: #2563eb; } .btn-quick-action:active { transform: scale(0.98); } .btn-quick-action.copied
{ background: #22c55e; border-color: #22c55e; color: white; } .btn-quick-action:disabled { opacity: 0.5; cursor: not-allowed; background: #fafafa; } .btn-quick-action:disabled:hover { border-color: #e5e5e5; } .btn-quick-action svg { flex-shrink: 0; }
/* Tooltips para atajos de teclado */ .btn-quick-action { position: relative; } .btn-quick-action::after { content: attr(data-shortcut); position: absolute; bottom: -32px; left: 50%; transform: translateX(-50%) scale(0.9); background: #1a1a1a; color:
white; padding: 6px 10px; border-radius: 6px; font-size: 11px; font-weight: 600; white-space: nowrap; opacity: 0; pointer-events: none; transition: all 0.2s ease; z-index: 1000; font-family: 'Courier New', monospace; letter-spacing: 0.5px; } /* Ocultar
tooltips en pantallas t&#225;ctiles */ @media (hover: none) and (pointer: coarse) { .btn-quick-action::after, .btn-copy-path::after, .btn-copy-export-path::after, .path-text::after, .btn-copy-prompt-clean::after { display: none !important; } } .btn-quick-action:hover::after
{ opacity: 1; transform: translateX(-50%) scale(1); bottom: -36px; } /* Tooltips para botones de copia de ruta - Mostrar atajo de teclado */ .btn-copy-path, .btn-copy-export-path { position: relative; } /* Tooltip del BOT&#211;N: Muestra el atajo de teclado
*/ .btn-copy-path::after, .btn-copy-export-path::after { content: attr(data-shortcut); position: absolute; bottom: -32px; left: 50%; transform: translateX(-50%) scale(0.9); background: #1a1a1a; color: white; padding: 6px 10px; border-radius: 6px; font-size:
11px; font-weight: 600; white-space: nowrap; opacity: 0; pointer-events: none; transition: all 0.2s ease; z-index: 1000; font-family: 'Courier New', monospace; letter-spacing: 0.5px; } .btn-copy-path:hover::after, .btn-copy-export-path:hover::after {
opacity: 1; transform: translateX(-50%) scale(1); bottom: -36px; } /* Tooltip del TEXTO DE LA RUTA: Muestra la ruta completa */ .path-text { position: relative; cursor: help; } .path-text::after { content: attr(data-full-path); position: absolute; bottom:
-42px; left: 0; transform: translateY(0) scale(0.9); background: #1a1a1a; color: white; padding: 8px 12px; border-radius: 6px; font-size: 11px; font-weight: 500; white-space: nowrap; max-width: 500px; overflow: hidden; text-overflow: ellipsis; opacity:
0; pointer-events: none; transition: all 0.2s ease; z-index: 999; font-family: 'Courier New', monospace; letter-spacing: 0.3px; } .path-text:hover::after { opacity: 1; transform: translateY(0) scale(1); bottom: -46px; } .scripts-container { flex: 1; overflow-y:
auto; padding: 12px 16px; width: 100%; height: 100%; margin: 0; } .scripts-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 12px; width: 100%; margin: 0; padding: 0; } @media (max-width: 900px) { .scripts-grid {
grid-template-columns: 1fr; } } @media (max-width: 1200px) and (min-width: 901px) { .scripts-grid { grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); } } .script-card { background: white; border: 1px solid #e5e5e5; border-radius: 10px; padding:
16px; transition: all 0.2s; position: relative; margin: 0; height: fit-content; box-sizing: border-box; } .script-card:hover { box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); } .script-card.used { border-color: #86efac; background: #f0fdf4; } .script-card.fade-out
{ animation: fadeOut 0.3s ease-out forwards; } @keyframes fadeOut { from { opacity: 1; transform: scale(1); } to { opacity: 0; transform: scale(0.95); } } .script-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom:
12px; } .script-title { font-size: 16px; font-weight: 700; color: #1a1a1a; margin-bottom: 4px; } .script-status-indicator { width: 12px; height: 12px; border-radius: 50%; background: #d4d4d4; flex-shrink: 0; margin-top: 4px; } .script-card.used .script-status-indicator
{ background: #22c55e; } .script-meta { display: flex; align-items: center; gap: 8px; margin-bottom: 12px; font-size: 12px; color: #737373; } .script-category-badge { padding: 4px 10px; background: #e5e5e5; border-radius: 6px; font-weight: 600; } .script-content
{ color: #525252; font-size: 13px; line-height: 1.6; margin-bottom: 16px; max-height: 80px; overflow: hidden; position: relative; } .script-content::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 30px; background: linear-gradient(transparent,
white); } .script-card.used .script-content::after { background: linear-gradient(transparent, #f0fdf4); } .empty-state { text-align: center; padding: 80px 20px; color: #a3a3a3; } .empty-state h3 { font-size: 18px; color: #525252; margin-bottom: 8px; }
/* Modal */ .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); z-index: 1000; align-items: center; justify-content: center; } .modal.active { display: flex; } .modal-content { background: white;
border-radius: 16px; width: 90%; max-width: 600px; max-height: 90vh; position: relative; display: flex; flex-direction: column; overflow: hidden; transition: all 0.3s ease; } @media (max-width: 900px) { .modal-content { width: 95%; max-width: 95%; max-height:
85vh; } } @media (max-width: 768px) { .modal-content { width: 100%; height: 100vh; max-height: 100vh; border-radius: 0; } } .modal-header { padding: 24px 24px 16px; border-bottom: 1px solid #e5e5e5; display: flex; justify-content: space-between; align-items:
center; background: white; flex-shrink: 0; position: sticky; top: 0; z-index: 10; } .modal-title-section { flex: 1; } .modal-title { font-size: 20px; font-weight: 700; color: #1a1a1a; margin-bottom: 4px; } .category-path-container { margin-top: 12px;
padding: 12px 16px; background: #fafafa; border: 1.5px solid #e5e5e5; border-radius: 10px; display: flex; align-items: center; gap: 10px; } .path-icon { color: #737373; flex-shrink: 0; } .path-content { flex: 1; min-width: 0; } .path-label { font-size:
10px; font-weight: 700; color: #737373; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 4px; } .path-text { font-size: 13px; color: #1a1a1a; font-family: 'Courier New', monospace; word-break: break-all; line-height: 1.4; } .btn-copy-path
{ padding: 8px 14px; background: white; border: 1.5px solid #e5e5e5; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: 600; color: #525252; display: flex; align-items: center; gap: 6px; transition: all 0.15s; flex-shrink: 0; } .btn-copy-path:hover
{ background: #2563eb; border-color: #2563eb; color: white; } .btn-copy-path.copied { background: #22c55e; border-color: #22c55e; color: white; } /* Bot&#243;n de Copiar Ruta de Exportaci&#243;n - Color Verde Diferenciado */ .btn-copy-export-path { padding:
8px 14px; background: white; border: 1.5px solid #22c55e; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: 600; color: #16a34a; display: flex; align-items: center; gap: 6px; transition: all 0.15s; flex-shrink: 0; position: relative;
} .btn-copy-export-path:hover { background: #16a34a; border-color: #16a34a; color: white; } .btn-copy-export-path.copied { background: #22c55e; border-color: #22c55e; color: white; } .btn-copy-export-path::after { content: attr(data-shortcut); position:
absolute; bottom: -32px; left: 50%; transform: translateX(-50%) scale(0.9); background: #1a1a1a; color: white; padding: 6px 10px; border-radius: 6px; font-size: 11px; font-weight: 600; white-space: nowrap; opacity: 0; pointer-events: none; transition:
all 0.2s ease; z-index: 1000; font-family: 'Courier New', monospace; letter-spacing: 0.5px; } .btn-copy-export-path:hover::after { opacity: 1; transform: translateX(-50%) scale(1); bottom: -36px; } /* Bot&#243;n de Copiar Prompt Limpio (sin contenedor
de ruta) */ .btn-copy-prompt-clean { width: 100%; padding: 12px 16px; background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); border: 1.5px solid #f59e0b; border-radius: 10px; cursor: pointer; font-size: 13px; font-weight: 600; color: white; display:
flex; align-items: center; justify-content: center; gap: 8px; transition: all 0.2s; position: relative; box-shadow: 0 2px 8px rgba(245, 158, 11, 0.2); } .btn-copy-prompt-clean:hover { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); border-color:
#d97706; transform: translateY(-2px); box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3); } .btn-copy-prompt-clean.copied { background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); border-color: #16a34a; } .btn-copy-prompt-clean svg { flex-shrink: 0;
} /* Tooltip mejorado para botones de prompt - Formato limpio para textos largos */ .btn-copy-prompt-clean { position: relative; } .btn-copy-prompt-clean::after { content: attr(data-tooltip); position: absolute; bottom: -60px; left: 50%; transform: translateX(-50%)
scale(0.9); background: #1a1a1a; color: white; padding: 12px 16px; border-radius: 8px; font-size: 11px; font-weight: 400; white-space: pre-wrap; max-width: 500px; max-height: 200px; overflow-y: auto; opacity: 0; pointer-events: none; /* Se mantiene none
por defecto */ transition: all 0.3s ease; z-index: 1000; line-height: 1.6; text-align: left; box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4); font-family: 'Courier New', monospace; word-wrap: break-word; } .btn-copy-prompt-clean:hover::after { opacity: 1; transform:
translateX(-50%) scale(1); bottom: -65px; pointer-events: auto; /* CORRECCI&#211;N: Habilitar interacci&#243;n al hacer hover */ } /* Mantener tooltip visible mientras se interact&#250;a con &#233;l */ .btn-copy-prompt-clean::after:hover { opacity: 1;
pointer-events: auto; } /* Scrollbar personalizado para tooltips largos */ .btn-copy-prompt-clean::after::-webkit-scrollbar { width: 4px; } .btn-copy-prompt-clean::after::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.1); border-radius: 2px;
} .btn-copy-prompt-clean::after::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.3); border-radius: 2px; } .btn-copy-prompt-clean::after::-webkit-scrollbar-thumb:hover { background: rgba(255, 255, 255, 0.5); } .btn-copy-prompt-clean:hover::after
{ opacity: 1; transform: translateX(-50%) scale(1); bottom: -55px; } .category-input-group { display: flex; flex-direction: column; gap: 8px; } .category-input-row { display: flex; gap: 8px; } .category-input input.path-input { font-size: 12px; font-family:
'Courier New', monospace; } /* Botones de acci&#243;n en categor&#237;as */ .category-item-content { display: flex; align-items: center; gap: 8px; flex: 1; } .category-actions { display: flex; gap: 4px; opacity: 0; transition: opacity 0.2s; } .category-item:hover
.category-actions { opacity: 1; } .category-item.active .category-actions { opacity: 1; } .category-action-btn { width: 24px; height: 24px; border: none; background: rgba(0, 0, 0, 0.05); border-radius: 6px; cursor: pointer; display: flex; align-items:
center; justify-content: center; color: #525252; transition: all 0.15s; padding: 0; } .category-action-btn:hover { background: rgba(0, 0, 0, 0.1); transform: scale(1.1); } .category-item.active .category-action-btn { background: rgba(255, 255, 255, 0.15);
color: white; } .category-item.active .category-action-btn:hover { background: rgba(255, 255, 255, 0.25); } .category-action-btn.delete:hover { background: #fee2e2; color: #ef4444; } .category-item.active .category-action-btn.delete:hover { background:
rgba(239, 68, 68, 0.2); color: #fca5a5; } /* Modal de edici&#243;n de categor&#237;a */ .edit-category-highlight { background: #eff6ff; padding: 12px 16px; border-radius: 8px; margin-bottom: 20px; border-left: 3px solid #2563eb; } .edit-category-highlight
.current-name { font-size: 13px; color: #737373; margin-bottom: 4px; } .edit-category-highlight .name-display { font-size: 16px; font-weight: 700; color: #1a1a1a; } .warning-box { background: #fef3c7; border: 1.5px solid #fbbf24; border-radius: 8px; padding:
12px 16px; margin-bottom: 20px; display: flex; gap: 10px; align-items: flex-start; } .warning-icon { color: #f59e0b; flex-shrink: 0; margin-top: 2px; } .warning-content { flex: 1; } .warning-title { font-size: 13px; font-weight: 700; color: #92400e; margin-bottom:
4px; } .warning-text { font-size: 12px; color: #78350f; line-height: 1.5; } .scripts-affected { display: inline-flex; align-items: center; justify-content: center; min-width: 20px; height: 20px; padding: 0 6px; background: #f59e0b; color: white; border-radius:
10px; font-size: 11px; font-weight: 700; margin-left: 4px; } .category-dot { width: 8px; height: 8px; border-radius: 50%; background: #ef4444; } .modal-actions-top { display: flex; gap: 8px; } .icon-btn { width: 36px; height: 36px; border: none; background:
#f5f5f5; border-radius: 8px; cursor: pointer; display: flex; align-items: center; justify-content: center; color: #525252; transition: all 0.15s; } .icon-btn:hover { background: #e5e5e5; } .icon-btn.delete:hover { background: #fef2f2; color: #ef4444;
} .icon-btn:hover:not(.delete) { background: #eff6ff; color: #2563eb; } .btn-close { background: none; border: none; font-size: 24px; cursor: pointer; color: #737373; padding: 0; width: 36px; height: 36px; display: flex; align-items: center; justify-content:
center; border-radius: 8px; } .btn-close:hover { background: #f5f5f5; } .modal-body { padding: 24px; overflow-y: auto; flex: 1; } .script-full-content { background: #fafafa; padding: 20px; border-radius: 10px; line-height: 1.8; font-size: 14px; color:
#1a1a1a; margin-bottom: 20px; white-space: pre-wrap; border: 1px solid #e5e5e5; } .script-date { font-size: 12px; color: #737373; margin-bottom: 20px; } .modal-footer { padding: 16px 24px; border-top: 1px solid #e5e5e5; display: flex; gap: 8px; background:
white; flex-shrink: 0; position: sticky; bottom: 0; z-index: 10; } .nav-btn { width: 40px; height: 40px; border: 1px solid #e5e5e5; background: white; border-radius: 8px; cursor: pointer; display: flex; align-items: center; justify-content: center; color:
#525252; } .nav-btn:hover { background: #f5f5f5; } .btn-mark-used { flex: 1; padding: 10px 20px; border: 1px solid #e5e5e5; background: white; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 14px; color: #525252; display: flex; align-items:
center; justify-content: center; gap: 8px; } .btn-mark-used:hover { background: #f5f5f5; } .btn-mark-used.marked { background: #f0fdf4; border-color: #86efac; color: #16a34a; } .btn-copy-script { flex: 1; padding: 10px 20px; background: #2563eb; color:
white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 14px; display: flex; align-items: center; justify-content: center; gap: 8px; } .btn-copy-script:hover { background: #1d4ed8; } /* Form Modal */ .form-group { margin-bottom:
20px; } .form-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #1a1a1a; font-size: 14px; } .form-group input, .form-group textarea, .form-group select { width: 100%; padding: 10px 12px; border: 1.5px solid #e5e5e5; border-radius:
8px; font-size: 14px; font-family: inherit; background: #fafafa; } .form-group input:focus, .form-group textarea:focus, .form-group select:focus { outline: none; border-color: #2563eb; background: white; } .form-group select option[value=""] { color:
#a3a3a3; font-style: italic; } .form-group select option:not([value=""]) { color: #1a1a1a; } .form-group textarea { min-height: 200px; resize: vertical; line-height: 1.6; } /* Formularios responsivos */ @media (max-width: 768px) { .form-group input, .form-group
textarea, .form-group select { font-size: 16px; /* Previene zoom en iOS */ } .form-actions { flex-direction: column; } .btn-cancel, .btn-save { width: 100%; } } .form-actions { display: flex; gap: 12px; margin-top: 24px; } .btn-cancel { flex: 1; padding:
10px 20px; border: 1px solid #e5e5e5; background: white; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 14px; } .btn-save { flex: 1; padding: 10px 20px; background: #2563eb; color: white; border: none; border-radius: 8px; cursor: pointer;
font-weight: 600; font-size: 14px; } /* Sistema de Pesta&#195;&#177;as (Tabs) */ .modal-tabs { display: flex; gap: 0; border-bottom: 2px solid #e5e5e5; margin: -24px -24px 24px -24px; padding: 0 24px; background: #fafafa; } @media (max-width: 768px) {
.modal-tabs { padding: 0 16px; } .tab-button, .config-tab-button { padding: 12px 16px; font-size: 12px; } .tab-button svg, .config-tab-button svg { width: 14px; height: 14px; } } .tab-button { flex: 1; padding: 16px 24px; background: transparent; border:
none; border-bottom: 3px solid transparent; cursor: pointer; font-weight: 600; font-size: 14px; color: #737373; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; gap: 10px; position: relative; } .tab-button:hover
{ color: #2563eb; background: rgba(37, 99, 235, 0.05); } .tab-button.active { color: #2563eb; border-bottom-color: #2563eb; background: white; } .tab-button svg { transition: transform 0.3s ease; } .tab-button.active svg { transform: scale(1.1); } /*
Contenido de las pesta&#195;&#177;as */ .tab-content { display: none; animation: fadeInTab 0.4s ease-out; } .tab-content.active { display: block; } @keyframes fadeInTab { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0);
} } /* Estilos para carga masiva de guiones */ .bulk-info { background: #eff6ff; border: 1.5px solid #bfdbfe; border-radius: 8px; padding: 12px 16px; margin-bottom: 16px; font-size: 12px; color: #1e40af; line-height: 1.6; } .bulk-info strong { font-weight:
700; color: #1e3a8a; } .bulk-info code { background: #dbeafe; padding: 2px 6px; border-radius: 4px; font-family: 'Courier New', monospace; color: #1e3a8a; } .file-input-wrapper { position: relative; overflow: hidden; display: inline-block; width: 100%;
margin-bottom: 12px; } .file-input-wrapper input[type=file] { position: absolute; left: -9999px; } .file-input-label { display: flex; align-items: center; justify-content: center; gap: 10px; padding: 12px 16px; background: white; border: 2px dashed #d1d5db;
border-radius: 8px; cursor: pointer; transition: all 0.2s; font-size: 13px; color: #525252; font-weight: 600; } .file-input-label:hover { border-color: #2563eb; background: #f9fafb; color: #2563eb; } .file-input-label.has-file { border-color: #22c55e;
background: #f0fdf4; color: #16a34a; border-style: solid; } .btn-bulk-add { width: 100%; padding: 12px 20px; background: #2563eb; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 14px; display: flex; align-items:
center; justify-content: center; gap: 8px; transition: all 0.2s; } .btn-bulk-add:hover { background: #1d4ed8; transform: translateY(-1px); } .btn-bulk-add:active { transform: translateY(0); } .btn-bulk-add:disabled { background: #d1d5db; cursor: not-allowed;
transform: none; } .bulk-result { margin-top: 16px; padding: 12px 16px; border-radius: 8px; font-size: 13px; font-weight: 600; display: none; align-items: center; gap: 10px; } .bulk-result.success { display: flex; background: #f0fdf4; border: 1.5px solid
#86efac; color: #16a34a; } .bulk-result.error { display: flex; background: #fef2f2; border: 1.5px solid #fca5a5; color: #dc2626; } .bulk-result.warning { display: flex; background: #fef3c7; border: 1.5px solid #fbbf24; color: #92400e; } /* ============================================
SISTEMA DE SELECCI&#195;N M&#195;LTIPLE ============================================ */ .selection-mode-bar { position: fixed; bottom: 0; left: 0; right: 0; background: #1a1a1a; color: white; padding: 16px 32px; display: none; align-items: center; gap:
16px; z-index: 999; box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.15); animation: slideUpBar 0.3s ease-out; } .selection-mode-bar.active { display: flex; } @keyframes slideUpBar { from { transform: translateY(100%); } to { transform: translateY(0); } } .selection-info
{ display: flex; align-items: center; gap: 12px; flex: 1; } .selection-count { background: #2563eb; padding: 6px 14px; border-radius: 20px; font-weight: 700; font-size: 14px; } .selection-text { font-size: 14px; color: #e5e5e5; } .selection-actions {
display: flex; gap: 12px; } .btn-selection-action { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 14px; display: flex; align-items: center; gap: 8px; transition: all 0.2s; } .btn-cancel-selection {
background: #3f3f46; color: white; } .btn-cancel-selection:hover { background: #52525b; } .btn-delete-selected { background: #ef4444; color: white; } .btn-delete-selected:hover { background: #dc2626; transform: translateY(-1px); } .script-card { position:
relative; cursor: pointer; } .script-card.selection-mode { cursor: pointer; user-select: none; } .script-card.selected { border-color: #2563eb; background: #eff6ff; transform: scale(0.98); } .script-checkbox { position: absolute; top: 16px; right: 16px;
width: 24px; height: 24px; border: 2px solid #d4d4d4; border-radius: 6px; background: white; display: none; align-items: center; justify-content: center; transition: all 0.2s; z-index: 10; } .script-card.selection-mode .script-checkbox { display: flex;
} .script-card.selected .script-checkbox { background: #2563eb; border-color: #2563eb; } .script-checkbox svg { display: none; color: white; } .script-card.selected .script-checkbox svg { display: block; } .btn-select-mode { display: flex; align-items:
center; gap: 8px; padding: 8px 16px; background: white; border: 1.5px solid #e5e5e5; border-radius: 8px; cursor: pointer; font-size: 13px; font-weight: 600; color: #525252; transition: all 0.2s; } .btn-select-mode:hover { background: #f5f5f5; border-color:
#2563eb; } .btn-select-mode.active { background: #2563eb; border-color: #2563eb; color: white; } /* ============================================ MODAL DE CONFIRMACI&#195;N IN-APP ============================================ */ .confirm-dialog { display:
none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.6); z-index: 2000; align-items: center; justify-content: center; animation: fadeIn 0.2s ease-out; } .confirm-dialog.active { display: flex; } @keyframes fadeIn {
from { opacity: 0; } to { opacity: 1; } } .confirm-content { background: white; border-radius: 16px; padding: 32px; max-width: 450px; width: 90%; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3); animation: scaleIn 0.3s ease-out; } @keyframes scaleIn { from
{ transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } } .confirm-icon { width: 56px; height: 56px; background: #fee2e2; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; } .confirm-icon
svg { color: #ef4444; } .confirm-title { font-size: 20px; font-weight: 700; color: #1a1a1a; text-align: center; margin-bottom: 12px; } .confirm-message { font-size: 14px; color: #737373; text-align: center; line-height: 1.6; margin-bottom: 24px; } .confirm-actions
{ display: flex; gap: 12px; } .btn-confirm { flex: 1; padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 14px; transition: all 0.2s; } .btn-confirm-cancel { background: #f5f5f5; color: #525252; } .btn-confirm-cancel:hover
{ background: #e5e5e5; } .btn-confirm-delete { background: #ef4444; color: white; } .btn-confirm-delete:hover { background: #dc2626; transform: translateY(-1px); } /* ============================================ ESTILOS PARA MODAL DE CONFIGURACI&#211;N
REDISE&#209;ADO ============================================ */ .config-tabs-container { background: #fafafa; border-bottom: 2px solid #e5e5e5; } .config-tabs { display: flex; padding: 0 32px; gap: 4px; } .config-tab-button { flex: 1; max-width: 250px;
padding: 16px 24px; background: transparent; border: none; border-bottom: 3px solid transparent; cursor: pointer; font-weight: 600; font-size: 14px; color: #737373; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center;
gap: 10px; position: relative; } .config-tab-button:hover { color: #2563eb; background: rgba(37, 99, 235, 0.05); } .config-tab-button.active { color: #2563eb; border-bottom-color: #2563eb; background: white; } .config-tab-button svg { transition: transform
0.3s ease; } .config-tab-button.active svg { transform: scale(1.1); } .config-tab-content-wrapper { overflow-y: auto; max-height: calc(95vh - 240px); } .config-tab-content { display: none; animation: fadeInTab 0.4s ease-out; } .config-tab-content.active
{ display: block; } .config-control-card { background: white; border: 2px solid #e5e5e5; border-radius: 12px; padding: 20px; transition: all 0.3s ease; } .config-control-card:hover { border-color: #2563eb; box-shadow: 0 4px 16px rgba(37, 99, 235, 0.1);
} .config-control-header { display: flex; align-items: center; gap: 16px; margin-bottom: 20px; } .config-control-icon { width: 48px; height: 48px; border-radius: 12px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow:
0 2px 8px rgba(0, 0, 0, 0.1); } .config-control-label { font-size: 11px; font-weight: 700; color: #737373; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 4px; } .config-control-value { font-size: 32px; font-weight: 700; color: #1a1a1a;
line-height: 1; } .config-control-body { display: flex; flex-direction: column; gap: 8px; } .config-slider { width: 100%; height: 8px; border-radius: 5px; background: linear-gradient(90deg, #e5e5e5 0%, #2563eb 50%, #e5e5e5 100%); outline: none; -webkit-appearance:
none; appearance: none; } .config-slider::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 24px; height: 24px; border-radius: 50%; background: white; border: 3px solid #2563eb; cursor: pointer; box-shadow: 0 2px 8px rgba(37, 99,
235, 0.4); transition: all 0.2s; } .config-slider::-webkit-slider-thumb:hover { transform: scale(1.2); box-shadow: 0 3px 12px rgba(37, 99, 235, 0.6); } .config-slider::-moz-range-thumb { width: 24px; height: 24px; border-radius: 50%; background: white;
border: 3px solid #2563eb; cursor: pointer; box-shadow: 0 2px 8px rgba(37, 99, 235, 0.4); transition: all 0.2s; } .config-slider::-moz-range-thumb:hover { transform: scale(1.2); box-shadow: 0 3px 12px rgba(37, 99, 235, 0.6); } .config-slider-labels {
display: flex; justify-content: space-between; font-size: 11px; color: #a3a3a3; padding: 0 4px; } .config-help-text { font-size: 12px; color: #737373; background: #f5f5f5; padding: 8px 12px; border-radius: 6px; margin-top: 4px; } /* Estilos para tarjetas
de prompts colapsables */ .prompt-category-card { background: white; border: 2px solid #e5e5e5; border-radius: 12px; margin-bottom: 16px; overflow: hidden; transition: all 0.3s ease; } .prompt-category-card:hover { border-color: #22c55e; box-shadow: 0
4px 12px rgba(34, 197, 94, 0.1); } .prompt-category-header { display: flex; align-items: center; justify-content: space-between; padding: 16px 20px; cursor: pointer; background: #fafafa; transition: all 0.2s; } .prompt-category-header:hover { background:
#f0fdf4; } .prompt-category-header.active { background: #f0fdf4; border-bottom: 1px solid #e5e5e5; } .prompt-category-info { display: flex; align-items: center; gap: 12px; flex: 1; } .prompt-category-icon { width: 40px; height: 40px; background: linear-gradient(135deg,
#22c55e 0%, #16a34a 100%); border-radius: 10px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 2px 6px rgba(34, 197, 94, 0.2); } .prompt-category-title { font-size: 14px; font-weight: 700; color: #1a1a1a; margin-bottom:
2px; } .prompt-category-count { font-size: 11px; color: #737373; } .prompt-chevron { transition: transform 0.3s ease; color: #737373; } .prompt-chevron.active { transform: rotate(180deg); } .prompt-category-body { display: none; padding: 20px; animation:
slideDown 0.3s ease-out; } .prompt-category-body.active { display: block; } .prompt-textarea { width: 100%; min-height: 100px; padding: 12px 16px; border: 2px solid #e5e5e5; border-radius: 10px; font-size: 13px; font-family: inherit; background: #fafafa;
resize: vertical; line-height: 1.6; transition: all 0.2s; } .prompt-textarea:focus { outline: none; border-color: #22c55e; background: white; box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1); } .prompt-hint { display: flex; align-items: center; gap: 8px;
margin-top: 12px; padding: 10px 14px; background: #fef3c7; border: 1px solid #fbbf24; border-radius: 8px; font-size: 12px; color: #78350f; } .prompt-hint code { background: white; padding: 2px 8px; border-radius: 4px; color: #f59e0b; font-weight: 600;
font-family: 'Courier New', monospace; } /* ============================================ REDISE&#209;O MODAL DE VISTA DE GUION ============================================ */ .modal-content-wide { background: white; border-radius: 20px; width: 95%; max-width:
1400px; height: 90vh; position: relative; display: flex; flex-direction: column; overflow: hidden; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3); } .view-modal-header { display: flex; align-items: center; justify-content: space-between; padding: 20px 28px;
border-bottom: 1px solid #e5e5e5; background: white; flex-shrink: 0; } .view-header-left { display: flex; align-items: center; gap: 16px; flex: 1; } .view-header-right { display: flex; align-items: center; gap: 12px; } .nav-circle-btn, .icon-circle-btn
{ width: 36px; height: 36px; border-radius: 50%; border: 1.5px solid #e5e5e5; background: white; cursor: pointer; display: flex; align-items: center; justify-content: center; color: #525252; transition: all 0.2s; } .nav-circle-btn:hover, .icon-circle-btn:hover
{ background: #f5f5f5; border-color: #2563eb; color: #2563eb; transform: scale(1.05); } .icon-circle-btn.delete-btn:hover { background: #fef2f2; border-color: #ef4444; color: #ef4444; } .btn-close-circle { width: 36px; height: 36px; border-radius: 50%;
border: 1.5px solid #e5e5e5; background: white; cursor: pointer; display: flex; align-items: center; justify-content: center; color: #737373; font-size: 24px; font-weight: 300; transition: all 0.2s; } .btn-close-circle:hover { background: #f5f5f5; color:
#1a1a1a; transform: rotate(90deg); } .view-title-group { display: flex; align-items: center; gap: 12px; flex: 1; } .view-title { font-size: 20px; font-weight: 700; color: #1a1a1a; margin: 0; } .view-category-pill { padding: 6px 14px; background: #eff6ff;
border: 1px solid #bfdbfe; border-radius: 20px; font-size: 12px; font-weight: 600; color: #2563eb; } /* Layout de Dos Paneles */ .view-two-panel-layout { display: flex; flex: 1; overflow: hidden; } .view-main-panel { flex: 1; overflow-y: auto; padding:
32px 40px; background: #fafafa; } .view-script-wrapper { max-width: 800px; margin: 0 auto; } .view-date-stamp { font-size: 12px; color: #a3a3a3; margin-bottom: 24px; padding-bottom: 12px; border-bottom: 1px solid #e5e5e5; } .view-script-content { background:
white; padding: 24px; border-radius: 12px; line-height: 1.8; font-size: 15px; color: #1a1a1a; white-space: pre-wrap; border: 1px solid #e5e5e5; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04); font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
} /* Panel Lateral */ .view-sidebar-panel { width: 380px; background: white; border-left: 1px solid #e5e5e5; overflow-y: auto; flex-shrink: 0; } .sidebar-panel-content { padding: 24px; } .sidebar-section-title { display: flex; align-items: center; gap:
8px; font-size: 11px; font-weight: 700; color: #737373; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 16px; } /* M&#233;tricas */ .metrics-section { margin-bottom: 32px; } .metrics-grid { display: grid; grid-template-columns: 1fr;
gap: 12px; } .metric-card { padding: 16px; border-radius: 12px; display: flex; align-items: center; gap: 16px; transition: all 0.2s; } .metric-card.metric-blue { background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border: 1.5px solid #bfdbfe;
} .metric-card.metric-green { background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); border: 1.5px solid #86efac; } .metric-card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); } .metric-icon { width: 44px; height:
44px; border-radius: 12px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; } .metric-blue .metric-icon { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; } .metric-green .metric-icon { background:
linear-gradient(135deg, #22c55e 0%, #16a34a 100%); color: white; } .metric-content { flex: 1; } .metric-label { font-size: 11px; font-weight: 600; color: #737373; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 4px; } .metric-value {
font-size: 28px; font-weight: 700; line-height: 1; margin-bottom: 4px; } .metric-blue .metric-value { color: #1e40af; } .metric-green .metric-value { color: #166534; } .metric-subtitle { font-size: 11px; color: #a3a3a3; } /* Acciones */ .actions-section
{ margin-bottom: 24px; } .sidebar-action-btn { width: 100%; padding: 14px 16px; background: white; border: 1.5px solid #e5e5e5; border-radius: 12px; cursor: pointer; display: flex; align-items: center; gap: 12px; transition: all 0.2s; margin-bottom: 10px;
text-align: left; } .sidebar-action-btn:hover { background: #fafafa; border-color: #d4d4d4; transform: translateX(2px); } .sidebar-action-btn.prompt-btn { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-color: #fbbf24; } .sidebar-action-btn.prompt-btn:hover
{ background: linear-gradient(135deg, #fde68a 0%, #fcd34d 100%); border-color: #f59e0b; } .sidebar-action-btn.path-btn:hover { border-color: #2563eb; background: #eff6ff; } .sidebar-action-btn.export-btn { border-color: #86efac; } .sidebar-action-btn.export-btn:hover
{ background: #f0fdf4; border-color: #22c55e; } .action-btn-icon { width: 36px; height: 36px; border-radius: 10px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; } .prompt-btn .action-btn-icon { background: linear-gradient(135deg,
#fbbf24 0%, #f59e0b 100%); color: white; } .path-btn .action-btn-icon { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; } .export-btn .action-btn-icon { background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); color:
white; } .action-btn-content { flex: 1; min-width: 0; } .action-btn-title { font-size: 13px; font-weight: 600; color: #1a1a1a; margin-bottom: 2px; } .action-btn-subtitle { font-size: 11px; color: #737373; } .action-btn-path { font-size: 11px; color: #737373;
font-family: 'Courier New', monospace; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; } .action-btn-shortcut { font-size: 11px; color: #a3a3a3; font-weight: 600; font-family: 'Courier New', monospace; } /* Estado */ .status-section {
display: grid; grid-template-columns: 1fr; gap: 10px; } .sidebar-status-btn { width: 100%; padding: 14px 16px; border: 1.5px solid #e5e5e5; background: white; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 14px; color: #525252; display:
flex; align-items: center; justify-content: center; gap: 10px; transition: all 0.2s; } .sidebar-status-btn:hover { background: #f5f5f5; } .sidebar-status-btn.marked { background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); border-color: #86efac;
color: #16a34a; } .status-btn-icon { display: flex; align-items: center; justify-content: center; } .sidebar-copy-btn { width: 100%; padding: 14px 16px; background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); color: white; border: none; border-radius:
12px; cursor: pointer; font-weight: 600; font-size: 14px; display: flex; align-items: center; justify-content: center; gap: 10px; transition: all 0.2s; box-shadow: 0 2px 8px rgba(37, 99, 235, 0.3); } .sidebar-copy-btn:hover { background: linear-gradient(135deg,
#1d4ed8 0%, #1e40af 100%); transform: translateY(-2px); box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4); } /* Responsive */ @media (max-width: 1200px) { .view-sidebar-panel { width: 320px; } } /* Vista de dos paneles responsive mejorada */ @media (max-width:
968px) { .modal-content-wide { width: 98%; height: 95vh; } .view-two-panel-layout { flex-direction: column; } .view-sidebar-panel { width: 100%; border-left: none; border-top: 1px solid #e5e5e5; } } /* Ajuste adicional para 824x768 y similares */ @media
(max-width: 900px) { .view-two-panel-layout { flex-direction: column; overflow: hidden; } .view-sidebar-panel { width: 100%; max-height: 50vh; border-left: none; border-top: 1px solid #e5e5e5; overflow-y: auto; flex-shrink: 0; } .view-main-panel { overflow-y:
auto; max-height: 50vh; flex: 1; } /* Ajustar padding en paneles para m&#243;viles */ .view-main-panel { padding: 20px 24px; } .sidebar-panel-content { padding: 20px; } /* Mejorar visualizaci&#243;n de m&#233;tricas en m&#243;vil */ .metric-card { padding:
14px; } .metric-icon { width: 40px; height: 40px; } .metric-value { font-size: 24px; } /* Ajustar botones de acci&#243;n */ .sidebar-action-btn { padding: 12px 14px; } .action-btn-icon { width: 32px; height: 32px; } .action-btn-title { font-size: 12px;
} .action-btn-subtitle { font-size: 10px; } } /* Estilos para Sliders de Configuraci&#243;n */ input[type="range"] { -webkit-appearance: none; appearance: none; } input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; appearance: none;
width: 20px; height: 20px; border-radius: 50%; background: #2563eb; cursor: pointer; box-shadow: 0 2px 6px rgba(37, 99, 235, 0.4); transition: all 0.2s; } input[type="range"]::-webkit-slider-thumb:hover { transform: scale(1.2); box-shadow: 0 3px 8px rgba(37,
99, 235, 0.6); } input[type="range"]::-moz-range-thumb { width: 20px; height: 20px; border-radius: 50%; background: #2563eb; cursor: pointer; border: none; box-shadow: 0 2px 6px rgba(37, 99, 235, 0.4); transition: all 0.2s; } input[type="range"]::-moz-range-thumb:hover
{ transform: scale(1.2); box-shadow: 0 3px 8px rgba(37, 99, 235, 0.6); } /* ============================================ M&#211;DULO DE REFERENCIAS VISUALES ============================================ */ .visual-references-section { margin-top: 16px;
padding-top: 16px; border-top: 2px solid #e5e5e5; } .visual-references-header { display: flex; align-items: center; gap: 12px; margin-bottom: 20px; } .visual-references-icon { width: 40px; height: 40px; background: linear-gradient(135deg, #8b5cf6 0%,
#7c3aed 100%); border-radius: 10px; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 6px rgba(139, 92, 246, 0.3); } .visual-references-title-group h3 { font-size: 16px; font-weight: 700; color: #1a1a1a; margin: 0 0 4px 0;
} .visual-references-subtitle { font-size: 12px; color: #737373; } .visual-references-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 8px; width: 100%; padding: 0; } @media (max-width: 768px) { .visual-references-grid
{ grid-template-columns: 1fr; } } .visual-reference-card { background: #fafafa; border: 2px solid #e5e5e5; border-radius: 10px; padding: 12px; transition: all 0.3s ease; } .visual-reference-card:hover { border-color: #8b5cf6; box-shadow: 0 4px 12px rgba(139,
92, 246, 0.1); } .visual-reference-label { display: flex; align-items: center; gap: 8px; font-size: 12px; font-weight: 700; color: #737373; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 12px; } .visual-reference-label svg { color:
#8b5cf6; } .visual-reference-preview { position: relative; width: 100%; height: 140px; background: white; border: 2px dashed #d1d5db; border-radius: 8px; display: flex; align-items: center; justify-content: center; overflow: hidden; margin-bottom: 10px;
transition: all 0.2s; } .visual-reference-preview.has-image { border-style: solid; border-color: #8b5cf6; } .visual-reference-preview img { max-width: 100%; max-height: 100%; object-fit: contain; } .visual-reference-placeholder { display: flex; flex-direction:
column; align-items: center; gap: 8px; color: #a3a3a3; } .visual-reference-placeholder svg { opacity: 0.5; } .visual-reference-placeholder-text { font-size: 11px; text-align: center; } .visual-reference-actions { display: flex; gap: 8px; } .visual-reference-input
{ display: none; } .btn-upload-reference, .btn-remove-reference { flex: 1; padding: 8px 12px; border: 1.5px solid #e5e5e5; border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: 600; display: flex; align-items: center; justify-content: center;
gap: 6px; transition: all 0.2s; } .btn-upload-reference { background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); border-color: #8b5cf6; color: white; } .btn-upload-reference:hover { background: linear-gradient(135deg, #7c3aed 0%, #6d28d9 100%);
transform: translateY(-1px); box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3); } .btn-remove-reference { background: white; color: #ef4444; } .btn-remove-reference:hover { background: #fef2f2; border-color: #ef4444; } .btn-remove-reference:disabled { opacity:
0.5; cursor: not-allowed; background: #fafafa; } .btn-remove-reference:disabled:hover { transform: none; background: #fafafa; border-color: #e5e5e5; } /* Visualizaci&#243;n en el M&#243;dulo de Prompts */ .prompts-references-panel { padding: 10px 16px;
background: #fafafa; border-bottom: 1px solid #e5e5e5; } .prompts-references-header { display: flex; align-items: center; gap: 8px; margin-bottom: 10px; } .prompts-references-header-icon { width: 28px; height: 28px; background: linear-gradient(135deg,
#8b5cf6 0%, #7c3aed 100%); border-radius: 6px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; } .prompts-references-title { font-size: 12px; font-weight: 700; color: #1a1a1a; margin: 0; } .prompts-references-header { display:
flex; align-items: center; gap: 10px; margin-bottom: 16px; } .prompts-references-header-icon { width: 32px; height: 32px; background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); border-radius: 8px; display: flex; align-items: center; justify-content:
center; } .prompts-references-title { font-size: 13px; font-weight: 700; color: #1a1a1a; margin: 0; } /* &#10024; DISE&#209;O VERTICAL OPTIMIZADO - Todas las resoluciones */ .prompts-references-grid { display: flex; flex-direction: column; gap: 8px; }
.prompts-reference-item { display: flex; flex-direction: column; gap: 0; background: white; border: 1.5px solid #e5e5e5; border-radius: 8px; padding: 10px; transition: all 0.3s ease; overflow: hidden; } .prompts-reference-item:hover { border-color: #8b5cf6;
box-shadow: 0 2px 6px rgba(139, 92, 246, 0.1); } .prompts-reference-image-container { width: 100%; height: 100px; background: #f5f5f5; border-radius: 6px; overflow: hidden; margin-bottom: 0; } .prompts-reference-image-container img { width: 100%; height:
100%; object-fit: cover; } /* &#10024; NUEVO: Bot&#243;n de descarga minimalista con estilo profesional */ .btn-download-reference-minimal { width: 100%; padding: 12px 16px; border: 1.5px solid; border-radius: 10px; cursor: pointer; font-size: 12px; font-weight:
500; display: flex; align-items: center; gap: 10px; transition: all 0.3s ease; margin-top: 10px; } .btn-download-reference-minimal:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); filter: brightness(1.05); } .btn-download-reference-minimal:active
{ transform: translateY(0); } .btn-download-reference-minimal svg:first-child { flex-shrink: 0; } .btn-download-reference-minimal span { flex: 1; text-align: left; } .prompts-references-empty { text-align: center; padding: 24px; color: #a3a3a3; font-size:
12px; } /* ============================================ SISTEMA RESPONSIVO COMPLETO OPTIMIZADO ============================================ */ /* Tablets y resoluciones intermedias (1024px - 768px) */ @media (max-width: 1024px) { .sidebar { width: 220px;
padding: 16px 12px; } .sidebar-header h1 { font-size: 18px; } .stat-item { padding: 8px 10px; font-size: 13px; } .main-header { padding: 20px 24px; } .scripts-grid { grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 12px; } } /* Resoluciones
peque&#241;as tipo 824x768 y tablets verticales */ @media (max-width: 900px) { /* Mostrar bot&#243;n hamburguesa */ .hamburger-btn { display: flex; } /* Sidebar como men&#250; lateral deslizable */ .sidebar { position: fixed; top: 0; left: 0; bottom:
0; width: 280px; z-index: 1000; transform: translateX(-100%); box-shadow: 2px 0 12px rgba(0, 0, 0, 0.1); } .sidebar.active { transform: translateX(0); } /* Mostrar bot&#243;n cerrar en sidebar */ .sidebar-close-btn { display: flex; } /* Contenido principal
ocupa todo el ancho */ body { flex-direction: column; } .main-content { width: 100%; margin-left: 0; } .main-header { padding: 72px 20px 16px; /* Espacio para hamburguesa */ } .header-top { flex-wrap: wrap; gap: 12px; } .header-top h2 { font-size: 20px;
} .btn-new-script { width: 100%; justify-content: center; } /* Filtros en columna */ .filters-toggle { flex-direction: column; gap: 8px; } .toggle-filters-btn { width: 100%; } .quick-action-buttons { width: 100%; display: grid; grid-template-columns:
1fr 1fr; gap: 8px; } .filters-panel { flex-direction: column; } .filter-group { width: 100%; min-width: auto; } /* Scripts en una columna */ .scripts-grid { grid-template-columns: 1fr; } .scripts-container { padding: 16px 20px; } /* Modales ocupan m&#225;s
espacio */ .modal-content, .modal-content-wide { width: 95%; max-width: 95%; height: 90vh; max-height: 90vh; } .view-two-panel-layout { flex-direction: column; } .view-sidebar-panel { width: 100%; max-height: 45vh; border-left: none; border-top: 1px solid
#e5e5e5; } .view-main-panel { flex: 1; overflow-y: auto; padding: 24px 28px; background: #fafafa; } /* Barra de selecci&#243;n */ .selection-mode-bar { padding: 12px 16px; flex-wrap: wrap; } .selection-actions { width: 100%; margin-top: 8px; } } /* M&#243;viles
(768px hacia abajo) */ @media (max-width: 768px) { .hamburger-btn { width: 44px; height: 44px; top: 12px; left: 12px; } .sidebar { width: 85%; max-width: 320px; } .main-header { padding: 64px 16px 12px; } .header-top h2 { font-size: 18px; } .search-input
{ font-size: 16px; /* Previene zoom en iOS */ padding: 10px 12px 10px 38px; } .quick-action-buttons { grid-template-columns: 1fr; } .btn-quick-action { font-size: 13px; padding: 10px 14px; } .scripts-container { padding: 12px 16px; } .script-card { padding:
16px; } .script-title { font-size: 15px; } /* Modales pantalla completa en m&#243;viles */ .modal-content, .modal-content-wide { width: 100%; height: 100vh; max-height: 100vh; border-radius: 0; } .modal-header { padding: 16px; } .modal-body { padding:
16px; } .form-group input, .form-group textarea, .form-group select { font-size: 16px; /* Previene zoom en iOS */ } .form-actions { flex-direction: column; } .btn-cancel, .btn-save { width: 100%; } /* Vista de script */ .view-modal-header { padding: 12px
16px; flex-wrap: wrap; } .view-header-left { width: 100%; margin-bottom: 8px; } .view-title { font-size: 16px; } .view-script-content { padding: 20px; font-size: 14px; } .sidebar-panel-content { padding: 16px; } .metric-card { padding: 12px; } .metric-value
{ font-size: 24px; } /* Generador de prompts */ .prompts-generator-content { width: 100%; height: 100vh; border-radius: 0; } .prompts-generator-body { flex-direction: column; } .prompts-input-panel { width: 100%; max-height: 35vh; border-right: none;
border-bottom: 1px solid #e5e5e5; } .prompts-display-footer { padding: 12px 16px; } .prompts-actions-row { flex-direction: column; gap: 8px; } .prompts-btn-prev, .prompts-btn-copy-current, .prompts-btn-next { width: 100%; } /* Barra de selecci&#243;n
*/ .selection-mode-bar { padding: 12px 16px; flex-wrap: wrap; } .selection-actions { width: 100%; margin-top: 8px; } .btn-selection-action { flex: 1; font-size: 12px; padding: 8px 12px; } /* Configuraci&#243;n */ .config-tabs { padding: 0 16px; } .config-tab-button
{ font-size: 12px; padding: 12px 16px; } .config-control-card { padding: 16px; } .config-control-value { font-size: 24px; } /* Tabs */ .modal-tabs { padding: 0 16px; } .tab-button { padding: 12px 16px; font-size: 12px; } } /* M&#243;viles peque&#241;os
(480px hacia abajo) */ @media (max-width: 480px) { .hamburger-btn { width: 40px; height: 40px; } .sidebar { width: 90%; } .main-header { padding: 60px 12px 12px; } .header-top h2 { font-size: 16px; } .stat-item { font-size: 12px; padding: 6px 8px; } .stat-number
{ font-size: 14px; } .category-item { font-size: 12px; padding: 8px 10px; } .script-card { padding: 12px; } .script-title { font-size: 14px; } .script-content { font-size: 12px; max-height: 60px; } .nav-circle-btn, .icon-circle-btn, .btn-close-circle
{ width: 32px; height: 32px; } .view-title { font-size: 14px; } .view-category-pill { font-size: 11px; padding: 4px 10px; } .metric-value { font-size: 20px; } .config-control-value { font-size: 20px; } .btn-selection-action { font-size: 12px; padding:
8px 12px; } } /* Landscape en m&#243;viles */ @media (max-width: 900px) and (orientation: landscape) { .sidebar { max-height: 100vh; } .modal-content, .modal-content-wide { height: 95vh; } .view-two-panel-layout { flex-direction: row; } .view-sidebar-panel
{ width: 40%; max-height: 100%; border-left: 1px solid #e5e5e5; border-top: none; } .view-main-panel { width: 60%; max-height: 100%; } } /* ============================================ M&#211;DULO DE GENERACI&#211;N DE IM&#193;GENES/VIDEO ============================================
*/ .prompts-generator-modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.6); z-index: 3000; align-items: center; justify-content: center; } .prompts-generator-modal.active { display: flex; } .prompts-generator-content
{ background: white; border-radius: 16px; width: 98%; max-width: 1400px; height: 95vh; display: flex; flex-direction: column; overflow: hidden; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3); } .prompts-generator-header { display: flex; align-items: center;
justify-content: space-between; padding: 16px 24px; border-bottom: 1px solid #e5e5e5; background: white; flex-shrink: 0; } .prompts-header-left { display: flex; align-items: center; gap: 16px; flex: 1; } .prompts-header-icon { width: 48px; height: 48px;
background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3); } .prompts-header-title-group h2 { font-size: 20px; font-weight:
700; color: #1a1a1a; margin: 0 0 4px 0; } .prompts-header-subtitle { font-size: 13px; color: #737373; } .prompts-generator-body { display: flex; flex: 1; overflow: hidden; } /* Panel Izquierdo - Input y Referencias */ .prompts-input-panel { width: 380px;
background: #fafafa; border-right: 1px solid #e5e5e5; display: flex; flex-direction: column; overflow-y: auto; flex-shrink: 0; } .prompts-input-content { padding: 24px; } .prompts-input-section-title { display: flex; align-items: center; gap: 8px; font-size:
11px; font-weight: 700; color: #737373; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 16px; } .prompts-paste-area { width: 100%; min-height: 200px; max-height: 40vh; padding: 16px; border: 2px dashed #d1d5db; border-radius: 12px; font-size:
13px; font-family: inherit; background: white; resize: vertical; line-height: 1.6; transition: all 0.2s; } .prompts-paste-area:focus { outline: none; border-color: #fbbf24; border-style: solid; background: #fffbeb; box-shadow: 0 0 0 3px rgba(251, 191,
36, 0.1); } .prompts-paste-area::placeholder { color: #a3a3a3; } .prompts-input-hint { display: flex; align-items: start; gap: 10px; margin-top: 12px; padding: 12px 14px; background: #eff6ff; border: 1.5px solid #bfdbfe; border-radius: 8px; font-size:
12px; color: #1e40af; line-height: 1.6; } .prompts-btn-process { width: 100%; padding: 14px 16px; background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); color: white; border: none; border-radius: 12px; cursor: pointer; font-weight: 600; font-size:
14px; display: flex; align-items: center; justify-content: center; gap: 10px; transition: all 0.2s; box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3); } .prompts-btn-process:hover { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); transform:
translateY(-2px); box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4); } .prompts-btn-process:disabled { opacity: 0.5; cursor: not-allowed; transform: none; } /* Panel Derecho - Visualizaci&#243;n de Prompts */ .prompts-display-panel { flex: 1; display: flex;
flex-direction: column; overflow: hidden; background: #f5f5f5; } .prompts-waiting-state, .prompts-completed-state { display: none; flex-direction: column; align-items: center; justify-content: center; flex: 1; padding: 48px; text-align: center; color:
#737373; } .prompts-waiting-state.active, .prompts-completed-state.active { display: flex; } .prompts-waiting-icon, .prompts-completed-icon { width: 64px; height: 64px; background: #e5e5e5; border-radius: 16px; display: flex; align-items: center; justify-content:
center; margin-bottom: 24px; color: #a3a3a3; } .prompts-completed-icon { background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); color: #16a34a; } .prompts-waiting-title, .prompts-completed-title { font-size: 20px; font-weight: 700; color: #1a1a1a;
margin-bottom: 8px; } .prompts-waiting-text, .prompts-completed-text { font-size: 14px; max-width: 400px; line-height: 1.6; } .prompts-active-state { display: none; flex-direction: column; flex: 1; overflow: hidden; } .prompts-active-state.active { display:
flex; } .prompts-display-content { flex: 1; overflow-y: auto; padding: 24px; } .prompts-current-wrapper { max-width: 800px; margin: 0 auto; width: 100%; } .prompts-current-badge { display: inline-flex; align-items: center; gap: 8px; padding: 6px 14px;
background: white; border: 1.5px solid #e5e5e5; border-radius: 20px; font-size: 12px; font-weight: 700; color: #525252; margin-bottom: 16px; } .prompts-current-content { background: white; padding: 24px; border-radius: 12px; border: 1px solid #e5e5e5;
font-size: 15px; line-height: 1.8; color: #1a1a1a; white-space: pre-wrap; word-wrap: break-word; position: relative; overflow: hidden; transition: max-height 0.3s ease; max-height: calc(100vh - 400px); } .prompts-current-content.expanded { max-height:
80vh; overflow-y: auto; } .prompts-current-content::-webkit-scrollbar { width: 6px; } .prompts-current-content::-webkit-scrollbar-track { background: #f5f5f5; } .prompts-current-content::-webkit-scrollbar-thumb { background: #d4d4d4; border-radius: 3px;
} .prompts-current-content:not(.expanded)::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 80px; background: linear-gradient(transparent, white); pointer-events: none; } .prompts-read-more-btn { display: none; width: 100%;
margin-top: 16px; padding: 10px 20px; background: #fafafa; border: 1.5px solid #e5e5e5; border-radius: 10px; cursor: pointer; font-size: 13px; font-weight: 600; color: #525252; transition: all 0.2s; display: flex; align-items: center; justify-content:
center; gap: 8px; } .prompts-read-more-btn.visible { display: flex; } .prompts-read-more-btn:hover { background: white; border-color: #2563eb; color: #2563eb; } .prompts-read-more-btn svg { transition: transform 0.3s ease; } .prompts-read-more-btn.expanded
svg { transform: rotate(180deg); } .prompts-display-footer { padding: 16px 24px; border-top: 1px solid #e5e5e5; background: #fafafa; flex-shrink: 0; } .prompts-actions-row { display: flex; gap: 12px; max-width: 800px; margin: 0 auto; } .prompts-btn-prev,
.prompts-btn-copy-current, .prompts-btn-next { padding: 14px 20px; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 14px; display: flex; align-items: center; justify-content: center; gap: 10px; transition: all 0.2s; } .prompts-btn-prev
{ flex: 1; background: white; border: 1.5px solid #e5e5e5; color: #525252; } .prompts-btn-prev:hover:not(:disabled) { background: #f5f5f5; border-color: #2563eb; } .prompts-btn-prev:disabled { opacity: 0.5; cursor: not-allowed; } .prompts-btn-copy-current
{ flex: 2; background: white; border: 1.5px solid #e5e5e5; color: #525252; } .prompts-btn-copy-current:hover { background: #f5f5f5; border-color: #2563eb; } .prompts-btn-copy-current.copied { background: #f0fdf4; border-color: #22c55e; color: #16a34a;
} .prompts-btn-next { flex: 2; background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); color: white; border: none; box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3); } .prompts-btn-next:hover { background: linear-gradient(135deg, #f59e0b 0%, #d97706
100%); transform: translateY(-2px); } .prompts-btn-next.finish { background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); } .prompts-btn-reset { margin-top: 24px; background: white; border: 1.5px solid #e5e5e5; color: #525252; } .prompts-btn-reset:hover
{ background: #f5f5f5; border-color: #fbbf24; } /* Responsive para el generador */ @media (max-width: 968px) { .prompts-generator-body { flex-direction: column; } .prompts-input-panel { width: 100%; border-right: none; border-bottom: 1px solid #e5e5e5;
max-height: 45vh; /* M&#225;s espacio para el input en m&#243;vil */ } .prompts-paste-area { min-height: 120px; } .prompts-display-content { padding: 16px; } .prompts-current-content { padding: 16px; font-size: 14px; max-height: calc(100vh - 450px); }
.prompts-actions-row { flex-direction: column; } } @media (max-width: 480px) { .prompts-header-title-group h2 { font-size: 18px; } .prompts-btn-prev, .prompts-btn-copy-current, .prompts-btn-next { padding: 12px 16px; font-size: 13px; } .prompts-current-content
{ font-size: 13px; } } /* Optimizaci&#243;n m&#225;xima para escritorio grande */ @media (min-width: 1400px) { .scripts-grid { grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 16px; padding: 8px 4px; } .main-header { padding: 14px 28px;
} .scripts-container { padding: 8px 20px; } } /* Mejora en tablets */ @media (max-width: 1024px) and (min-width: 769px) { .scripts-grid { grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 10px; } .script-card { padding: 14px; } } /* Ajuste
fino para m&#243;viles */ @media (max-width: 768px) { .scripts-container { padding: 8px 12px; } .scripts-grid { gap: 8px; } .script-card { padding: 12px; margin: 0 2px; } } /* --- INICIO C&#211;DIGO NUEVO FILTROS --- */ .filter-creation-card { background:
#fff; border: 1px solid #e5e5e5; border-radius: 12px; padding: 20px; margin-bottom: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.02); } .filter-inputs-row { display: flex; gap: 12px; align-items: center; margin-bottom: 16px; } .filter-arrow { color: #a3a3a3;
flex-shrink: 0; } .category-tags-selector { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px; padding: 12px; background: #fafafa; border-radius: 8px; border: 1px solid #f0f0f0; } .cat-tag-option { font-size: 11px; padding: 6px 12px; border-radius:
16px; background: #fff; border: 1px solid #e5e5e5; cursor: pointer; transition: all 0.2s; user-select: none; font-weight: 500; color: #525252; } .cat-tag-option:hover { border-color: #2563eb; color: #2563eb; } .cat-tag-option.selected { background: #eff6ff;
border-color: #2563eb; color: #2563eb; font-weight: 600; } .filter-item-card { display: flex; align-items: center; justify-content: space-between; background: white; border: 1px solid #e5e5e5; border-radius: 10px; padding: 16px; margin-bottom: 8px; transition:
all 0.2s; } .filter-item-card:hover { border-color: #cbd5e1; box-shadow: 0 4px 12px rgba(0,0,0,0.05); } .filter-words-display { display: flex; align-items: center; gap: 12px; font-size: 14px; font-weight: 600; color: #1a1a1a; } .filter-replacement-arrow
{ color: #2563eb; background: #eff6ff; padding: 4px; border-radius: 4px; } .filter-categories-badges { display: flex; gap: 4px; margin-top: 6px; } .mini-cat-badge { font-size: 10px; padding: 2px 8px; background: #f5f5f5; border-radius: 4px; color: #737373;
border: 1px solid #e5e5e5; } .btn-add-filter { width: 100%; padding: 12px; background: #1a1a1a; color: white; border: none; border-radius: 8px; font-weight: 600; font-size: 13px; cursor: pointer; transition: all 0.2s; } .btn-add-filter:hover { background:
#000; transform: translateY(-1px); } .prompts-current-badge { display: inline-flex; align-items: center; gap: 12px; /* Aumentamos el gap para dar espacio al LED */ padding: 6px 14px; background: white; /* ... resto de estilos existentes ... */ } /* ---
NUEVOS ESTILOS PARA EL LED --- */ .scene-coherence-led { width: 12px; height: 12px; border-radius: 50%; background-color: #d1d5db; /* Color por defecto/apagado */ box-shadow: 0 0 8px rgba(0,0,0,0.1); transition: all 0.3s ease; flex-shrink: 0; } .scene-coherence-led.creation
{ background-color: #f59e0b; /* Naranja: Iniciar un nuevo ciclo de creaci&#243;n */ box-shadow: 0 0 10px #f59e0b, inset 0 0 3px white; } .scene-coherence-led.coherence { background-color: #22c55e; /* Verde: Mantener coherencia con la escena anterior */
box-shadow: 0 0 10px #22c55e, inset 0 0 3px white; } /* --- FIN DE NUEVOS ESTILOS --- */ /* --- FIN C&#211;DIGO NUEVO FILTROS --- */ /* --- INICIO C&#211;DIGO NUEVO SECCI&#211;N VISUALES PERSONALIZADAS --- */ .custom-visuals-details { margin-bottom: 24px;
border: 1px solid #e5e5e5; border-radius: 10px; overflow: hidden; } .custom-visuals-summary { display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: #fafafa; cursor: pointer; font-size: 13px; font-weight: 600; color: #525252; list-style:
none; /* Ocultar flecha por defecto */ transition: background 0.2s; } .custom-visuals-summary:hover { background: #f5f5f5; } .custom-visuals-summary::-webkit-details-marker { display: none; /* Ocultar flecha en Chrome/Safari */ } .summary-chevron { margin-left:
auto; transition: transform 0.3s ease; } .custom-visuals-details[open] &#62; .custom-visuals-summary .summary-chevron { transform: rotate(180deg); } .custom-visuals-content { padding: 16px; border-top: 1px solid #e5e5e5; } .custom-visuals-info { font-size:
12px; color: #737373; background: #eff6ff; padding: 10px 14px; border-radius: 8px; border: 1px solid #bfdbfe; margin-bottom: 16px; line-height: 1.6; } /* Estilo para mostrar la imagen de categor&#237;a como fallback */ .visual-reference-preview.fallback-preview
img { opacity: 0.4; filter: grayscale(80%); border: 2px dashed #a3a3a3; border-radius: 6px; box-sizing: border-box; } /* --- FIN C&#211;DIGO NUEVO --- */ &#60;/style&#62; &#60;/head&#62; &#60;body&#62; &#60;!-- Bot&#243;n Hamburguesa (solo visible en
m&#243;viles) --&#62; &#60;button class="hamburger-btn" id="hamburgerBtn" onclick="toggleSidebar()"&#62; &#60;svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;line x1="3" y1="12" x2="21" y2="12"&#62;&#60;/line&#62;
&#60;line x1="3" y1="6" x2="21" y2="6"&#62;&#60;/line&#62; &#60;line x1="3" y1="18" x2="21" y2="18"&#62;&#60;/line&#62; &#60;/svg&#62; &#60;/button&#62; &#60;!-- Overlay para cerrar sidebar en m&#243;viles --&#62; &#60;div class="sidebar-overlay" id="sidebarOverlay"
onclick="toggleSidebar()"&#62;&#60;/div&#62; &#60;div class="sidebar" id="mainSidebar"&#62; &#60;!-- Bot&#243;n cerrar sidebar (solo m&#243;viles) --&#62; &#60;button class="sidebar-close-btn" onclick="toggleSidebar()"&#62; &#60;svg width="20" height="20"
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;line x1="18" y1="6" x2="6" y2="18"&#62;&#60;/line&#62; &#60;line x1="6" y1="6" x2="18" y2="18"&#62;&#60;/line&#62; &#60;/svg&#62; &#60;/button&#62; &#60;div class="sidebar-header"&#62;
&#60;h1&#62;Scripts Manager&#60;/h1&#62; &#60;p class="sidebar-subtitle"&#62;Organiza tus guiones&#60;/p&#62; &#60;/div&#62; &#60;div class="stats-section"&#62; &#60;div class="stat-item"&#62; &#60;span&#62;Total de guiones&#60;/span&#62; &#60;span class="stat-number"
id="totalScripts"&#62;0&#60;/span&#62; &#60;/div&#62; &#60;div class="stat-item"&#62; &#60;span&#62;Disponibles&#60;/span&#62; &#60;span class="stat-number" id="availableScripts"&#62;0&#60;/span&#62; &#60;/div&#62; &#60;div class="stat-item"&#62; &#60;span&#62;Utilizados&#60;/span&#62;
&#60;span class="stat-number" id="usedScripts"&#62;0&#60;/span&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Bot&#243;n de Configuraci&#243;n --&#62; &#60;button onclick="openConfigModal()" style=" width: 100%; padding: 12px 16px; background: linear-gradient(135deg,
#2563eb 0%, #1d4ed8 100%); color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: 600; font-size: 14px; display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 24px; transition: all 0.2s; box-shadow:
0 2px 8px rgba(37, 99, 235, 0.2); " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(37, 99, 235, 0.3)';" onmouseout="this.style.transform=''; this.style.boxShadow='0 2px 8px rgba(37, 99, 235, 0.2)';"&#62; &#60;svg
width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;circle cx="12" cy="12" r="3"&#62;&#60;/circle&#62; &#60;path d="M12 1v6m0 6v6m-9-9h6m6 0h6"&#62;&#60;/path&#62; &#60;path d="m19.07 4.93-4.24 4.24m0
6.66 4.24 4.24M4.93 19.07l4.24-4.24m0-6.66L4.93 4.93"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;span&#62;Configuraci&#243;n&#60;/span&#62; &#60;/button&#62; &#60;div class="categories-section"&#62; &#60;h3&#62; CATEGOR&#205;AS &#60;button class="add-category-btn"
onclick="toggleCategoryInput()"&#62;+&#60;/button&#62; &#60;/h3&#62; &#60;!-- Buscador de categor&#237;as --&#62; &#60;div class="category-search-container"&#62; &#60;svg class="category-search-icon" width="14" height="14" viewBox="0 0 24 24" fill="none"
stroke="currentColor" stroke-width="2"&#62; &#60;circle cx="11" cy="11" r="8"&#62;&#60;/circle&#62; &#60;path d="m21 21-4.35-4.35"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;input type="text" class="category-search-input" id="categorySearchInput" placeholder="Buscar
categor&#237;a..." oninput="handleCategorySearch()" &#62; &#60;button class="category-search-clear" id="categorySearchClear" onclick="clearCategorySearch()" style="display: none;"&#62; &#60;svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor"
stroke-width="2"&#62; &#60;line x1="18" y1="6" x2="6" y2="18"&#62;&#60;/line&#62; &#60;line x1="6" y1="6" x2="18" y2="18"&#62;&#60;/line&#62; &#60;/svg&#62; &#60;/button&#62; &#60;/div&#62; &#60;div class="category-input" id="categoryInput"&#62; &#60;div
class="category-input-group"&#62; &#60;input type="text" id="newCategoryInput" placeholder="Nombre de la categor&#237;a" style="width: 100%;"&#62; &#60;!-- === INICIO C&#211;DIGO NUEVO === --&#62; &#60;div style="margin-top: 8px;"&#62; &#60;label style="font-size:
11px; font-weight: 600; color: #737373; display: block; margin-bottom: 6px;"&#62;TIPO DE CONTENIDO&#60;/label&#62; &#60;div id="newCategoryTypeSelector" style="display: flex; gap: 6px;"&#62; &#60;button type="button" class="filter-option active" data-type="short"
onclick="selectCategoryType(this, 'newCategoryTypeSelector')"&#62;Corto&#60;/button&#62; &#60;button type="button" class="filter-option" data-type="long" onclick="selectCategoryType(this, 'newCategoryTypeSelector')"&#62;Largo&#60;/button&#62; &#60;/div&#62;
&#60;/div&#62; &#60;!-- === FIN C&#211;DIGO NUEVO === --&#62; &#60;div class="category-input-row"&#62; &#60;input type="text" id="newCategoryPath" placeholder="Ruta de los clips (opcional)" class="path-input" style="flex: 1;"&#62; &#60;/div&#62; &#60;div
class="category-input-row"&#62; &#60;input type="text" id="newCategoryExportPath" placeholder="Ruta de exportaci&#243;n del video (requerido)" class="path-input" style="flex: 1;"&#62; &#60;/div&#62; &#60;div class="category-input-row"&#62; &#60;textarea
id="newCategoryPrompt" placeholder="Prompt de generaci&#243;n (opcional - usa (X) para n&#250;mero de escenas)" class="path-input" style="flex: 1; min-height: 60px; resize: vertical; font-family: inherit; font-size: 12px;"&#62;&#60;/textarea&#62; &#60;/div&#62;
&#60;!-- &#10024; NUEVA SECCI&#211;N: Referencias Visuales Compactas --&#62; &#60;div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e5e5e5;"&#62; &#60;div style="font-size: 10px; font-weight: 700; color: #737373; text-transform: uppercase;
letter-spacing: 0.05em; margin-bottom: 8px; display: flex; align-items: center; gap: 6px;"&#62; &#60;svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;rect x="3" y="3" width="18" height="18" rx="2"
ry="2"&#62;&#60;/rect&#62; &#60;circle cx="8.5" cy="8.5" r="1.5"&#62;&#60;/circle&#62; &#60;polyline points="21 15 16 10 5 21"&#62;&#60;/polyline&#62; &#60;/svg&#62; Referencias Visuales (Opcional) &#60;/div&#62; &#60;!-- Mini Referencias --&#62; &#60;div
style="display: flex; flex-direction: column; gap: 6px;"&#62; &#60;!-- Asunto --&#62; &#60;div style="display: flex; align-items: center; gap: 6px;"&#62; &#60;input type="file" id="newInputAsunto" accept="image/*" style="display: none;" onchange="handleNewReferenceUpload('asunto',
event)"&#62; &#60;label for="newInputAsunto" style="flex: 1; padding: 6px 10px; background: white; border: 1.5px dashed #d1d5db; border-radius: 6px; cursor: pointer; font-size: 11px; color: #737373; display: flex; align-items: center; gap: 6px; transition:
all 0.2s;" onmouseover="this.style.borderColor='#8b5cf6'; this.style.background='#f5f3ff';" onmouseout="this.style.borderColor='#d1d5db'; this.style.background='white';"&#62; &#60;svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
stroke-width="2"&#62; &#60;circle cx="12" cy="12" r="10"&#62;&#60;/circle&#62; &#60;circle cx="12" cy="12" r="3"&#62;&#60;/circle&#62; &#60;/svg&#62; &#60;span id="newLabelAsunto"&#62;Asunto&#60;/span&#62; &#60;/label&#62; &#60;button type="button" id="newBtnRemoveAsunto"
onclick="removeNewReference('asunto')" disabled style="padding: 6px; background: #fef2f2; border: 1.5px solid #fecaca; border-radius: 6px; cursor: pointer; opacity: 0.5;"&#62; &#60;svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#ef4444"
stroke-width="2"&#62; &#60;line x1="18" y1="6" x2="6" y2="18"&#62;&#60;/line&#62; &#60;line x1="6" y1="6" x2="18" y2="18"&#62;&#60;/line&#62; &#60;/svg&#62; &#60;/button&#62; &#60;/div&#62; &#60;!-- Escena --&#62; &#60;div style="display: flex; align-items:
center; gap: 6px;"&#62; &#60;input type="file" id="newInputEscena" accept="image/*" style="display: none;" onchange="handleNewReferenceUpload('escena', event)"&#62; &#60;label for="newInputEscena" style="flex: 1; padding: 6px 10px; background: white;
border: 1.5px dashed #d1d5db; border-radius: 6px; cursor: pointer; font-size: 11px; color: #737373; display: flex; align-items: center; gap: 6px; transition: all 0.2s;" onmouseover="this.style.borderColor='#8b5cf6'; this.style.background='#f5f3ff';" onmouseout="this.style.borderColor='#d1d5db';
this.style.background='white';"&#62; &#60;svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;rect x="2" y="7" width="20" height="14" rx="2" ry="2"&#62;&#60;/rect&#62; &#60;path d="M16 21V5a2 2 0
0 0-2-2h-4a2 2 0 0 0-2 2v16"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;span id="newLabelEscena"&#62;Escena&#60;/span&#62; &#60;/label&#62; &#60;button type="button" id="newBtnRemoveEscena" onclick="removeNewReference('escena')" disabled style="padding:
6px; background: #fef2f2; border: 1.5px solid #fecaca; border-radius: 6px; cursor: pointer; opacity: 0.5;"&#62; &#60;svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2"&#62; &#60;line x1="18" y1="6" x2="6" y2="18"&#62;&#60;/line&#62;
&#60;line x1="6" y1="6" x2="18" y2="18"&#62;&#60;/line&#62; &#60;/svg&#62; &#60;/button&#62; &#60;/div&#62; &#60;!-- Estilo --&#62; &#60;div style="display: flex; align-items: center; gap: 6px;"&#62; &#60;input type="file" id="newInputEstilo" accept="image/*"
style="display: none;" onchange="handleNewReferenceUpload('estilo', event)"&#62; &#60;label for="newInputEstilo" style="flex: 1; padding: 6px 10px; background: white; border: 1.5px dashed #d1d5db; border-radius: 6px; cursor: pointer; font-size: 11px;
color: #737373; display: flex; align-items: center; gap: 6px; transition: all 0.2s;" onmouseover="this.style.borderColor='#8b5cf6'; this.style.background='#f5f3ff';" onmouseout="this.style.borderColor='#d1d5db'; this.style.background='white';"&#62; &#60;svg
width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;span id="newLabelEstilo"&#62;Estilo&#60;/span&#62;
&#60;/label&#62; &#60;button type="button" id="newBtnRemoveEstilo" onclick="removeNewReference('estilo')" disabled style="padding: 6px; background: #fef2f2; border: 1.5px solid #fecaca; border-radius: 6px; cursor: pointer; opacity: 0.5;"&#62; &#60;svg
width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2"&#62; &#60;line x1="18" y1="6" x2="6" y2="18"&#62;&#60;/line&#62; &#60;line x1="6" y1="6" x2="18" y2="18"&#62;&#60;/line&#62; &#60;/svg&#62; &#60;/button&#62; &#60;/div&#62;
&#60;/div&#62; &#60;/div&#62; &#60;div class="category-input-row"&#62; &#60;button onclick="addCategory()" style="width: 100%;"&#62;OK&#60;/button&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;div class="category-list" id="categoryList"&#62;
&#60;div class="category-item active" onclick="filterCategory('all')"&#62; &#60;span&#62;&#60;span class="category-icon"&#62;&#60;/span&#62;Todos los guiones&#60;/span&#62; &#60;span class="category-badge" id="count-all"&#62;0&#60;/span&#62; &#60;/div&#62;
&#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;div class="main-content"&#62; &#60;div class="main-header"&#62; &#60;div class="header-top"&#62; &#60;div&#62; &#60;h2 id="mainTitle"&#62;Todos los guiones&#60;/h2&#62; &#60;p class="header-subtitle"&#62;&#60;span
id="scriptsCount"&#62;0&#60;/span&#62; guiones&#60;/p&#62; &#60;/div&#62; &#60;button class="btn-new-script" onclick="openAddModal()"&#62; &#60;span&#62;+&#60;/span&#62; Nuevo gui&#243;n &#60;/button&#62; &#60;/div&#62; &#60;div class="search-container"&#62;
&#60;svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;circle cx="11" cy="11" r="8"&#62;&#60;/circle&#62; &#60;path d="m21 21-4.35-4.35"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;input
type="text" class="search-input" id="searchInput" placeholder="Buscar guiones..."&#62; &#60;/div&#62; &#60;!-- Panel de Filtros y Acciones R&#225;pidas --&#62; &#60;div class="filters-toggle"&#62; &#60;button class="toggle-filters-btn" id="toggleFiltersBtn"
onclick="toggleFiltersPanel()"&#62; &#60;svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;line x1="4" y1="21" x2="4" y2="14"&#62;&#60;/line&#62; &#60;line x1="4" y1="10" x2="4" y2="3"&#62;&#60;/line&#62;
&#60;line x1="12" y1="21" x2="12" y2="12"&#62;&#60;/line&#62; &#60;line x1="12" y1="8" x2="12" y2="3"&#62;&#60;/line&#62; &#60;line x1="20" y1="21" x2="20" y2="16"&#62;&#60;/line&#62; &#60;line x1="20" y1="12" x2="20" y2="3"&#62;&#60;/line&#62; &#60;line
x1="1" y1="14" x2="7" y2="14"&#62;&#60;/line&#62; &#60;line x1="9" y1="8" x2="15" y2="8"&#62;&#60;/line&#62; &#60;line x1="17" y1="16" x2="23" y2="16"&#62;&#60;/line&#62; &#60;/svg&#62; &#60;span&#62;Filtros&#60;/span&#62; &#60;span class="active-filters-count"
id="activeFiltersCount" style="display: none;"&#62;0&#60;/span&#62; &#60;/button&#62; &#60;!-- Botones de Acci&#243;n R&#225;pida --&#62; &#60;div class="quick-action-buttons"&#62; &#60;button class="btn-select-mode" id="btnSelectMode" onclick="toggleSelectionMode()"&#62;
&#60;svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path d="M9 11l3 3L22 4"&#62;&#60;/path&#62; &#60;path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"&#62;&#60;/path&#62; &#60;/svg&#62;
&#60;span&#62;Seleccionar&#60;/span&#62; &#60;/button&#62; &#60;button class="btn-quick-action" id="btnQuickCopyPath" onclick="quickCopyPath()" data-shortcut="Ctrl + Shift + X"&#62; &#60;svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
stroke-width="2"&#62; &#60;path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"&#62;&#60;/path&#62; &#60;polyline points="13 2 13 9 20 9"&#62;&#60;/polyline&#62; &#60;/svg&#62; &#60;span id="quickCopyPathText"&#62;Copiar Ruta&#60;/span&#62;
&#60;/button&#62; &#60;button class="btn-quick-action" id="btnQuickCopyScript" onclick="quickCopyScript()" data-shortcut="Ctrl + Shift + S"&#62; &#60;svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62;
&#60;rect x="9" y="9" width="13" height="13" rx="2" ry="2"&#62;&#60;/rect&#62; &#60;path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;span id="quickCopyScriptText"&#62;Copiar Gui&#243;n&#60;/span&#62;
&#60;/button&#62; &#60;/div&#62; &#60;/div&#62; &#60;div class="filters-panel" id="filtersPanel"&#62; &#60;div class="filter-group"&#62; &#60;span class="filter-label"&#62;Mostrar&#60;/span&#62; &#60;div class="filter-options"&#62; &#60;button class="filter-option
active" data-status="available" onclick="setStatusFilter('available')"&#62; Disponibles &#60;/button&#62; &#60;button class="filter-option" data-status="used" onclick="setStatusFilter('used')"&#62; Utilizados &#60;/button&#62; &#60;button class="filter-option"
data-status="all" onclick="setStatusFilter('all')"&#62; Todos &#60;/button&#62; &#60;/div&#62; &#60;/div&#62; &#60;div class="filter-divider"&#62;&#60;/div&#62; &#60;div class="filter-group"&#62; &#60;span class="filter-label"&#62;Ordenar por&#60;/span&#62;
&#60;div class="filter-options"&#62; &#60;button class="filter-option active" data-sort="recent" onclick="setSortFilter('recent')"&#62; M&#225;s reciente &#60;/button&#62; &#60;button class="filter-option" data-sort="oldest" onclick="setSortFilter('oldest')"&#62;
M&#225;s antiguo &#60;/button&#62; &#60;button class="filter-option" data-sort="alpha" onclick="setSortFilter('alpha')"&#62; A-Z &#60;/button&#62; &#60;button class="filter-option" data-sort="alpha-desc" onclick="setSortFilter('alpha-desc')"&#62; Z-A
&#60;/button&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;div class="scripts-container"&#62; &#60;div class="scripts-grid" id="scriptsGrid"&#62; &#60;div class="empty-state"&#62; &#60;h3&#62;No hay guiones todav&#237;a&#60;/h3&#62;
&#60;p&#62;Comienza agregando tu primer gui&#243;n&#60;/p&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Modal Ver Redise&#241;ado - Dise&#241;o de Dos Paneles --&#62; &#60;div class="modal" id="viewModal"&#62; &#60;div class="modal-content-wide"&#62;
&#60;!-- Header Minimalista --&#62; &#60;div class="view-modal-header"&#62; &#60;div class="view-header-left"&#62; &#60;button class="nav-circle-btn" onclick="prevScript()" title="Anterior (&#8592;)"&#62; &#60;svg width="16" height="16" viewBox="0 0 24
24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;polyline points="15 18 9 12 15 6"&#62;&#60;/polyline&#62; &#60;/svg&#62; &#60;/button&#62; &#60;button class="nav-circle-btn" onclick="nextScript()" title="Siguiente (&#8594;)"&#62; &#60;svg
width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;polyline points="9 18 15 12 9 6"&#62;&#60;/polyline&#62; &#60;/svg&#62; &#60;/button&#62; &#60;div class="view-title-group"&#62; &#60;h2 class="view-title"
id="viewTitle"&#62;&#60;/h2&#62; &#60;span class="view-category-pill" id="viewCategory"&#62;&#60;/span&#62; &#60;/div&#62; &#60;/div&#62; &#60;div class="view-header-right"&#62; &#60;button class="icon-circle-btn" onclick="openEditScriptModal()" title="Editar"&#62;
&#60;svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"&#62;&#60;/path&#62; &#60;path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4
1 1-4 9.5-9.5z"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;/button&#62; &#60;button class="icon-circle-btn delete-btn" onclick="deleteCurrentScript()" title="Eliminar"&#62; &#60;svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
stroke-width="2"&#62; &#60;polyline points="3 6 5 6 21 6"&#62;&#60;/polyline&#62; &#60;path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;/button&#62; &#60;button class="btn-close-circle"
onclick="closeModal('viewModal')" title="Cerrar (Esc)"&#62;&#215;&#60;/button&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Layout de Dos Paneles --&#62; &#60;div class="view-two-panel-layout"&#62; &#60;!-- Panel Principal: Contenido del Guion --&#62; &#60;div
class="view-main-panel"&#62; &#60;div class="view-script-wrapper"&#62; &#60;div class="view-date-stamp" id="viewDate"&#62;&#60;/div&#62; &#60;div class="view-script-content" id="viewContent"&#62;&#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Panel
Lateral: Centro de Control --&#62; &#60;div class="view-sidebar-panel"&#62; &#60;div class="sidebar-panel-content"&#62; &#60;!-- M&#233;tricas Clave --&#62; &#60;div class="metrics-section"&#62; &#60;h3 class="sidebar-section-title"&#62; &#60;svg width="16"
height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;line x1="12" y1="1" x2="12" y2="23"&#62;&#60;/line&#62; &#60;path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"&#62;&#60;/path&#62; &#60;/svg&#62; M&#233;tricas
Calculadas &#60;/h3&#62; &#60;div class="metrics-grid"&#62; &#60;div class="metric-card metric-blue"&#62; &#60;div class="metric-icon"&#62; &#60;svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path
d="M21.21 15.89A10 10 0 1 1 8 2.83"&#62;&#60;/path&#62; &#60;path d="M22 12A10 10 0 0 0 12 2v10z"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;/div&#62; &#60;div class="metric-content"&#62; &#60;div class="metric-label"&#62;Escenas&#60;/div&#62; &#60;div class="metric-value"
id="viewScenes"&#62;0&#60;/div&#62; &#60;div class="metric-subtitle"&#62;&#60;span id="viewCharCount"&#62;0&#60;/span&#62; caracteres&#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;div class="metric-card metric-green"&#62; &#60;div class="metric-icon"&#62;
&#60;svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;circle cx="12" cy="12" r="10"&#62;&#60;/circle&#62; &#60;polyline points="12 6 12 12 16 14"&#62;&#60;/polyline&#62; &#60;/svg&#62; &#60;/div&#62;
&#60;div class="metric-content"&#62; &#60;div class="metric-label"&#62;Duraci&#243;n&#60;/div&#62; &#60;div class="metric-value" id="viewDuration"&#62;0s&#60;/div&#62; &#60;div class="metric-subtitle"&#62;&#60;span id="viewSecondsTotal"&#62;0&#60;/span&#62;
segundos&#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Secci&#243;n de Acciones R&#225;pidas --&#62; &#60;div class="actions-section"&#62; &#60;h3 class="sidebar-section-title"&#62; &#60;svg width="16" height="16"
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;polyline points="9 11 12 14 22 4"&#62;&#60;/polyline&#62; &#60;path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"&#62;&#60;/path&#62; &#60;/svg&#62; Acciones
R&#225;pidas &#60;/h3&#62; &#60;!-- NUEVO: Bot&#243;n de Copiar T&#237;tulo --&#62; &#60;button class="sidebar-action-btn" onclick="copyScriptTitle()" title="Ctrl + Shift + F" style="border-color: #8b5cf6; background: linear-gradient(135deg, #ede9fe 0%,
#ddd6fe 100%);"&#62; &#60;div class="action-btn-icon" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);"&#62; &#60;svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path d="M4
7h16M4 12h16M4 17h10"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;/div&#62; &#60;div class="action-btn-content"&#62; &#60;div class="action-btn-title" id="copyTitleText"&#62;Copiar T&#237;tulo&#60;/div&#62; &#60;div class="action-btn-subtitle"&#62;Copiar
nombre del guion&#60;/div&#62; &#60;/div&#62; &#60;div class="action-btn-shortcut"&#62;&#8984;F&#60;/div&#62; &#60;/button&#62; &#60;!-- Bot&#243;n de Prompt de Generaci&#243;n --&#62; &#60;div id="promptContainer" style="display: none;"&#62; &#60;button
class="sidebar-action-btn prompt-btn" onclick="copyPrompt()" title="Ctrl + Shift + G"&#62; &#60;div class="action-btn-icon"&#62; &#60;svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path d="m12
3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;/div&#62; &#60;div class="action-btn-content"&#62;
&#60;div class="action-btn-title" id="copyPromptText"&#62;Copiar Prompt de IA&#60;/div&#62; &#60;div class="action-btn-subtitle"&#62;Genera im&#225;genes con IA&#60;/div&#62; &#60;/div&#62; &#60;div class="action-btn-shortcut"&#62;&#8984;G&#60;/div&#62;
&#60;/button&#62; &#60;div id="promptText" style="display: none;"&#62;&#60;/div&#62; &#60;/div&#62; &#60;!-- Ruta de Clips --&#62; &#60;div id="categoryPathContainer" style="display: none;"&#62; &#60;button class="sidebar-action-btn path-btn" onclick="copyCategoryPath()"
title="Ctrl + Shift + X"&#62; &#60;div class="action-btn-icon"&#62; &#60;svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"&#62;&#60;/path&#62;
&#60;polyline points="13 2 13 9 20 9"&#62;&#60;/polyline&#62; &#60;/svg&#62; &#60;/div&#62; &#60;div class="action-btn-content"&#62; &#60;div class="action-btn-title"&#62;Ruta de Clips&#60;/div&#62; &#60;div class="action-btn-path" id="categoryPath"&#62;&#60;/div&#62;
&#60;/div&#62; &#60;div class="action-btn-shortcut"&#62;&#8984;X&#60;/div&#62; &#60;/button&#62; &#60;/div&#62; &#60;!-- Ruta de Exportaci&#243;n --&#62; &#60;div id="categoryExportPathContainer" style="display: none;"&#62; &#60;button class="sidebar-action-btn
export-btn" onclick="copyCategoryExportPath()" title="Ctrl + Shift + E"&#62; &#60;div class="action-btn-icon"&#62; &#60;svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path d="M21 15v4a2 2 0
0 1-2 2H5a2 2 0 0 1-2-2v-4"&#62;&#60;/path&#62; &#60;polyline points="7 10 12 15 17 10"&#62;&#60;/polyline&#62; &#60;line x1="12" y1="15" x2="12" y2="3"&#62;&#60;/line&#62; &#60;/svg&#62; &#60;/div&#62; &#60;div class="action-btn-content"&#62; &#60;div
class="action-btn-title"&#62;Ruta de Exportaci&#243;n&#60;/div&#62; &#60;div class="action-btn-path" id="categoryExportPath"&#62;&#60;/div&#62; &#60;/div&#62; &#60;div class="action-btn-shortcut"&#62;&#8984;E&#60;/div&#62; &#60;/button&#62; &#60;/div&#62;
&#60;/div&#62; &#60;!-- Secci&#243;n de Estado --&#62; &#60;div class="status-section"&#62; &#60;button class="sidebar-status-btn" id="btnMarkUsed" onclick="toggleUsedStatus()"&#62; &#60;div class="status-btn-icon"&#62; &#60;svg width="18" height="18"
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;circle cx="12" cy="12" r="10"&#62;&#60;/circle&#62; &#60;/svg&#62; &#60;/div&#62; &#60;span id="markUsedText"&#62;Marcar como utilizado&#60;/span&#62; &#60;/button&#62; &#60;button
class="sidebar-copy-btn" onclick="copyCurrentScript()" title="Ctrl + Shift + S"&#62; &#60;svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;rect x="9" y="9" width="13" height="13" rx="2" ry="2"&#62;&#60;/rect&#62;
&#60;path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;span&#62;Copiar Todo&#60;/span&#62; &#60;/button&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62;
&#60;!-- Modal Agregar con Pesta&#195;&#177;as --&#62; &#60;div class="modal" id="addModal"&#62; &#60;div class="modal-content"&#62; &#60;div class="modal-header"&#62; &#60;div class="modal-title-section"&#62; &#60;h2 class="modal-title"&#62;Agregar Guiones&#60;/h2&#62;
&#60;/div&#62; &#60;button class="btn-close" onclick="closeModal('addModal')"&#62;&#215;&#60;/button&#62; &#60;/div&#62; &#60;div class="modal-body"&#62; &#60;!-- Sistema de Pesta&#195;&#177;as --&#62; &#60;div class="modal-tabs"&#62; &#60;button class="tab-button
active" id="tabSingle" onclick="switchTab('single')"&#62; &#60;svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"&#62;&#60;/path&#62;
&#60;polyline points="14 2 14 8 20 8"&#62;&#60;/polyline&#62; &#60;line x1="16" y1="13" x2="8" y2="13"&#62;&#60;/line&#62; &#60;line x1="16" y1="17" x2="8" y2="17"&#62;&#60;/line&#62; &#60;polyline points="10 9 9 9 8 9"&#62;&#60;/polyline&#62; &#60;/svg&#62;
&#60;span&#62;Nuevo Gui&#243;n&#60;/span&#62; &#60;/button&#62; &#60;button class="tab-button" id="tabBulk" onclick="switchTab('bulk')"&#62; &#60;svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path
d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"&#62;&#60;/path&#62; &#60;polyline points="17 8 12 3 7 8"&#62;&#60;/polyline&#62; &#60;line x1="12" y1="3" x2="12" y2="15"&#62;&#60;/line&#62; &#60;/svg&#62; &#60;span&#62;Carga Masiva&#60;/span&#62; &#60;/button&#62;
&#60;/div&#62; &#60;!-- PESTA&#195;'A 1: Nuevo Gui&#195;&#179;n Individual --&#62; &#60;div class="tab-content active" id="contentSingle"&#62; &#60;form onsubmit="saveScript(event)"&#62; &#60;div class="form-group"&#62; &#60;label&#62;T&#237;tulo del
Gui&#243;n&#60;/label&#62; &#60;input type="text" id="scriptTitle" required&#62; &#60;/div&#62; &#60;div class="form-group"&#62; &#60;label&#62;Categor&#237;a&#60;/label&#62; &#60;select id="scriptCategory"&#62; &#60;option value="General"&#62;General&#60;/option&#62;
&#60;/select&#62; &#60;/div&#62; &#60;div class="form-group"&#62; &#60;label&#62;Contenido del Gui&#243;n&#60;/label&#62; &#60;textarea id="scriptContent" required&#62;&#60;/textarea&#62; &#60;/div&#62; &#60;div class="form-actions"&#62; &#60;button type="button"
class="btn-cancel" onclick="closeModal('addModal')"&#62;Cancelar&#60;/button&#62; &#60;button type="submit" class="btn-save"&#62;Guardar gui&#243;n&#60;/button&#62; &#60;/div&#62; &#60;/form&#62; &#60;/div&#62; &#60;!-- PESTA&#195;'A 2: Carga Masiva --&#62;
&#60;div class="tab-content" id="contentBulk"&#62; &#60;div class="bulk-info"&#62; &#60;strong&#62; C&#243;mo funciona:&#60;/strong&#62; Pega m&#250;ltiples guiones en el &#225;rea de texto o carga un archivo &#60;code&#62;.txt&#60;/code&#62;. Separa
cada gui&#243;n con &#60;code&#62;---&#60;/code&#62; en una l&#237;nea nueva. &#60;br&#62;&#60;br&#62; &#60;strong&#62;Ejemplo:&#60;/strong&#62;&#60;br&#62; &#60;code&#62;Este es el guion 1&#60;br&#62;---&#60;br&#62;Este es el guion 2&#60;br&#62;---&#60;br&#62;Este
es el guion 3&#60;/code&#62; &#60;/div&#62; &#60;div class="form-group"&#62; &#60;label&#62;Categor&#237;a para todos los guiones&#60;/label&#62; &#60;select id="bulkCategory"&#62; &#60;option value="General"&#62;General&#60;/option&#62; &#60;/select&#62;
&#60;/div&#62; &#60;div class="form-group"&#62; &#60;label&#62;Pegar Guiones (separados por ---)&#60;/label&#62; &#60;textarea id="bulkScriptContent" placeholder="Guion 1&#38;#10;---&#38;#10;Guion 2&#38;#10;---&#38;#10;Guion 3" style="min-height: 150px;"&#62;&#60;/textarea&#62;
&#60;/div&#62; &#60;div class="form-group"&#62; &#60;label&#62;O Cargar desde Archivo&#60;/label&#62; &#60;div class="file-input-wrapper"&#62; &#60;input type="file" id="bulkFileInput" accept=".txt" onchange="handleBulkFileSelect(event)"&#62; &#60;label
for="bulkFileInput" class="file-input-label" id="fileInputLabel"&#62; &#60;svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"&#62;&#60;/path&#62;
&#60;polyline points="13 2 13 9 20 9"&#62;&#60;/polyline&#62; &#60;/svg&#62; &#60;span id="fileInputText"&#62;Seleccionar archivo .txt&#60;/span&#62; &#60;/label&#62; &#60;/div&#62; &#60;/div&#62; &#60;button type="button" class="btn-bulk-add" onclick="agregarGuionesMasivos()"
id="btnBulkAdd"&#62; &#60;svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"&#62;&#60;/path&#62; &#60;polyline points="17 8 12 3 7 8"&#62;&#60;/polyline&#62;
&#60;line x1="12" y1="3" x2="12" y2="15"&#62;&#60;/line&#62; &#60;/svg&#62; Agregar Guiones Masivos &#60;/button&#62; &#60;div class="bulk-result" id="bulkResult"&#62; &#60;svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
stroke-width="2"&#62; &#60;polyline points="20 6 9 17 4 12"&#62;&#60;/polyline&#62; &#60;/svg&#62; &#60;span id="bulkResultText"&#62;&#60;/span&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Modal Editar Categor&#237;a
--&#62; &#60;div class="modal" id="editCategoryModal"&#62; &#60;div class="modal-content"&#62; &#60;div class="modal-header"&#62; &#60;div class="modal-title-section"&#62; &#60;h2 class="modal-title"&#62;Editar Categor&#237;a&#60;/h2&#62; &#60;/div&#62;
&#60;button class="btn-close" onclick="closeModal('editCategoryModal')"&#62;&#215;&#60;/button&#62; &#60;/div&#62; &#60;div class="modal-body"&#62; &#60;div class="edit-category-highlight"&#62; &#60;div class="current-name"&#62;Categor&#237;a actual&#60;/div&#62;
&#60;div class="name-display" id="editCurrentCategoryName"&#62;&#60;/div&#62; &#60;/div&#62; &#60;div class="warning-box" id="editWarningBox" style="display: none;"&#62; &#60;svg class="warning-icon" width="20" height="20" viewBox="0 0 24 24" fill="none"
stroke="currentColor" stroke-width="2"&#62; &#60;path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"&#62;&#60;/path&#62; &#60;line x1="12" y1="9" x2="12" y2="13"&#62;&#60;/line&#62; &#60;line x1="12" y1="17"
x2="12.01" y2="17"&#62;&#60;/line&#62; &#60;/svg&#62; &#60;div class="warning-content"&#62; &#60;div class="warning-title"&#62; Cambios en guiones existentes &#60;span class="scripts-affected" id="affectedScriptsCount"&#62;0&#60;/span&#62; &#60;/div&#62;
&#60;div class="warning-text"&#62; Al cambiar el nombre, todos los guiones de esta categor&#237;a se actualizar&#225;n autom&#225;ticamente. &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;form onsubmit="saveEditCategory(event)"&#62; &#60;input type="hidden"
id="editCategoryOriginalName"&#62; &#60;div class="form-group"&#62; &#60;label&#62;Nuevo Nombre de la Categor&#237;a&#60;/label&#62; &#60;input type="text" id="editCategoryName" required&#62; &#60;/div&#62; &#60;!-- === INICIO C&#211;DIGO NUEVO === --&#62;
&#60;div class="form-group"&#62; &#60;label&#62;Tipo de Contenido&#60;/label&#62; &#60;div id="editCategoryTypeSelector" style="display: flex; gap: 8px;"&#62; &#60;button type="button" class="filter-option" data-type="short" onclick="selectCategoryType(this,
'editCategoryTypeSelector')"&#62; &#60;svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 6px;"&#62;&#60;rect x="7" y="2" width="10" height="20" rx="2" ry="2"&#62;&#60;/rect&#62;&#60;path
d="M12 18h.01"&#62;&#60;/path&#62;&#60;/svg&#62; Contenido Corto &#60;/button&#62; &#60;button type="button" class="filter-option" data-type="long" onclick="selectCategoryType(this, 'editCategoryTypeSelector')"&#62; &#60;svg width="14" height="14" viewBox="0
0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 6px;"&#62;&#60;rect x="2" y="3" width="20" height="14" rx="2" ry="2"&#62;&#60;/rect&#62;&#60;line x1="8" y1="21" x2="16" y2="21"&#62;&#60;/line&#62;&#60;line x1="12" y1="17"
x2="12" y2="21"&#62;&#60;/line&#62;&#60;/svg&#62; Contenido Largo &#60;/button&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- === FIN C&#211;DIGO NUEVO === --&#62; &#60;div class="form-group"&#62; &#60;label&#62;Ruta de los Clips&#60;/label&#62; &#60;input
type="text" id="editCategoryPath" placeholder="Ej: C:\Videos\Clips" class="path-input"&#62; &#60;/div&#62; &#60;div class="form-group"&#62; &#60;label&#62;Ruta de Exportaci&#243;n del Video &#60;span style="color: #ef4444;"&#62;*&#60;/span&#62;&#60;/label&#62;
&#60;input type="text" id="editCategoryExportPath" placeholder="Ej: C:\Videos\Exportados (si se deja vac&#237;o no se guardar&#225; ruta)" class="path-input"&#62; &#60;/div&#62; &#60;div class="form-group"&#62; &#60;label&#62;Prompt de Generaci&#243;n
de Im&#225;genes/Video&#60;/label&#62; &#60;textarea id="editCategoryPrompt" placeholder="Usa (X) para el n&#250;mero de escenas. Ej: Genera (X) prompts..." class="path-input" style="min-height: 80px; resize: vertical;"&#62;&#60;/textarea&#62; &#60;small
style="font-size: 11px; color: #737373; margin-top: 4px; display: block;"&#62;  Usa &#60;strong&#62;(X)&#60;/strong&#62; donde quieras que aparezca el n&#250;mero de escenas calculado &#60;/small&#62; &#60;/div&#62; &#60;!-- NUEVA SECCI&#211;N: Referencias
Visuales --&#62; &#60;div class="visual-references-section"&#62; &#60;div class="visual-references-header"&#62; &#60;div class="visual-references-icon"&#62; &#60;svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"&#62;
&#60;rect x="3" y="3" width="18" height="18" rx="2" ry="2"&#62;&#60;/rect&#62; &#60;circle cx="8.5" cy="8.5" r="1.5"&#62;&#60;/circle&#62; &#60;polyline points="21 15 16 10 5 21"&#62;&#60;/polyline&#62; &#60;/svg&#62; &#60;/div&#62; &#60;div class="visual-references-title-group"&#62;
&#60;h3&#62; Referencias Visuales&#60;/h3&#62; &#60;p class="visual-references-subtitle"&#62;Sube im&#225;genes de referencia para la generaci&#243;n con IA&#60;/p&#62; &#60;/div&#62; &#60;/div&#62; &#60;div class="visual-references-grid"&#62; &#60;!--
Referencia: Asunto --&#62; &#60;div class="visual-reference-card"&#62; &#60;div class="visual-reference-label"&#62; &#60;svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;circle cx="12" cy="12"
r="10"&#62;&#60;/circle&#62; &#60;circle cx="12" cy="12" r="3"&#62;&#60;/circle&#62; &#60;/svg&#62; Asunto &#60;/div&#62; &#60;div class="visual-reference-preview" id="previewAsunto"&#62; &#60;div class="visual-reference-placeholder"&#62; &#60;svg width="32"
height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"&#62; &#60;rect x="3" y="3" width="18" height="18" rx="2" ry="2"&#62;&#60;/rect&#62; &#60;circle cx="8.5" cy="8.5" r="1.5"&#62;&#60;/circle&#62; &#60;polyline points="21
15 16 10 5 21"&#62;&#60;/polyline&#62; &#60;/svg&#62; &#60;span class="visual-reference-placeholder-text"&#62;Referencia del&#60;br&#62;tema principal&#60;/span&#62; &#60;/div&#62; &#60;/div&#62; &#60;div class="visual-reference-actions"&#62; &#60;input
type="file" id="inputAsunto" class="visual-reference-input" accept="image/*" onchange="handleReferenceUpload('asunto', event)"&#62; &#60;label for="inputAsunto" class="btn-upload-reference"&#62; &#60;svg width="14" height="14" viewBox="0 0 24 24" fill="none"
stroke="currentColor" stroke-width="2"&#62; &#60;path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"&#62;&#60;/path&#62; &#60;polyline points="17 8 12 3 7 8"&#62;&#60;/polyline&#62; &#60;line x1="12" y1="3" x2="12" y2="15"&#62;&#60;/line&#62; &#60;/svg&#62;
Subir &#60;/label&#62; &#60;button type="button" class="btn-remove-reference" id="btnRemoveAsunto" onclick="removeReference('asunto')" disabled&#62; &#60;svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62;
&#60;polyline points="3 6 5 6 21 6"&#62;&#60;/polyline&#62; &#60;path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;/button&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Referencia:
Escena --&#62; &#60;div class="visual-reference-card"&#62; &#60;div class="visual-reference-label"&#62; &#60;svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;rect x="2" y="7" width="20" height="14"
rx="2" ry="2"&#62;&#60;/rect&#62; &#60;path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"&#62;&#60;/path&#62; &#60;/svg&#62; Escena &#60;/div&#62; &#60;div class="visual-reference-preview" id="previewEscena"&#62; &#60;div class="visual-reference-placeholder"&#62;
&#60;svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"&#62; &#60;rect x="3" y="3" width="18" height="18" rx="2" ry="2"&#62;&#60;/rect&#62; &#60;circle cx="8.5" cy="8.5" r="1.5"&#62;&#60;/circle&#62; &#60;polyline
points="21 15 16 10 5 21"&#62;&#60;/polyline&#62; &#60;/svg&#62; &#60;span class="visual-reference-placeholder-text"&#62;Referencia de&#60;br&#62;composici&#243;n/ambiente&#60;/span&#62; &#60;/div&#62; &#60;/div&#62; &#60;div class="visual-reference-actions"&#62;
&#60;input type="file" id="inputEscena" class="visual-reference-input" accept="image/*" onchange="handleReferenceUpload('escena', event)"&#62; &#60;label for="inputEscena" class="btn-upload-reference"&#62; &#60;svg width="14" height="14" viewBox="0 0
24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"&#62;&#60;/path&#62; &#60;polyline points="17 8 12 3 7 8"&#62;&#60;/polyline&#62; &#60;line x1="12" y1="3" x2="12" y2="15"&#62;&#60;/line&#62;
&#60;/svg&#62; Subir &#60;/label&#62; &#60;button type="button" class="btn-remove-reference" id="btnRemoveEscena" onclick="removeReference('escena')" disabled&#62; &#60;svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62;
&#60;polyline points="3 6 5 6 21 6"&#62;&#60;/polyline&#62; &#60;path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;/button&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Referencia:
Estilo --&#62; &#60;div class="visual-reference-card"&#62; &#60;div class="visual-reference-label"&#62; &#60;svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path d="M12 2L2 7l10 5 10-5-10-5zM2
17l10 5 10-5M2 12l10 5 10-5"&#62;&#60;/path&#62; &#60;/svg&#62; Estilo &#60;/div&#62; &#60;div class="visual-reference-preview" id="previewEstilo"&#62; &#60;div class="visual-reference-placeholder"&#62; &#60;svg width="32" height="32" viewBox="0 0 24
24" fill="none" stroke="currentColor" stroke-width="1.5"&#62; &#60;rect x="3" y="3" width="18" height="18" rx="2" ry="2"&#62;&#60;/rect&#62; &#60;circle cx="8.5" cy="8.5" r="1.5"&#62;&#60;/circle&#62; &#60;polyline points="21 15 16 10 5 21"&#62;&#60;/polyline&#62;
&#60;/svg&#62; &#60;span class="visual-reference-placeholder-text"&#62;Referencia de&#60;br&#62;est&#233;tica visual&#60;/span&#62; &#60;/div&#62; &#60;/div&#62; &#60;div class="visual-reference-actions"&#62; &#60;input type="file" id="inputEstilo" class="visual-reference-input"
accept="image/*" onchange="handleReferenceUpload('estilo', event)"&#62; &#60;label for="inputEstilo" class="btn-upload-reference"&#62; &#60;svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path
d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"&#62;&#60;/path&#62; &#60;polyline points="17 8 12 3 7 8"&#62;&#60;/polyline&#62; &#60;line x1="12" y1="3" x2="12" y2="15"&#62;&#60;/line&#62; &#60;/svg&#62; Subir &#60;/label&#62; &#60;button type="button"
class="btn-remove-reference" id="btnRemoveEstilo" onclick="removeReference('estilo')" disabled&#62; &#60;svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;polyline points="3 6 5 6 21 6"&#62;&#60;/polyline&#62;
&#60;path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;/button&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;div class="form-actions"&#62; &#60;button
type="button" class="btn-cancel" onclick="closeModal('editCategoryModal')"&#62;Cancelar&#60;/button&#62; &#60;button type="submit" class="btn-save"&#62;Guardar cambios&#60;/button&#62; &#60;/div&#62; &#60;/form&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62;
&#60;!-- Modal Editar Gui&#243;n --&#62; &#60;div class="modal" id="editScriptModal"&#62; &#60;div class="modal-content"&#62; &#60;div class="modal-header"&#62; &#60;div class="modal-title-section"&#62; &#60;h2 class="modal-title"&#62;Editar Gui&#243;n&#60;/h2&#62;
&#60;/div&#62; &#60;button class="btn-close" onclick="closeModal('editScriptModal')"&#62;&#215;&#60;/button&#62; &#60;/div&#62; &#60;div class="modal-body"&#62; &#60;div class="edit-category-highlight"&#62; &#60;div class="current-name"&#62;Editando&#60;/div&#62;
&#60;div class="name-display" id="editCurrentScriptTitle"&#62;&#60;/div&#62; &#60;/div&#62; &#60;form onsubmit="saveEditScript(event)"&#62; &#60;input type="hidden" id="editScriptId"&#62; &#60;div class="form-group"&#62; &#60;label&#62;T&#237;tulo del
Gui&#243;n&#60;/label&#62; &#60;input type="text" id="editScriptTitle" required&#62; &#60;/div&#62; &#60;div class="form-group"&#62; &#60;label&#62;Categor&#237;a&#60;/label&#62; &#60;select id="editScriptCategory"&#62; &#60;option value=""&#62;Sin categor&#237;a&#60;/option&#62;
&#60;/select&#62; &#60;/div&#62; &#60;div class="form-group"&#62; &#60;label&#62;Contenido del Gui&#243;n&#60;/label&#62; &#60;textarea id="editScriptContent" required&#62;&#60;/textarea&#62; &#60;/div&#62; &#60;!-- === INICIO C&#211;DIGO NUEVO === --&#62;
&#60;details class="custom-visuals-details"&#62; &#60;summary class="custom-visuals-summary"&#62; &#60;svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;rect x="3" y="3" width="18" height="18"
rx="2" ry="2"&#62;&#60;/rect&#62;&#60;circle cx="8.5" cy="8.5" r="1.5"&#62;&#60;/circle&#62;&#60;polyline points="21 15 16 10 5 21"&#62;&#60;/polyline&#62; &#60;/svg&#62; &#60;span&#62;Ajustes de Referencias Visuales (Opcional)&#60;/span&#62; &#60;div
class="summary-chevron"&#62; &#60;svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62;&#60;polyline points="6 9 12 15 18 9"&#62;&#60;/polyline&#62;&#60;/svg&#62; &#60;/div&#62; &#60;/summary&#62; &#60;div
class="custom-visuals-content"&#62; &#60;p class="custom-visuals-info"&#62; Sobrescribe las referencias de la categor&#237;a &#60;strong&#62;solo para este guion&#60;/strong&#62;. Si dejas un campo vac&#237;o, se usar&#225; la imagen de la categor&#237;a
por defecto. &#60;/p&#62; &#60;div class="visual-references-grid" id="editScriptVisualsGrid"&#62; &#60;!-- Asunto --&#62; &#60;div class="visual-reference-card"&#62; &#60;div class="visual-reference-label"&#62;Asunto&#60;/div&#62; &#60;div class="visual-reference-preview"
id="editScriptPreviewAsunto"&#62;&#60;/div&#62; &#60;div class="visual-reference-actions"&#62; &#60;input type="file" id="editScriptInputAsunto" class="visual-reference-input" accept="image/*" onchange="handleCustomReferenceUpload('asunto', event)"&#62;
&#60;label for="editScriptInputAsunto" class="btn-upload-reference"&#62;Subir&#60;/label&#62; &#60;button type="button" class="btn-remove-reference" id="editScriptBtnRemoveAsunto" onclick="removeCustomReference('asunto')" disabled&#62;Quitar&#60;/button&#62;
&#60;/div&#62; &#60;/div&#62; &#60;!-- Escena --&#62; &#60;div class="visual-reference-card"&#62; &#60;div class="visual-reference-label"&#62;Escena&#60;/div&#62; &#60;div class="visual-reference-preview" id="editScriptPreviewEscena"&#62;&#60;/div&#62;
&#60;div class="visual-reference-actions"&#62; &#60;input type="file" id="editScriptInputEscena" class="visual-reference-input" accept="image/*" onchange="handleCustomReferenceUpload('escena', event)"&#62; &#60;label for="editScriptInputEscena" class="btn-upload-reference"&#62;Subir&#60;/label&#62;
&#60;button type="button" class="btn-remove-reference" id="editScriptBtnRemoveEscena" onclick="removeCustomReference('escena')" disabled&#62;Quitar&#60;/button&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Estilo --&#62; &#60;div class="visual-reference-card"&#62;
&#60;div class="visual-reference-label"&#62;Estilo&#60;/div&#62; &#60;div class="visual-reference-preview" id="editScriptPreviewEstilo"&#62;&#60;/div&#62; &#60;div class="visual-reference-actions"&#62; &#60;input type="file" id="editScriptInputEstilo"
class="visual-reference-input" accept="image/*" onchange="handleCustomReferenceUpload('estilo', event)"&#62; &#60;label for="editScriptInputEstilo" class="btn-upload-reference"&#62;Subir&#60;/label&#62; &#60;button type="button" class="btn-remove-reference"
id="editScriptBtnRemoveEstilo" onclick="removeCustomReference('estilo')" disabled&#62;Quitar&#60;/button&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;/details&#62; &#60;!-- === FIN C&#211;DIGO NUEVO === --&#62; &#60;div class="form-actions"&#62;
&#60;button type="button" class="btn-cancel" onclick="closeModal('editScriptModal')"&#62;Cancelar&#60;/button&#62; &#60;button type="submit" class="btn-save"&#62;Guardar cambios&#60;/button&#62; &#60;/div&#62; &#60;/form&#62; &#60;/div&#62; &#60;/div&#62;
&#60;/div&#62; &#60;!-- Barra de Selecci&#243;n M&#250;ltiple --&#62; &#60;div class="selection-mode-bar" id="selectionModeBar"&#62; &#60;div class="selection-info"&#62; &#60;div class="selection-count" id="selectionCount"&#62;0&#60;/div&#62; &#60;div
class="selection-text"&#62;guiones seleccionados&#60;/div&#62; &#60;/div&#62; &#60;div class="selection-actions"&#62; &#60;button class="btn-selection-action btn-cancel-selection" onclick="cancelSelectionMode()"&#62; Cancelar &#60;/button&#62; &#60;button
class="btn-selection-action btn-delete-selected" onclick="deleteSelectedScripts()"&#62; &#60;svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;polyline points="3 6 5 6 21 6"&#62;&#60;/polyline&#62;
&#60;path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"&#62;&#60;/path&#62; &#60;/svg&#62; Eliminar seleccionados &#60;/button&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Di&#225;logo de Confirmaci&#243;n --&#62; &#60;div
class="confirm-dialog" id="confirmDialog"&#62; &#60;div class="confirm-content"&#62; &#60;div class="confirm-icon"&#62; &#60;svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path d="M10.29 3.86L1.82
18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"&#62;&#60;/path&#62; &#60;line x1="12" y1="9" x2="12" y2="13"&#62;&#60;/line&#62; &#60;line x1="12" y1="17" x2="12.01" y2="17"&#62;&#60;/line&#62; &#60;/svg&#62; &#60;/div&#62; &#60;h3
class="confirm-title" id="confirmTitle"&#62;&#191;Eliminar gui&#243;n?&#60;/h3&#62; &#60;p class="confirm-message" id="confirmMessage"&#62;Esta acci&#243;n no se puede deshacer.&#60;/p&#62; &#60;div class="confirm-actions"&#62; &#60;button class="btn-confirm
btn-confirm-cancel" onclick="closeConfirmDialog()"&#62; Cancelar &#60;/button&#62; &#60;button class="btn-confirm btn-confirm-delete" id="btnConfirmDelete" onclick="confirmDelete()"&#62; Eliminar &#60;/button&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62;
&#60;!-- Modal de Configuraci&#243;n Redise&#241;ado --&#62; &#60;div class="modal" id="configModal"&#62; &#60;div class="modal-content" style="max-width: 900px; max-height: 95vh;"&#62; &#60;div class="modal-header"&#62; &#60;div class="modal-title-section"&#62;
&#60;h2 class="modal-title"&#62;&#9881; Configuraci&#243;n del Sistema&#60;/h2&#62; &#60;p style="font-size: 13px; color: #737373; margin-top: 4px;"&#62; Gestiona los par&#225;metros de c&#225;lculo y generadores de contenido &#60;/p&#62; &#60;/div&#62;
&#60;button class="btn-close" onclick="closeModal('configModal')"&#62;&#215;&#60;/button&#62; &#60;/div&#62; &#60;div class="modal-body" style="padding: 0;"&#62; &#60;!-- Sistema de Pesta&#241;as para Configuraci&#243;n --&#62; &#60;div class="config-tabs-container"&#62;
&#60;!-- CORRECCI&#211;N PARA LA SECCI&#211;N DE BOTONES (Paso 2.1) --&#62; &#60;div class="config-tabs"&#62; &#60;!-- Bot&#243;n 1: F&#243;rmulas --&#62; &#60;button class="config-tab-button active" onclick="switchConfigTab('formulas')"&#62; &#60;svg
width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;rect x="3" y="3" width="18" height="18" rx="2"&#62;&#60;/rect&#62; &#60;path d="M3 9h18"&#62;&#60;/path&#62; &#60;path d="M9 21V9"&#62;&#60;/path&#62;
&#60;/svg&#62; &#60;span&#62;F&#243;rmulas Base&#60;/span&#62; &#60;/button&#62; &#60;!-- Bot&#243;n 2: Prompts (ESTE FALTABA) --&#62; &#60;button class="config-tab-button" onclick="switchConfigTab('prompts')"&#62; &#60;svg width="18" height="18" viewBox="0
0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"&#62;&#60;/path&#62;
&#60;/svg&#62; &#60;span&#62;Prompts para IA&#60;/span&#62; &#60;/button&#62; &#60;!-- Bot&#243;n 3: Filtros (NUEVO) --&#62; &#60;button class="config-tab-button" onclick="switchConfigTab('filters')"&#62; &#60;svg width="18" height="18" viewBox="0 0 24
24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path d="M4 21v-7"&#62;&#60;/path&#62; &#60;path d="M4 10V3"&#62;&#60;/path&#62; &#60;path d="M12 21v-9"&#62;&#60;/path&#62; &#60;path d="M12 8V3"&#62;&#60;/path&#62; &#60;path d="M20 21v-5"&#62;&#60;/path&#62;
&#60;path d="M20 12V3"&#62;&#60;/path&#62; &#60;path d="M1 14h6"&#62;&#60;/path&#62; &#60;path d="M9 8h6"&#62;&#60;/path&#62; &#60;path d="M17 16h6"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;span&#62;Filtros de Texto&#60;/span&#62; &#60;/button&#62; &#60;/div&#62;
&#60;/div&#62; &#60;!-- Contenido de las Pesta&#241;as --&#62; &#60;div class="config-tab-content-wrapper"&#62; &#60;!-- PESTA&#209;A 1: F&#243;rmulas Base --&#62; &#60;div class="config-tab-content active" id="configTabFormulas"&#62; &#60;div style="padding:
32px;"&#62; &#60;!-- Grid de Controles --&#62; &#60;div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;"&#62; &#60;!-- Columna: Contenido Corto --&#62; &#60;div&#62; &#60;div style="display: flex; align-items: center; gap: 12px; margin-bottom:
16px;"&#62; &#60;div style="background: #eff6ff; border: 1.5px solid #bfdbfe; width: 40px; height: 40px; border-radius: 10px; display: flex; align-items: center; justify-content: center;"&#62; &#60;svg width="20" height="20" viewBox="0 0 24 24" fill="none"
stroke="#2563eb" stroke-width="2"&#62;&#60;rect x="7" y="2" width="10" height="20" rx="2" ry="2"&#62;&#60;/rect&#62;&#60;path d="M12 18h.01"&#62;&#60;/path&#62;&#60;/svg&#62; &#60;/div&#62; &#60;div&#62; &#60;h3 style="font-size: 14px; font-weight: 700;
color: #1a1a1a; margin: 0;"&#62;Par&#225;metros para Contenido Corto&#60;/h3&#62; &#60;p style="font-size: 12px; color: #737373; margin: 2px 0 0 0;"&#62;(Shorts, Reels, TikToks)&#60;/p&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Control 1: Caracteres
por Escena (Corto) --&#62; &#60;div class="config-control-card" style="margin-bottom: 16px;"&#62; &#60;div class="config-control-header"&#62; &#60;div class="config-control-icon" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);"&#62;
&#60;svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"&#62;&#60;path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"&#62;&#60;/path&#62;&#60;polyline points="14 2 14 8 20 8"&#62;&#60;/polyline&#62;&#60;line
x1="16" y1="13" x2="8" y2="13"&#62;&#60;/line&#62;&#60;line x1="16" y1="17" x2="8" y2="17"&#62;&#60;/line&#62;&#60;/svg&#62; &#60;/div&#62; &#60;div&#62; &#60;div class="config-control-label"&#62;Base de Caracteres&#60;/div&#62; &#60;div class="config-control-value"
id="configCharactersShortDisplay"&#62;83&#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;div class="config-control-body"&#62; &#60;input type="range" id="configCharactersShort" min="50" max="150" value="83" class="config-slider" oninput="updateConfigDisplay()"&#62;
&#60;div class="config-slider-labels"&#62;&#60;span&#62;50&#60;/span&#62;&#60;span&#62;150&#60;/span&#62;&#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Control 2: Segundos por Escena (Corto) --&#62; &#60;div class="config-control-card"&#62; &#60;div
class="config-control-header"&#62; &#60;div class="config-control-icon" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);"&#62; &#60;svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"&#62;&#60;circle
cx="12" cy="12" r="10"&#62;&#60;/circle&#62;&#60;polyline points="12 6 12 12 16 14"&#62;&#60;/polyline&#62;&#60;/svg&#62; &#60;/div&#62; &#60;div&#62; &#60;div class="config-control-label"&#62;Duraci&#243;n por Escena&#60;/div&#62; &#60;div class="config-control-value"
id="configSecondsShortDisplay"&#62;5&#60;span style="font-size: 14px;"&#62;s&#60;/span&#62;&#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;div class="config-control-body"&#62; &#60;input type="range" id="configSecondsShort" min="3" max="10" value="5"
class="config-slider" oninput="updateConfigDisplay()"&#62; &#60;div class="config-slider-labels"&#62;&#60;span&#62;3s&#60;/span&#62;&#60;span&#62;10s&#60;/span&#62;&#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Columna: Contenido
Largo --&#62; &#60;div&#62; &#60;div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;"&#62; &#60;div style="background: #f1f5f9; border: 1.5px solid #e2e8f0; width: 40px; height: 40px; border-radius: 10px; display: flex; align-items:
center; justify-content: center;"&#62; &#60;svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#475569" stroke-width="2"&#62;&#60;rect x="2" y="3" width="20" height="14" rx="2" ry="2"&#62;&#60;/rect&#62;&#60;line x1="8" y1="21" x2="16"
y2="21"&#62;&#60;/line&#62;&#60;line x1="12" y1="17" x2="12" y2="21"&#62;&#60;/line&#62;&#60;/svg&#62; &#60;/div&#62; &#60;div&#62; &#60;h3 style="font-size: 14px; font-weight: 700; color: #1a1a1a; margin: 0;"&#62;Par&#225;metros para Contenido Largo&#60;/h3&#62;
&#60;p style="font-size: 12px; color: #737373; margin: 2px 0 0 0;"&#62;(YouTube, Documentales)&#60;/p&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Control 3: Caracteres por Escena (Largo) --&#62; &#60;div class="config-control-card" style="margin-bottom:
16px;"&#62; &#60;div class="config-control-header"&#62; &#60;div class="config-control-icon" style="background: linear-gradient(135deg, #64748b 0%, #475569 100%);"&#62; &#60;svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"&#62;&#60;path
d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"&#62;&#60;/path&#62;&#60;polyline points="14 2 14 8 20 8"&#62;&#60;/polyline&#62;&#60;line x1="16" y1="13" x2="8" y2="13"&#62;&#60;/line&#62;&#60;line x1="16" y1="17" x2="8" y2="17"&#62;&#60;/line&#62;&#60;/svg&#62;
&#60;/div&#62; &#60;div&#62; &#60;div class="config-control-label"&#62;Base de Caracteres&#60;/div&#62; &#60;div class="config-control-value" id="configCharactersLongDisplay"&#62;600&#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;div class="config-control-body"&#62;
&#60;input type="range" id="configCharactersLong" min="150" max="1000" step="10" value="600" class="config-slider" oninput="updateConfigDisplay()"&#62; &#60;div class="config-slider-labels"&#62;&#60;span&#62;150&#60;/span&#62;&#60;span&#62;1000&#60;/span&#62;&#60;/div&#62;
&#60;/div&#62; &#60;/div&#62; &#60;!-- Control 4: Segundos por Escena (Largo) --&#62; &#60;div class="config-control-card"&#62; &#60;div class="config-control-header"&#62; &#60;div class="config-control-icon" style="background: linear-gradient(135deg,
#6ee7b7 0%, #34d399 100%);"&#62; &#60;svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"&#62;&#60;circle cx="12" cy="12" r="10"&#62;&#60;/circle&#62;&#60;polyline points="12 6 12 12 16 14"&#62;&#60;/polyline&#62;&#60;/svg&#62;
&#60;/div&#62; &#60;div&#62; &#60;div class="config-control-label"&#62;Duraci&#243;n por Escena&#60;/div&#62; &#60;div class="config-control-value" id="configSecondsLongDisplay"&#62;20&#60;span style="font-size: 14px;"&#62;s&#60;/span&#62;&#60;/div&#62;
&#60;/div&#62; &#60;/div&#62; &#60;div class="config-control-body"&#62; &#60;input type="range" id="configSecondsLong" min="10" max="30" value="20" class="config-slider" oninput="updateConfigDisplay()"&#62; &#60;div class="config-slider-labels"&#62;&#60;span&#62;10s&#60;/span&#62;&#60;span&#62;30s&#60;/span&#62;&#60;/div&#62;
&#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Fin del grid --&#62; &#60;!-- Control de Coherencia (Se mantiene) --&#62; &#60;div class="config-control-card" style="margin-top: 24px;"&#62; &#60;div class="config-control-header"&#62;
&#60;div class="config-control-icon" style="background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);"&#62; &#60;svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"&#62;&#60;path d="M2 12h20M7 7l-5 5 5 5M17
7l5 5-5 5"&#62;&#60;/path&#62;&#60;/svg&#62; &#60;/div&#62; &#60;div&#62; &#60;div class="config-control-label"&#62;Ciclo de Coherencia&#60;/div&#62; &#60;div class="config-control-value" id="configCoherenceDisplay"&#62;5&#60;span style="font-size: 14px;
font-weight: 400; color: #737373;"&#62; escenas&#60;/span&#62;&#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;div class="config-control-body"&#62; &#60;input type="range" id="configSceneCoherenceLength" min="0" max="15" value="5" class="config-slider"
oninput="updateConfigDisplay()"&#62; &#60;div class="config-slider-labels"&#62; &#60;span&#62;0&#60;/span&#62; &#60;span style="color: #f59e0b; font-weight: 600;"&#62;Escenas por ciclo&#60;/span&#62; &#60;span&#62;15&#60;/span&#62; &#60;/div&#62; &#60;div
class="config-help-text"&#62;  Un valor de 0 desactiva la funci&#243;n de coherencia. &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- PESTA&#209;A 2: Generadores de IA --&#62; &#60;div class="config-tab-content" id="configTabPrompts"&#62;
&#60;div style="padding: 32px;"&#62; &#60;!-- Header Explicativo --&#62; &#60;div style="background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); border-left: 4px solid #22c55e; border-radius: 12px; padding: 20px; margin-bottom: 24px;"&#62; &#60;div
style="display: flex; align-items: start; gap: 16px;"&#62; &#60;div style="background: white; width: 48px; height: 48px; border-radius: 12px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 2px 8px rgba(34, 197,
94, 0.15);"&#62; &#60;svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2"&#62; &#60;path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21
12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;/div&#62; &#60;div style="flex: 1;"&#62; &#60;h3 style="font-size: 16px; font-weight: 700; color: #166534; margin-bottom: 8px;"&#62; &#10024; Generadores de Contenido
por IA &#60;/h3&#62; &#60;p style="font-size: 13px; color: #166534; line-height: 1.6; margin: 0;"&#62; Configura plantillas de prompts personalizadas para cada categor&#237;a. Usa &#60;code style="background: white; padding: 2px 6px; border-radius: 4px;
color: #22c55e; font-weight: 600;"&#62;(X)&#60;/code&#62; donde quieras que aparezca el n&#250;mero de escenas calculado. &#60;/p&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Lista de Prompts por Categor&#237;a --&#62; &#60;div id="configPromptsContainer"&#62;&#60;/div&#62;
&#60;/div&#62; &#60;/div&#62; &#60;!-- PESTA&#209;A 3: Filtros de Texto --&#62; &#60;div class="config-tab-content" id="configTabFilters"&#62; &#60;div style="padding: 32px;"&#62; &#60;!-- Header Explicativo --&#62; &#60;div style="background: linear-gradient(135deg,
#f5f5f5 0%, #e5e5e5 100%); border-left: 4px solid #525252; border-radius: 12px; padding: 20px; margin-bottom: 24px;"&#62; &#60;div style="display: flex; align-items: start; gap: 16px;"&#62; &#60;div style="background: white; width: 48px; height: 48px;
border-radius: 12px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 2px 8px rgba(0,0,0,0.1);"&#62; &#60;svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#525252" stroke-width="2"&#62; &#60;polyline
points="4 7 4 4 20 4 20 7"&#62;&#60;/polyline&#62; &#60;line x1="9" y1="20" x2="15" y2="20"&#62;&#60;/line&#62; &#60;line x1="12" y1="4" x2="12" y2="20"&#62;&#60;/line&#62; &#60;/svg&#62; &#60;/div&#62; &#60;div style="flex: 1;"&#62; &#60;h3 style="font-size:
16px; font-weight: 700; color: #1a1a1a; margin-bottom: 8px;"&#62; Reemplazo Autom&#225;tico &#60;/h3&#62; &#60;p style="font-size: 13px; color: #525252; line-height: 1.6; margin: 0;"&#62; Define palabras que ser&#225;n reemplazadas autom&#225;ticamente
al guardar un guion. &#218;til para corregir terminolog&#237;a t&#233;cnica o censurar palabras seg&#250;n la categor&#237;a. &#60;/p&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- &#193;rea de Creaci&#243;n --&#62; &#60;div class="filter-creation-card"&#62;
&#60;h4 style="font-size: 13px; font-weight: 700; color: #1a1a1a; margin-bottom: 12px;"&#62;NUEVA REGLA&#60;/h4&#62; &#60;div class="filter-inputs-row"&#62; &#60;div style="flex: 1;"&#62; &#60;label style="font-size: 11px; font-weight: 700; color: #737373;
display: block; margin-bottom: 6px;"&#62;ORIGINAL&#60;/label&#62; &#60;input type="text" id="newFilterOriginal" class="search-input" placeholder="Ej: codigo" style="background: #fff;"&#62; &#60;/div&#62; &#60;div class="filter-arrow"&#62; &#60;svg width="20"
height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;line x1="5" y1="12" x2="19" y2="12"&#62;&#60;/line&#62; &#60;polyline points="12 5 19 12 12 19"&#62;&#60;/polyline&#62; &#60;/svg&#62; &#60;/div&#62; &#60;div
style="flex: 1;"&#62; &#60;label style="font-size: 11px; font-weight: 700; color: #2563eb; display: block; margin-bottom: 6px;"&#62;REEMPLAZO&#60;/label&#62; &#60;input type="text" id="newFilterReplacement" class="search-input" placeholder="Ej: codix"
style="background: #fff; border-color: #bfdbfe;"&#62; &#60;/div&#62; &#60;/div&#62; &#60;label style="font-size: 11px; font-weight: 700; color: #737373;"&#62;APLICAR EN CATEGOR&#205;AS:&#60;/label&#62; &#60;div class="category-tags-selector" id="newFilterCategories"&#62;
&#60;!-- Se llenar&#225; con JS --&#62; &#60;/div&#62; &#60;button class="btn-add-filter" onclick="addNewFilter()" style="margin-top: 16px;"&#62; + Agregar Regla de Reemplazo &#60;/button&#62; &#60;/div&#62; &#60;!-- Lista de Filtros Existentes --&#62;
&#60;h4 style="font-size: 12px; font-weight: 700; color: #a3a3a3; letter-spacing: 0.05em; margin-bottom: 12px;"&#62;REGLAS ACTIVAS&#60;/h4&#62; &#60;div id="activeFiltersList"&#62; &#60;!-- Se llenar&#225; con JS --&#62; &#60;/div&#62; &#60;/div&#62;
&#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;div class="modal-footer" style="background: #fafafa; border-top: 2px solid #e5e5e5;"&#62; &#60;button type="button" class="btn-cancel" onclick="closeModal('configModal')" style="flex: 0 0 auto; min-width:
120px;"&#62; Cancelar &#60;/button&#62; &#60;button type="button" class="btn-save" onclick="saveConfiguration()" style="flex: 0 0 auto; min-width: 180px; background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); box-shadow: 0 2px 8px rgba(37, 99,
235, 0.3);"&#62; &#60;svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 6px;"&#62; &#60;polyline points="20 6 9 17 4 12"&#62;&#60;/polyline&#62; &#60;/svg&#62; Guardar Configuraci&#243;n
&#60;/button&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Modal de Generaci&#243;n de Im&#225;genes/Video --&#62; &#60;div class="prompts-generator-modal" id="promptsGeneratorModal"&#62; &#60;div class="prompts-generator-content"&#62; &#60;!--
Header --&#62; &#60;div class="prompts-generator-header"&#62; &#60;div class="prompts-header-left"&#62; &#60;div class="prompts-header-icon"&#62; &#60;svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"&#62; &#60;path
d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;/div&#62; &#60;div class="prompts-header-title-group"&#62;
&#60;h2&#62;Generador de Prompts&#60;/h2&#62; &#60;p class="prompts-header-subtitle"&#62;Visualiza y copia prompts uno por uno&#60;/p&#62; &#60;/div&#62; &#60;/div&#62; &#60;button class="btn-close-circle" onclick="closePromptsGenerator()" title="Cerrar
(Esc)"&#62;&#215;&#60;/button&#62; &#60;/div&#62; &#60;!-- Cuerpo - Dos Paneles --&#62; &#60;div class="prompts-generator-body"&#62; &#60;!-- Panel Izquierdo: Input y Referencias --&#62; &#60;div class="prompts-input-panel"&#62; &#60;div class="prompts-input-content"&#62;
&#60;!-- Paso 1: Referencias Visuales --&#62; &#60;div class="prompts-references-panel" id="promptsReferencesPanel" style="display: none; padding: 0; border: none;"&#62; &#60;div class="prompts-references-header"&#62; &#60;div class="prompts-references-header-icon"&#62;
&#60;svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"&#62; &#60;rect x="3" y="3" width="18" height="18" rx="2" ry="2"&#62;&#60;/rect&#62; &#60;circle cx="8.5" cy="8.5" r="1.5"&#62;&#60;/circle&#62; &#60;polyline
points="21 15 16 10 5 21"&#62;&#60;/polyline&#62; &#60;/svg&#62; &#60;/div&#62; &#60;h4 class="prompts-references-title"&#62;Referencias Visuales&#60;/h4&#62; &#60;/div&#62; &#60;div class="prompts-references-grid" id="promptsReferencesGrid"&#62; &#60;!--
Las referencias se cargar&#225;n din&#225;micamente aqu&#237; --&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Paso 2: Cargar Prompts --&#62; &#60;div id="promptsLoaderSection" style="margin-top: 24px;"&#62; &#60;h3 class="prompts-input-section-title"&#62;
&#60;svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"&#62;&#60;/path&#62; &#60;rect x="9" y="3" width="6" height="4"
rx="2"&#62;&#60;/rect&#62; &#60;/svg&#62; Cargar Prompts &#60;/h3&#62; &#60;textarea class="prompts-paste-area" id="promptsPasteArea" placeholder="Pega aqu&#237; la lista de prompts generada por la IA..."&#62;&#60;/textarea&#62; &#60;div class="prompts-input-hint"&#62;
&#60;svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="flex-shrink: 0;"&#62; &#60;circle cx="12" cy="12" r="10"&#62;&#60;/circle&#62;&#60;line x1="12" y1="16" x2="12" y2="12"&#62;&#60;/line&#62;&#60;line
x1="12" y1="8" x2="12.01" y2="8"&#62;&#60;/line&#62; &#60;/svg&#62; &#60;span&#62;El sistema espera una lista numerada (1., 2., 3., etc.). El bot&#243;n procesar&#225; todo el texto que pegues.&#60;/span&#62; &#60;/div&#62; &#60;!-- MODIFICACI&#211;N:
Contenedor para los botones de procesamiento --&#62; &#60;div style="display: flex; gap: 8px; margin-top: 16px;"&#62; &#60;button type="button" class="prompts-btn-process" id="pasteAndProcessBtn" onclick="pasteAndProcessFromClipboard()" style="flex: 1;
background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);" onmouseover="this.style.background='linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)'" onmouseout="this.style.background='linear-gradient(135deg,
#3b82f6 0%, #2563eb 100%)'"&#62; &#60;svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"&#62;&#60;/path&#62; &#60;rect
x="8" y="2" width="8" height="4" rx="1" ry="1"&#62;&#60;/rect&#62; &#60;/svg&#62; &#60;span&#62;Pegar y Procesar&#60;/span&#62; &#60;/button&#62; &#60;button class="prompts-btn-process" id="promptsProcessBtn" onclick="processPromptsFromTextArea()" style="flex:
1;"&#62; &#60;svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path d="M12 20h.01"&#62;&#60;/path&#62;&#60;path d="M12 4v12"&#62;&#60;/path&#62;&#60;path d="m15 15-3 3-3-3"&#62;&#60;/path&#62;
&#60;/svg&#62; &#60;span&#62;Procesar&#60;/span&#62; &#60;/button&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Panel Derecho: Visualizaci&#243;n de Prompts --&#62; &#60;div class="prompts-display-panel"&#62; &#60;!-- Estado
1: Esperando Input --&#62; &#60;div class="prompts-waiting-state active" id="promptsWaitingState"&#62; &#60;div class="prompts-waiting-icon"&#62; &#60;svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2"&#62; &#60;path
d="m15 15-3 3-3-3"&#62;&#60;/path&#62;&#60;path d="M12 18V3"&#62;&#60;/path&#62;&#60;path d="M21 12H3"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;/div&#62; &#60;h3 class="prompts-waiting-title"&#62;Listo para Visualizar&#60;/h3&#62; &#60;p class="prompts-waiting-text"&#62;Pega
el contenido en el panel izquierdo y presiona "Procesar" para comenzar.&#60;/p&#62; &#60;/div&#62; &#60;!-- Estado 2: Mostrando Prompt Actual --&#62; &#60;div class="prompts-active-state" id="promptsActiveState"&#62; &#60;div class="prompts-display-content"&#62;
&#60;div class="prompts-current-wrapper"&#62; &#60;div class="prompts-current-badge"&#62; &#60;svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3
12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;span id="promptsCurrentBadge"&#62;Prompt 1&#60;/span&#62; &#60;div id="sceneCoherenceLed"
class="scene-coherence-led" title="Indicador de Coherencia de Escena"&#62;&#60;/div&#62; &#60;/div&#62; &#60;div class="prompts-current-content" id="promptsCurrentContent"&#62; &#60;!-- El prompt actual se mostrar&#225; aqu&#237; --&#62; &#60;/div&#62;
&#60;button class="prompts-read-more-btn" id="promptsReadMoreBtn" onclick="togglePromptExpansion()"&#62; &#60;span id="readMoreBtnText"&#62;Leer M&#225;s&#60;/span&#62; &#60;svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
stroke-width="2"&#62; &#60;polyline points="6 9 12 15 18 9"&#62;&#60;/polyline&#62; &#60;/svg&#62; &#60;/button&#62; &#60;/div&#62; &#60;/div&#62; &#60;div class="prompts-display-footer"&#62; &#60;div class="prompts-actions-row"&#62; &#60;button class="prompts-btn-prev"
id="promptsPrevBtn" onclick="prevPrompt()" style="flex: 1;"&#62; &#60;svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62;&#60;polyline points="15 18 9 12 15 6"&#62;&#60;/polyline&#62;&#60;/svg&#62; &#60;span&#62;Anterior&#60;/span&#62;
&#60;/button&#62; &#60;button class="prompts-btn-copy-current" id="promptsCopyBtn" onclick="copyCurrentPrompt()"&#62; &#60;svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62;&#60;rect x="9" y="9" width="13"
height="13" rx="2" ry="2"&#62;&#60;/rect&#62;&#60;path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"&#62;&#60;/path&#62;&#60;/svg&#62; &#60;span id="promptsCopyBtnText"&#62;Copiar Prompt&#60;/span&#62; &#60;/button&#62; &#60;button class="prompts-btn-next"
id="promptsNextBtn" onclick="nextPrompt()"&#62; &#60;span id="promptsNextBtnText"&#62;Siguiente Prompt&#60;/span&#62; &#60;svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62;&#60;polyline points="9 18
15 12 9 6"&#62;&#60;/polyline&#62;&#60;/svg&#62; &#60;/button&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Estado 3: Completado --&#62; &#60;div class="prompts-completed-state" id="promptsCompletedState"&#62; &#60;div class="prompts-completed-icon"&#62;
&#60;svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2"&#62;&#60;polyline points="20 6 9 17 4 12"&#62;&#60;/polyline&#62;&#60;/svg&#62; &#60;/div&#62; &#60;h3 class="prompts-completed-title"&#62;&#161;Proceso
Completado!&#60;/h3&#62; &#60;p class="prompts-completed-text"&#62;Has revisado todos los prompts. Puedes cerrar esta ventana o procesar un nuevo lote.&#60;/p&#62; &#60;button class="prompts-btn-reset" onclick="resetPromptsGenerator()" style="margin-top:
24px;"&#62; &#60;svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62;&#60;polyline points="1 4 1 10 7 10"&#62;&#60;/polyline&#62;&#60;path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"&#62;&#60;/path&#62;&#60;/svg&#62;
&#60;span&#62;Procesar Nuevos Prompts&#60;/span&#62; &#60;/button&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;!-- Modal de Confirmaci&#243;n para Reinicio de Prompts --&#62; &#60;div class="confirm-dialog" id="confirmRestartPromptsDialog"&#62;
&#60;div class="confirm-content"&#62; &#60;div class="confirm-icon" style="background: #fef3c7;"&#62; &#60;svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2"&#62; &#60;polyline points="1 4 1 10 7 10"&#62;&#60;/polyline&#62;
&#60;path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;/div&#62; &#60;h3 class="confirm-title"&#62;&#191;Reiniciar y cargar nuevos prompts?&#60;/h3&#62; &#60;p class="confirm-message"&#62;Se perder&#225; el progreso actual
de la visualizaci&#243;n de prompts.&#60;/p&#62; &#60;div class="confirm-actions"&#62; &#60;button class="btn-confirm btn-confirm-cancel" onclick="closeRestartPromptsDialog()"&#62; Cancelar &#60;/button&#62; &#60;button class="btn-confirm" style="background:
#f59e0b; color: white;" onclick="confirmRestartPrompts()"&#62; S&#237;, Reiniciar &#60;/button&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;script&#62; let scripts = []; let categories = []; let wordFilters = []; // &#60;--- NUEVA VARIABLE GLOBAL
let currentFilter = 'all'; let currentViewIndex = -1; let filteredScripts = []; let searchQuery = ''; // Nuevos filtros avanzados let statusFilter = 'available'; let sortFilter = 'recent'; let filtersActive = false; // Variables para selecci&#243;n m&#250;ltiple
let selectionMode = false; let selectedScripts = new Set(); let confirmCallback = null; // NUEVO: Variables de configuraci&#243;n para c&#225;lculo de escenas let config = { formulas: { short: { charactersPerScene: 83, secondsPerScene: 5 }, long: { charactersPerScene:
600, secondsPerScene: 20 } }, sceneCoherenceLength: 5 }; // NUEVO: Prompt maestro por defecto para generaci&#243;n cinematogr&#225;fica const DEFAULT_PROMPT_TEMPLATE = `Sistema de Generaci&#243;n de Prompts Cinematogr&#225;ficos para IA Por favor solo
responde a lo que te pido, no adicciones elementos extras ni estructuras de respuestas diferentes a la que te pido Pide en cada prompt utilizar la base el estilo, escena y asunto de estas imagenes. Siempre que se pueda y vea necesario [REGLA CR&#205;TICA]
**NO GENERAR IM&#193;GENES**. Solo se debe producir el texto del prompt de imagen seg&#250;n el formato y las especificaciones. [REGLA ESTRICTA] Responde siempre breve, directo, sin explicaciones ni comentarios adicionales. No improvises ni te salgas
de las instrucciones. No utilices emojis en ning&#250;n caso. [INSTRUCCI&#211;N MAESTRA UNIVERSAL] Eres un ingeniero de prompts de la m&#225;s alta calidad. **Genera (X) prompts** de im&#225;genes al estilo cinematogr&#225;fico de alta calidad para que
coincidan con el guion proporcionado. Cada prompt debe contener la mayor cantidad de detalles posibles para una precisi&#243;n m&#225;xima. [FORMATO DE RESPUESTA REQUERIDO] La respuesta debe ser siempre una lista numerada (1., 2., 3., etc.) de prompts
de im&#225;genes individuales. Cada elemento de la lista debe introducir la referencia del guion y el estilo, utilizando esta estructura: [Referencia del Guion]: [Estilo]: Prompt de imagen: [PROMPT DE ALTO DETALLE]  Principios de Dise&#241;o Visual
(Cinematogr&#225;fico Universal) 1. Fidelidad Narrativa: Cada imagen debe seguir y potenciar la historia del guion, buscando generar una fuerte conexi&#243;n emocional e inter&#233;s en cada cambio de escena. 2. Coherencia y Arco del Personaje (CR&#205;TICO):
* Primeras Escenas: El prompt debe especificar una versi&#243;n del personaje lo m&#225;s **realista, estable y aut&#233;ntica posible** para fomentar la identificaci&#243;n y la conexi&#243;n inicial con la audiencia. * Progresi&#243;n: Mantener la coherencia
del personaje (rasgos, vestimenta, ambiente) a lo largo de todas las escenas. 3. Integraci&#243;n de Interacci&#243;n (Si Aplica): Si el guion menciona una interacci&#243;n (ej. "Comenta", "Dale Like"), el prompt debe solicitar que se incorpore discretamente
en la composici&#243;n (ej. un recurso, &#237;tem, dise&#241;o, o texto flotante) relacionado con esa acci&#243;n, incluyendo el t&#237;tulo de la interacci&#243;n (ej. "Add Interaction Title").  Estilo y Atm&#243;sfera (Adaptable) * Estilo Visual:
Realismo Cinematogr&#225;fico de Alto Contraste (Ajusta el contraste seg&#250;n el nicho: oscuro-noir para terror/drama; brillante-vibrante para comedia/alegr&#237;a). * Composici&#243;n: Uso exhaustivo de la iluminaci&#243;n direccional (ej. *key lighting*,
*fill lighting* y *rim lighting*) para destacar al personaje y crear atm&#243;sfera. * Detalle: Texturas ricas y composici&#243;n profunda. * Tonos: Paleta de colores consistente que refleje el estado de &#225;nimo exacto del momento. * Intensidad Emocional:
Expresiones faciales de los personajes que capturen con precisi&#243;n la emoci&#243;n requerida (miedo palpable, alegr&#237;a desbordante, profunda melancol&#237;a). &#9881; Especificaciones T&#233;cnicas * T&#233;cnica: Fotograf&#237;a Cinematogr&#225;fica
(lentes *anam&#243;rficos*), Pintura Digital, o Estilo 3D Fotorrealista (especificar). * Resoluci&#243;n: 8K (ultra detallado). * Detalle: Extremadamente detallado, hiperrealista, con enfoque en la textura de la piel, ropa y entorno. * &#193;nimo: Estado
de &#225;nimo cinematogr&#225;fico y atm&#243;sfera visualmente consistente en todos los fotogramas, manteniendo la cohesi&#243;n. PIDE EN CADA PROMPT QUE EN MEDIDA DE LO POSIBLE, EN TODAS LAS ESCENAS UTILICE EL ASUNTO, ESCENA Y ESTILO. TAMBIEN ES DEMASIADO
IMPORTANTE QUE NO DES INSTRUCCIONES REFERENTES A GENERACION DE TITULOS O TEXTOS EN ESTAS ESCENAS, ES DECIR No coloques texto, REEMPLAZA TEXTO POR solo iconos referentes o emojis etc`; function initializeData() { scripts = JSON.parse(localStorage.getItem('scripts')
|| '[]'); wordFilters = JSON.parse(localStorage.getItem('wordFilters') || '[]'); const storedCategories = JSON.parse(localStorage.getItem('categories') || '[]'); // Migraci&#243;n de categor&#237;as a la nueva estructura categories = storedCategories.map(cat
=&#62; { if (typeof cat === 'string') { return { name: cat, path: '', exportPath: '', contentType: 'short', // &#60;-- A&#209;ADIDO promptTemplate: DEFAULT_PROMPT_TEMPLATE, visualReferences: { asunto: null, escena: null, estilo: null } }; } // Asegurar
que las propiedades existen para la compatibilidad hacia atr&#225;s cat.exportPath = cat.exportPath || ''; cat.contentType = cat.contentType || 'short'; // &#60;-- A&#209;ADIDO (Migraci&#243;n) cat.visualReferences = cat.visualReferences || { asunto:
null, escena: null, estilo: null }; cat.promptTemplate = cat.promptTemplate || DEFAULT_PROMPT_TEMPLATE; return cat; }); // Carga de configuraci&#243;n con estructura anidada const storedConfig = JSON.parse(localStorage.getItem('config') || 'null'); if
(storedConfig) { // Fusi&#243;n profunda para mantener la estructura de f&#243;rmulas if (storedConfig.formulas) { config.formulas.short = { ...config.formulas.short, ...storedConfig.formulas.short }; config.formulas.long = { ...config.formulas.long,
...storedConfig.formulas.long }; } if (storedConfig.sceneCoherenceLength !== undefined) { config.sceneCoherenceLength = storedConfig.sceneCoherenceLength; } } saveData(); updateUI(); } // NUEVAS FUNCIONES: B&#250;squeda de categor&#237;as function handleCategorySearch()
{ const searchInput = document.getElementById('categorySearchInput'); const clearBtn = document.getElementById('categorySearchClear'); const searchTerm = searchInput.value.toLowerCase().trim(); // Mostrar/ocultar bot&#243;n de limpiar if (searchTerm)
{ clearBtn.style.display = 'flex'; } else { clearBtn.style.display = 'none'; } filterCategoriesDisplay(searchTerm); } function clearCategorySearch() { const searchInput = document.getElementById('categorySearchInput'); const clearBtn = document.getElementById('categorySearchClear');
searchInput.value = ''; clearBtn.style.display = 'none'; searchInput.focus(); filterCategoriesDisplay(''); } function filterCategoriesDisplay(searchTerm) { const categoryList = document.getElementById('categoryList'); const categoryItems = categoryList.querySelectorAll('.category-item');
let visibleCount = 0; let hasAllCategory = false; categoryItems.forEach((item, index) =&#62; { // La primera categor&#237;a es "Todos los guiones" - siempre visible si no hay b&#250;squeda if (index === 0) { hasAllCategory = true; if (searchTerm) { const
text = item.textContent.toLowerCase(); if (text.includes(searchTerm)) { item.classList.remove('hidden'); visibleCount++; } else { item.classList.add('hidden'); } } else { item.classList.remove('hidden'); visibleCount++; } return; } // Resto de categor&#237;as
const categoryContent = item.querySelector('.category-item-content span'); if (categoryContent) { const categoryText = categoryContent.textContent.toLowerCase(); if (!searchTerm || categoryText.includes(searchTerm)) { item.classList.remove('hidden');
visibleCount++; } else { item.classList.add('hidden'); } } }); // Mostrar mensaje si no hay resultados let noResultsMsg = categoryList.querySelector('.category-no-results'); if (visibleCount === 0 || (visibleCount === 1 &#38;&#38; hasAllCategory &#38;&#38;
searchTerm)) { if (!noResultsMsg) { noResultsMsg = document.createElement('div'); noResultsMsg.className = 'category-no-results'; categoryList.appendChild(noResultsMsg); } noResultsMsg.textContent = 'No se encontraron categor&#237;as'; noResultsMsg.style.display
= 'block'; } else { if (noResultsMsg) { noResultsMsg.style.display = 'none'; } } } function saveData() { localStorage.setItem('scripts', JSON.stringify(scripts)); localStorage.setItem('categories', JSON.stringify(categories)); localStorage.setItem('config',
JSON.stringify(config)); localStorage.setItem('wordFilters', JSON.stringify(wordFilters)); // &#60;--- NUEVO } // ============================================ // FUNCIONES DE C&#193;LCULO DE ESCENAS // ============================================ function
getFormulaForCategory(categoryName) { const category = categories.find(cat =&#62; cat.name === categoryName); const contentType = category ? category.contentType : 'short'; // Por defecto 'short' return config.formulas[contentType] || config.formulas.short;
} function calculateScenes(content, categoryName) { const formula = getFormulaForCategory(categoryName); const totalCharacters = content.length; const scenes = Math.round(totalCharacters / formula.charactersPerScene); return scenes &#62; 0 ? scenes :
1; } function calculateDuration(scenes, categoryName) { const formula = getFormulaForCategory(categoryName); return scenes * formula.secondsPerScene; } function formatDuration(seconds) { if (seconds &#60; 60) { return `${seconds}s`; } const minutes =
Math.floor(seconds / 60); const remainingSeconds = seconds % 60; return remainingSeconds &#62; 0 ? `${minutes}m ${remainingSeconds}s` : `${minutes}m`; } function resolvePromptTemplate(template, scenes) { return template.replace(/\(X\)/g, scenes); } //
============================================ // FIN DE FUNCIONES DE C&#193;LCULO // ============================================ function toggleCategoryInput() { const input = document.getElementById('categoryInput'); input.classList.toggle('active');
if (input.classList.contains('active')) { document.getElementById('newCategoryInput').focus(); } else { document.getElementById('newCategoryInput').value = ''; document.getElementById('newCategoryPath').value = ''; document.getElementById('newCategoryExportPath').value
= ''; // &#9989; NUEVO: Limpiar tambi&#233;n el campo de prompt const promptInput = document.getElementById('newCategoryPrompt'); if (promptInput) promptInput.value = ''; } } // &#10024; Variable global para referencias temporales de nueva categor&#237;a
let tempNewCategoryReferences = { asunto: null, escena: null, estilo: null }; function addCategory() { const nameInput = document.getElementById('newCategoryInput'); const pathInput = document.getElementById('newCategoryPath'); const exportPathInput =
document.getElementById('newCategoryExportPath'); const promptInput = document.getElementById('newCategoryPrompt'); const categoryName = nameInput.value.trim(); const categoryPath = pathInput.value.trim(); // &#10024; MODIFICACI&#211;N: Si el campo est&#225;
vac&#237;o, se asigna 'Descargas'. const categoryExportPath = exportPathInput.value.trim() || 'Descargas'; const categoryPrompt = (promptInput &#38;&#38; promptInput.value.trim()) ? promptInput.value.trim() : DEFAULT_PROMPT_TEMPLATE; if (!categoryName)
{ alert('Por favor, ingresa un nombre para la categor&#237;a'); return; } // &#10024; ELIMINADO: Se elimina el bloque de validaci&#243;n para la ruta de exportaci&#243;n. if (categories.some(cat =&#62; cat.name === categoryName)) { alert('Ya existe una
categor&#237;a con ese nombre'); return; } // Obtener tipo de contenido seleccionado const selectedType = document.querySelector('#newCategoryTypeSelector .active').dataset.type; // &#10024; Incluir referencias visuales y tipo de contenido categories.push({
name: categoryName, path: categoryPath || '', exportPath: categoryExportPath, contentType: selectedType, // &#60;-- A&#209;ADIDO promptTemplate: categoryPrompt, visualReferences: { asunto: tempNewCategoryReferences.asunto, escena: tempNewCategoryReferences.escena,
estilo: tempNewCategoryReferences.estilo } }); // Limpiar referencias temporales tempNewCategoryReferences = { asunto: null, escena: null, estilo: null }; // Resetear inputs de archivo ['asunto', 'escena', 'estilo'].forEach(type =&#62; { const input =
document.getElementById(`newInput${type.charAt(0).toUpperCase() + type.slice(1)}`); const label = document.getElementById(`newLabel${type.charAt(0).toUpperCase() + type.slice(1)}`); const btn = document.getElementById(`newBtnRemove${type.charAt(0).toUpperCase()
+ type.slice(1)}`); if (input) input.value = ''; if (label) label.textContent = type.charAt(0).toUpperCase() + type.slice(1); if (btn) { btn.disabled = true; btn.style.opacity = '0.5'; } }); saveData(); updateUI(); nameInput.value = ''; pathInput.value
= ''; exportPathInput.value = ''; promptInput.value = ''; toggleCategoryInput(); } // &#10024; Funci&#243;n para manejar subida de referencias en nueva categor&#237;a function handleNewReferenceUpload(type, event) { const file = event.target.files[0];
if (!file) return; if (!file.type.startsWith('image/')) { alert('Por favor, selecciona un archivo de imagen v&#225;lido'); event.target.value = ''; return; } if (file.size &#62; 5 * 1024 * 1024) { alert('La imagen es demasiado grande. El tama&#241;o m&#225;ximo
es 5MB'); event.target.value = ''; return; } const reader = new FileReader(); reader.onload = function(e) { const base64String = e.target.result; tempNewCategoryReferences[type] = base64String; // Actualizar UI const label = document.getElementById(`newLabel${type.charAt(0).toUpperCase()
+ type.slice(1)}`); const btn = document.getElementById(`newBtnRemove${type.charAt(0).toUpperCase() + type.slice(1)}`); if (label) { label.textContent = `&#10003; ${type.charAt(0).toUpperCase() + type.slice(1)}`; label.parentElement.style.borderColor
= '#8b5cf6'; label.parentElement.style.borderStyle = 'solid'; label.parentElement.style.background = '#f5f3ff'; } if (btn) { btn.disabled = false; btn.style.opacity = '1'; } }; reader.onerror = function() { alert('Error al leer el archivo. Por favor,
intenta de nuevo.'); event.target.value = ''; }; reader.readAsDataURL(file); } // &#10024; Funci&#243;n para eliminar referencias en nueva categor&#237;a function removeNewReference(type) { tempNewCategoryReferences[type] = null; const input = document.getElementById(`newInput${type.charAt(0).toUpperCase()
+ type.slice(1)}`); const label = document.getElementById(`newLabel${type.charAt(0).toUpperCase() + type.slice(1)}`); const btn = document.getElementById(`newBtnRemove${type.charAt(0).toUpperCase() + type.slice(1)}`); if (input) input.value = ''; if (label)
{ label.textContent = type.charAt(0).toUpperCase() + type.slice(1); label.parentElement.style.borderColor = '#d1d5db'; label.parentElement.style.borderStyle = 'dashed'; label.parentElement.style.background = 'white'; } if (btn) { btn.disabled = true;
btn.style.opacity = '0.5'; } } function openEditCategoryModal(categoryName) { const category = categories.find(cat =&#62; cat.name === categoryName); if (!category) return; // Mostrar informaci&#243;n actual document.getElementById('editCurrentCategoryName').textContent
= category.name; document.getElementById('editCategoryOriginalName').value = category.name; document.getElementById('editCategoryName').value = category.name; document.getElementById('editCategoryPath').value = category.path || ''; document.getElementById('editCategoryExportPath').value
= category.exportPath || ''; document.getElementById('editCategoryPrompt').value = category.promptTemplate || 'Genera (X) prompts de im&#225;genes para el siguiente guion'; // Contar scripts afectados const affectedCount = scripts.filter(s =&#62; s.category
=== categoryName).length; const warningBox = document.getElementById('editWarningBox'); const affectedCountEl = document.getElementById('affectedScriptsCount'); if (affectedCount &#62; 0) { affectedCountEl.textContent = affectedCount; warningBox.style.display
= 'flex'; } else { warningBox.style.display = 'none'; } // Establecer el tipo de contenido actual const typeSelector = document.getElementById('editCategoryTypeSelector'); typeSelector.querySelectorAll('.filter-option').forEach(btn =&#62; btn.classList.remove('active'));
const currentTypeButton = typeSelector.querySelector(`[data-type="${category.contentType || 'short'}"]`); if (currentTypeButton) currentTypeButton.classList.add('active'); // Cargar referencias visuales existentes loadVisualReferences(category.visualReferences
|| { asunto: null, escena: null, estilo: null }); document.getElementById('editCategoryModal').classList.add('active'); document.getElementById('editCategoryName').focus(); } function saveEditCategory(event) { event.preventDefault(); const originalName
= document.getElementById('editCategoryOriginalName').value; const newName = document.getElementById('editCategoryName').value.trim(); const newPath = document.getElementById('editCategoryPath').value.trim(); const newExportPath = document.getElementById('editCategoryExportPath').value.trim();
const newPrompt = document.getElementById('editCategoryPrompt').value.trim() || 'Genera (X) prompts de im&#225;genes para el siguiente guion'; if (!newName) { alert('Por favor, ingresa un nombre para la categor&#237;a'); return; } if (!newExportPath)
{ alert('Por favor, ingresa la ruta de exportaci&#243;n del video (campo obligatorio)'); document.getElementById('editCategoryExportPath').focus(); return; } // Verificar si el nuevo nombre ya existe (excepto si es el mismo) if (newName !== originalName
&#38;&#38; categories.some(cat =&#62; cat.name === newName)) { alert('Ya existe una categor&#237;a con ese nombre'); return; } // Actualizar la categor&#237;a const newContentType = document.querySelector('#editCategoryTypeSelector .active').dataset.type;
// Actualizar la categor&#237;a const categoryIndex = categories.findIndex(cat =&#62; cat.name === originalName); if (categoryIndex !== -1) { categories[categoryIndex] = { name: newName, path: newPath, exportPath: newExportPath, contentType: newContentType,
// &#60;-- A&#209;ADIDO promptTemplate: newPrompt, visualReferences: tempVisualReferences }; // Actualizar todos los scripts que usan esta categor&#237;a scripts.forEach(script =&#62; { if (script.category === originalName) { script.category = newName;
} }); // Si estamos viendo esta categor&#237;a, actualizar el filtro if (currentFilter === originalName) { currentFilter = newName; } saveData(); updateUI(); closeModal('editCategoryModal'); } } // DESPU&#201;S (C&#243;digo nuevo y mejorado) function
openEditScriptModal() { if (currentViewIndex &#60; 0 || !filteredScripts[currentViewIndex]) return; const script = filteredScripts[currentViewIndex]; const originalScript = scripts.find(s =&#62; s.id === script.id); if (!originalScript) return; // Llenar
formulario b&#225;sico document.getElementById('editCurrentScriptTitle').textContent = originalScript.title; document.getElementById('editScriptId').value = originalScript.id; document.getElementById('editScriptTitle').value = originalScript.title; document.getElementById('editScriptContent').value
= originalScript.content; // Actualizar y establecer categor&#237;a updateEditScriptCategorySelect(); document.getElementById('editScriptCategory').value = originalScript.category; // === INICIO C&#211;DIGO NUEVO === // Cargar referencias visuales personalizadas
const category = categories.find(cat =&#62; cat.name === originalScript.category) || {}; loadCustomVisualsEditor(originalScript.customVisuals, category.visualReferences); // === FIN C&#211;DIGO NUEVO === // Abrir modal closeModal('viewModal'); document.getElementById('editScriptModal').classList.add('active');
document.getElementById('editScriptTitle').focus(); } function updateEditScriptCategorySelect() { const select = document.getElementById('editScriptCategory'); select.innerHTML = ''; // Agregar opci&#243;n "Sin categor&#237;a" const emptyOption = document.createElement('option');
emptyOption.value = ''; emptyOption.textContent = 'Sin categor&#237;a'; emptyOption.style.color = '#a3a3a3'; select.appendChild(emptyOption); // Agregar todas las categor&#237;as disponibles if (categories.length === 0) { const option = document.createElement('option');
option.value = 'General'; option.textContent = 'General'; select.appendChild(option); } else { categories.forEach(cat =&#62; { const option = document.createElement('option'); option.value = cat.name; option.textContent = cat.name; select.appendChild(option);
}); } } // DESPU&#201;S (C&#243;digo nuevo y mejorado) function saveEditScript(event) { event.preventDefault(); const scriptId = parseInt(document.getElementById('editScriptId').value); const title = document.getElementById('editScriptTitle').value.trim();
let category = document.getElementById('editScriptCategory').value.trim(); const content = document.getElementById('editScriptContent').value.trim(); if (!title) { alert('Por favor, ingresa un t&#237;tulo para el gui&#243;n'); return; } if (!category)
{ category = 'General'; if (!categories.some(cat =&#62; cat.name === 'General')) { categories.push({ name: 'General', path: '' }); } } const scriptIndex = scripts.findIndex(s =&#62; s.id === scriptId); if (scriptIndex !== -1) { const processedContent
= processTextReplacement(content, category); scripts[scriptIndex].title = title; scripts[scriptIndex].category = category; scripts[scriptIndex].content = processedContent; scripts[scriptIndex].updatedAt = new Date().toISOString(); // === INICIO C&#211;DIGO
NUEVO === // Guardar referencias visuales personalizadas const hasCustomVisuals = Object.values(tempCustomVisuals).some(val =&#62; val !== null); if (hasCustomVisuals) { scripts[scriptIndex].customVisuals = tempCustomVisuals; } else { // Si todos los
campos est&#225;n vac&#237;os, elimina la propiedad para mantener los datos limpios delete scripts[scriptIndex].customVisuals; } // === FIN C&#211;DIGO NUEVO === saveData(); updateUI(); closeModal('editScriptModal'); alert('&#161;Gui&#243;n actualizado
exitosamente!'); } } function deleteCategory(categoryName) { const scriptsInCategory = scripts.filter(s =&#62; s.category === categoryName).length; let message = `Se eliminar&#225; permanentemente la categor&#237;a "${categoryName}".`; if (scriptsInCategory
&#62; 0) { message += ` Los ${scriptsInCategory} guion(es) asociado(s) se mover&#225;n a "General".`; } showConfirmDialog( '&#191;Eliminar categor&#237;a?', message, () =&#62; { // Mover scripts a General if (scriptsInCategory &#62; 0) { // Asegurarse
de que existe la categor&#237;a General if (!categories.some(cat =&#62; cat.name === 'General')) { categories.push({ name: 'General', path: '' }); } scripts.forEach(script =&#62; { if (script.category === categoryName) { script.category = 'General'; }
}); } // Eliminar la categor&#237;a categories = categories.filter(cat =&#62; cat.name !== categoryName); // Si est&#225;bamos viendo esta categor&#237;a, volver a "all" if (currentFilter === categoryName) { currentFilter = 'all'; } saveData(); updateUI();
} ); } function filterCategory(category) { currentFilter = category; document.querySelectorAll('.category-item').forEach(item =&#62; { item.classList.remove('active'); }); // Buscar el elemento correcto para agregar la clase active const categoryItems
= document.querySelectorAll('.category-item'); categoryItems.forEach(item =&#62; { const content = item.querySelector('.category-item-content span'); if (content &#38;&#38; content.textContent.includes(category)) { item.classList.add('active'); } else
if (category === 'all' &#38;&#38; content &#38;&#38; content.textContent.includes('Todos los guiones')) { item.classList.add('active'); } }); if (category === 'all') { document.getElementById('mainTitle').textContent = 'Todos los guiones'; } else { document.getElementById('mainTitle').textContent
= category; } renderScripts(); // Actualizar botones de acci&#243;n r&#225;pida updateQuickActionButtons(); } function openAddModal() { updateCategorySelect(); updateBulkCategorySelect(); // Limpiar formulario individual document.getElementById('scriptContent').value
= ''; // Si hay una categor&#237;a seleccionada y no es "all" if (currentFilter !== 'all') { // Establecer el t&#237;tulo autom&#225;ticamente con el nombre de la categor&#237;a document.getElementById('scriptTitle').value = currentFilter; // Establecer
la categor&#237;a seleccionada autom&#225;ticamente document.getElementById('scriptCategory').value = currentFilter; document.getElementById('bulkCategory').value = currentFilter; } else { // Si est&#225; en "Todos los guiones", dejar el t&#237;tulo vac&#237;o
document.getElementById('scriptTitle').value = ''; // Establecer el select en el estado "sin categor&#237;a" document.getElementById('scriptCategory').value = ''; document.getElementById('bulkCategory').value = 'General'; } // Limpiar campos de carga
masiva document.getElementById('bulkScriptContent').value = ''; resetBulkFileInput(); // Activar la primera pesta&#241;a por defecto switchTab('single'); document.getElementById('addModal').classList.add('active'); } function switchTab(tabName) { // Actualizar
botones de pesta&#241;as const tabs = document.querySelectorAll('.tab-button'); tabs.forEach(tab =&#62; tab.classList.remove('active')); if (tabName === 'single') { document.getElementById('tabSingle').classList.add('active'); } else { document.getElementById('tabBulk').classList.add('active');
} // Actualizar contenido de pesta&#241;as const contents = document.querySelectorAll('.tab-content'); contents.forEach(content =&#62; content.classList.remove('active')); if (tabName === 'single') { document.getElementById('contentSingle').classList.add('active');
} else { document.getElementById('contentBulk').classList.add('active'); } } function closeModal(modalId) { document.getElementById(modalId).classList.remove('active'); } function updateCategorySelect() { const select = document.getElementById('scriptCategory');
select.innerHTML = ''; // Agregar opci&#243;n "Sin categor&#237;a" al inicio const emptyOption = document.createElement('option'); emptyOption.value = ''; emptyOption.textContent = 'Sin categor&#237;a'; emptyOption.style.color = '#a3a3a3'; select.appendChild(emptyOption);
// Agregar todas las categor&#237;as disponibles if (categories.length === 0) { const option = document.createElement('option'); option.value = 'General'; option.textContent = 'General'; select.appendChild(option); } else { categories.forEach(cat =&#62;
{ const option = document.createElement('option'); option.value = cat.name; option.textContent = cat.name; select.appendChild(option); }); } } function updateBulkCategorySelect() { const select = document.getElementById('bulkCategory'); select.innerHTML
= ''; // Agregar todas las categor&#237;as disponibles if (categories.length === 0) { const option = document.createElement('option'); option.value = 'General'; option.textContent = 'General'; select.appendChild(option); } else { categories.forEach(cat
=&#62; { const option = document.createElement('option'); option.value = cat.name; option.textContent = cat.name; select.appendChild(option); }); } } function saveScript(event) { event.preventDefault(); const title = document.getElementById('scriptTitle').value.trim();
let category = document.getElementById('scriptCategory').value.trim(); const content = document.getElementById('scriptContent').value.trim(); // Validar que el t&#237;tulo no est&#233; vac&#237;o if (!title) { alert('Por favor, ingresa un t&#237;tulo
para el gui&#243;n'); return; } // Si no hay categor&#237;a seleccionada, asignar "General" if (!category) { category = 'General'; if (!categories.some(cat =&#62; cat.name === 'General')) { categories.push({ name: 'General', path: '' }); } } // --- APLICAR
FILTROS --- // Reemplazamos el contenido original por el procesado const processedContent = processTextReplacement(content, category); // ----------------------- scripts.push({ id: Date.now(), title, category, content: processedContent, // &#60;--- CAMBIA
'content' por 'processedContent' used: false, createdAt: new Date().toISOString() }); saveData(); updateUI(); closeModal('addModal'); } function deleteCurrentScript() { if (currentViewIndex &#62;= 0 &#38;&#38; filteredScripts[currentViewIndex]) { const
script = filteredScripts[currentViewIndex]; showConfirmDialog( '&#191;Eliminar este gui&#243;n?', `Se eliminar&#225; permanentemente "${script.title}"`, () =&#62; { scripts = scripts.filter(s =&#62; s.id !== script.id); saveData(); closeModal('viewModal');
updateUI(); } ); } } function viewScript(id) { const script = scripts.find(s =&#62; s.id === id); if (script) { filteredScripts = getFilteredScripts(); currentViewIndex = filteredScripts.findIndex(s =&#62; s.id === id); // Informaci&#243;n b&#225;sica
document.getElementById('viewTitle').textContent = script.title; document.getElementById('viewCategory').textContent = script.category; document.getElementById('viewContent').textContent = script.content; document.getElementById('viewDate').textContent
= `Creado: ${formatDate(script.createdAt)}`; // NUEVO: Calcular escenas y duraci&#243;n const scenes = calculateScenes(script.content, script.category); const duration = calculateDuration(scenes, script.category); const totalSeconds = duration; document.getElementById('viewScenes').textContent
= scenes; document.getElementById('viewCharCount').textContent = script.content.length; document.getElementById('viewDuration').textContent = formatDuration(duration); document.getElementById('viewSecondsTotal').textContent = totalSeconds; // Mostrar
ruta de la categor&#237;a (Clips) const category = categories.find(cat =&#62; cat.name === script.category); const pathContainer = document.getElementById('categoryPathContainer'); const pathText = document.getElementById('categoryPath'); const btnCopyPath
= pathContainer.querySelector('.btn-copy-path'); if (category &#38;&#38; category.path) { pathText.textContent = category.path; // CORRECCI&#211;N: Guardar la ruta completa en el atributo del texto pathText.setAttribute('data-full-path', category.path);
// El bot&#243;n ya tiene data-shortcut en el HTML, no necesita modificaci&#243;n aqu&#237; pathContainer.style.display = 'flex'; } else { pathContainer.style.display = 'none'; } // Mostrar ruta de exportaci&#243;n del video const exportPathContainer
= document.getElementById('categoryExportPathContainer'); const exportPathText = document.getElementById('categoryExportPath'); const btnCopyExportPath = exportPathContainer.querySelector('.btn-copy-export-path'); if (category &#38;&#38; category.exportPath)
{ exportPathText.textContent = category.exportPath; exportPathText.setAttribute('data-full-path', category.exportPath); exportPathContainer.style.display = 'flex'; } else { exportPathContainer.style.display = 'none'; } // NUEVO: Mostrar prompt resuelto
(solo bot&#243;n con tooltip) const promptContainer = document.getElementById('promptContainer'); const promptText = document.getElementById('promptText'); const promptButton = promptContainer.querySelector('.btn-copy-prompt-clean'); if (category &#38;&#38;
category.promptTemplate) { const resolvedPrompt = resolvePromptTemplate(category.promptTemplate, scenes); promptText.textContent = resolvedPrompt; // Establecer el tooltip con el prompt resuelto if (promptButton) { promptButton.setAttribute('data-tooltip',
resolvedPrompt); } promptContainer.style.display = 'block'; } else { promptContainer.style.display = 'none'; } updateMarkUsedButton(script.used); document.getElementById('viewModal').classList.add('active'); } } // ============================================
// FUNCIONES DE COPIA CORREGIDAS // ============================================ // &#10024; NUEVO: Funci&#243;n auxiliar para generar ID &#250;nico basado en tiempo function generateTimeBasedID() { const now = new Date(); const YYYY = now.getFullYear();
const MM = String(now.getMonth() + 1).padStart(2, '0'); const DD = String(now.getDate()).padStart(2, '0'); const HH = String(now.getHours()).padStart(2, '0'); const mm = String(now.getMinutes()).padStart(2, '0'); const ss = String(now.getSeconds()).padStart(2,
'0'); const ms = String(now.getMilliseconds()).padStart(3, '0'); // Formato: 20231128_153022_123 return `${YYYY}${MM}${DD}_${HH}${mm}${ss}_${ms}`; } function copyScriptTitle() { const titleElement = document.getElementById('viewTitle'); if (!titleElement)
{ console.error('&#10060; No se encontr&#243; el elemento viewTitle'); alert('No se encontr&#243; el t&#237;tulo del guion'); return; } // Obtener el t&#237;tulo visual actual const originalTitle = titleElement.textContent.trim(); if (!originalTitle ||
originalTitle.length === 0) { alert('El t&#237;tulo est&#225; vac&#237;o'); return; } // --- L&#211;GICA INTELIGENTE DE DETECCI&#211;N DE T&#205;TULO --- let textToCopy = originalTitle; let isGeneratedID = false; // Obtenemos el script actual desde la
memoria para comparar con su categor&#237;a if (currentViewIndex &#62;= 0 &#38;&#38; filteredScripts[currentViewIndex]) { const currentScript = filteredScripts[currentViewIndex]; const categoryName = currentScript.category || 'General'; // DEFINICI&#211;N
DE "POR DEFECTO": // 1. Si el t&#237;tulo es id&#233;ntico a la categor&#237;a (ej: "Youtube" en categor&#237;a "Youtube") // 2. Si el t&#237;tulo sigue el patr&#243;n de carga masiva (ej: "Youtube 1", "Youtube 25") // 3. Si el t&#237;tulo es "Nuevo Gui&#243;n"
(t&#237;tulo default del sistema) const isExactMatch = originalTitle === categoryName; const isBulkPattern = new RegExp(`^${categoryName}\\s\\d+$`).test(originalTitle); const isSystemDefault = originalTitle === "Nuevo Gui&#243;n"; if (isExactMatch ||
isBulkPattern || isSystemDefault) { textToCopy = generateTimeBasedID(); isGeneratedID = true; console.log('&#9889; T&#237;tulo gen&#233;rico detectado. Generando ID &#250;nico:', textToCopy); } else { console.log(' T&#237;tulo personalizado detectado.
Manteniendo:', textToCopy); } } // Copiar al portapapeles navigator.clipboard.writeText(textToCopy).then(() =&#62; { // Feedback Visual Avanzado const btn = document.querySelector('.sidebar-action-btn[onclick*="copyScriptTitle"]'); if (btn) { const btnTitle
= btn.querySelector('.action-btn-title'); const btnSubtitle = btn.querySelector('.action-btn-subtitle'); if (btnTitle) { const originalText = btnTitle.textContent; const originalSub = btnSubtitle ? btnSubtitle.textContent : ''; // EST&#201;TICA: Si es
ID generado usamos P&#250;rpura (Tech), si es Normal usamos Verde (Success) if (isGeneratedID) { btnTitle.textContent = '&#10003; ID Generado'; if(btnSubtitle) btnSubtitle.textContent = textToCopy; // Muestra el ID brevemente // Gradiente P&#250;rpura
Est&#233;tico btn.style.background = 'linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%)'; btn.style.borderColor = '#7c3aed'; btn.style.color = 'white'; // Icono blanco const icon = btn.querySelector('.action-btn-icon'); if(icon) icon.style.background
= 'rgba(255,255,255,0.2)'; } else { btnTitle.textContent = '&#10003; T&#237;tulo Copiado'; // Gradiente Verde Est&#233;tico btn.style.background = 'linear-gradient(135deg, #22c55e 0%, #16a34a 100%)'; btn.style.borderColor = '#16a34a'; btn.style.color
= 'white'; } // Restaurar estado original despu&#233;s de 2 segundos setTimeout(() =&#62; { btnTitle.textContent = originalText; if(btnSubtitle) btnSubtitle.textContent = originalSub; btn.style.background = ''; btn.style.borderColor = ''; btn.style.color
= ''; const icon = btn.querySelector('.action-btn-icon'); if(icon) icon.style.background = ''; // Restaurar gradiente original del icono }, 2000); } } else { // Feedback para atajos de teclado showToast(isGeneratedID ? `&#10003; ID Generado: ${textToCopy}`
: '&#10003; T&#237;tulo copiado al portapapeles'); } }).catch(err =&#62; { console.error('&#10060; Error al copiar:', err); alert('No se pudo copiar el t&#237;tulo'); }); } function copyPrompt() { const promptText = document.getElementById('promptText').textContent;
if (!promptText || promptText.trim().length === 0) { console.error('&#10060; No hay texto de prompt disponible'); alert('No hay prompt disponible para copiar'); return; } // REGLA GLOBAL: Obtener el guion actual const guionContent = document.getElementById('viewContent').textContent;
// Construir el texto con el sufijo const finalText = `${promptText} &#8212; Basar todas las generaciones y resultados en el siguiente guion: '${guionContent}'`; console.log(' Copiando prompt con regla global'); navigator.clipboard.writeText(finalText).then(()
=&#62; { console.log('&#9989; Prompt copiado exitosamente'); // Buscar el bot&#243;n para feedback visual const btn = document.querySelector('.sidebar-action-btn.prompt-btn[onclick*="copyPrompt"]'); if (btn) { const btnTitle = btn.querySelector('.action-btn-title');
if (btnTitle) { const originalText = btnTitle.textContent; btnTitle.textContent = '&#10003; &#161;Copiado!'; btn.style.background = 'linear-gradient(135deg, #22c55e 0%, #16a34a 100%)'; btn.style.borderColor = '#16a34a'; setTimeout(() =&#62; { btnTitle.textContent
= originalText; btn.style.background = ''; btn.style.borderColor = ''; // NUEVO: Abrir autom&#225;ticamente el generador de prompts openPromptsGenerator(); }, 500); } } else { // Feedback alternativo y abrir generador showToast('&#10003; Prompt copiado
al portapapeles'); setTimeout(() =&#62; { openPromptsGenerator(); }, 500); } }).catch(err =&#62; { console.error('&#10060; Error al copiar:', err); alert('No se pudo copiar el prompt'); }); } function copyCategoryPath() { const pathElement = document.getElementById('categoryPath');
if (!pathElement) { console.error('&#10060; No se encontr&#243; el elemento categoryPath'); alert('No se encontr&#243; la ruta de clips'); return; } const pathText = pathElement.textContent.trim(); if (!pathText || pathText.length === 0) { alert('No hay
ruta de clips disponible para copiar'); return; } console.log(' Copiando ruta de clips:', pathText); navigator.clipboard.writeText(pathText).then(() =&#62; { console.log('&#9989; Ruta copiada exitosamente'); // Buscar el bot&#243;n para feedback visual
const btn = document.querySelector('.sidebar-action-btn.path-btn[onclick*="copyCategoryPath"]'); if (btn) { const btnTitle = btn.querySelector('.action-btn-title'); if (btnTitle) { const originalText = btnTitle.textContent; btnTitle.textContent = '&#10003;
&#161;Copiado!'; btn.style.background = 'linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)'; btn.style.borderColor = '#2563eb'; btn.style.color = 'white'; setTimeout(() =&#62; { btnTitle.textContent = originalText; btn.style.background = ''; btn.style.borderColor
= ''; btn.style.color = ''; }, 2000); } } else { // Feedback alternativo para atajos de teclado showToast('&#10003; Ruta de clips copiada al portapapeles'); } }).catch(err =&#62; { console.error('&#10060; Error al copiar:', err); alert('No se pudo copiar
la ruta'); }); } // ============================================ // &#10024; NUEVA FUNCI&#211;N A&#209;ADIDA // ============================================ function copyCategoryExportPath() { const pathElement = document.getElementById('categoryExportPath');
if (!pathElement) { console.error('&#10060; No se encontr&#243; el elemento categoryExportPath'); alert('No se encontr&#243; la ruta de exportaci&#243;n'); return; } const pathText = pathElement.textContent.trim(); if (!pathText || pathText.length ===
0) { alert('No hay ruta de exportaci&#243;n disponible para copiar'); return; } console.log(' Copiando ruta de exportaci&#243;n:', pathText); navigator.clipboard.writeText(pathText).then(() =&#62; { console.log('&#9989; Ruta de exportaci&#243;n copiada
exitosamente'); const btn = document.querySelector('.sidebar-action-btn.export-btn[onclick*="copyCategoryExportPath"]'); if (btn) { const btnTitle = btn.querySelector('.action-btn-title'); if (btnTitle) { const originalText = btnTitle.textContent; btnTitle.textContent
= '&#10003; &#161;Copiado!'; btn.style.background = 'linear-gradient(135deg, #22c55e 0%, #16a34a 100%)'; btn.style.borderColor = '#16a34a'; btn.style.color = 'white'; setTimeout(() =&#62; { btnTitle.textContent = originalText; btn.style.background = '';
btn.style.borderColor = ''; btn.style.color = ''; }, 2000); } } else { showToast('&#10003; Ruta de exportaci&#243;n copiada al portapapeles'); } }).catch(err =&#62; { console.error('&#10060; Error al copiar:', err); alert('No se pudo copiar la ruta de
exportaci&#243;n'); }); } // NUEVA FUNCI&#211;N: Toast para feedback visual en atajos de teclado function showToast(message) { // Crear el elemento toast si no existe let toast = document.getElementById('keyboardToast'); if (!toast) { toast = document.createElement('div');
toast.id = 'keyboardToast'; toast.style.cssText = ` position: fixed; top: 20px; right: 20px; background: #1a1a1a; color: white; padding: 12px 20px; border-radius: 8px; font-size: 14px; font-weight: 600; z-index: 10000; opacity: 0; transform: translateY(-20px);
transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); `; document.body.appendChild(toast); } toast.textContent = message; // Mostrar setTimeout(() =&#62; { toast.style.opacity = '1'; toast.style.transform = 'translateY(0)'; }, 10); //
Ocultar despu&#233;s de 2 segundos setTimeout(() =&#62; { toast.style.opacity = '0'; toast.style.transform = 'translateY(-20px)'; }, 2000); } // Funci&#243;n auxiliar para copiar con m&#233;todo alternativo function fallbackCopyToClipboard(text, btn,
btnText) { try { const textArea = document.createElement('textarea'); textArea.value = text; textArea.style.position = 'fixed'; textArea.style.left = '-9999px'; textArea.style.top = '-9999px'; document.body.appendChild(textArea); textArea.focus(); textArea.select();
const successful = document.execCommand('copy'); document.body.removeChild(textArea); if (successful) { console.log('&#10003; Copiado exitosamente (m&#233;todo alternativo):', text); if (btn &#38;&#38; btnText) { btn.classList.add('copied'); btnText.textContent
= '&#161;Copiado!'; setTimeout(() =&#62; { btn.classList.remove('copied'); btnText.textContent = 'Copiar'; }, 2000); } } else { throw new Error('execCommand fall&#243;'); } } catch (err) { console.error('Error en m&#233;todo alternativo:', err); alert('No
se pudo copiar la ruta de exportaci&#243;n.\n\nRuta: ' + text + '\n\nPor favor, copia manualmente esta ruta.'); } } function toggleUsedStatus() { if (currentViewIndex &#62;= 0 &#38;&#38; filteredScripts[currentViewIndex]) { const script = filteredScripts[currentViewIndex];
const originalScript = scripts.find(s =&#62; s.id === script.id); if (!originalScript.used) { // Marcar como utilizado originalScript.used = true; script.used = true; saveData(); updateStats(); // Obtener la lista actualizada ANTES de renderizar const
availableScripts = getFilteredScripts(); // Si hay m&#225;s guiones disponibles, cargar el siguiente if (availableScripts.length &#62; 0) { // Ajustar el &#237;ndice si es necesario if (currentViewIndex &#62;= availableScripts.length) { currentViewIndex
= 0; } // Cargar el siguiente guion disponible const nextScript = availableScripts[currentViewIndex]; loadScriptInModal(nextScript); // Actualizar la lista visual en segundo plano renderScripts(); } else { // No hay m&#225;s guiones disponibles closeModal('viewModal');
renderScripts(); // Mostrar mensaje de felicitaci&#243;n setTimeout(() =&#62; { alert(' &#161;Excelente trabajo! Has completado todos los guiones disponibles en esta categor&#237;a.'); }, 300); } } else { // Desmarcar como utilizado (volver a disponible)
originalScript.used = false; script.used = false; saveData(); updateMarkUsedButton(script.used); renderScripts(); updateStats(); } } } // Funci&#243;n auxiliar para cargar un guion en el modal sin cerrar/abrir function loadScriptInModal(script) { // Actualizar
contenido del modal document.getElementById('viewTitle').textContent = script.title; document.getElementById('viewCategory').textContent = script.category; document.getElementById('viewContent').textContent = script.content; document.getElementById('viewDate').textContent
= `Creado: ${formatDate(script.createdAt)}`; // Actualizar c&#225;lculos const scenes = calculateScenes(script.content, script.category); const duration = calculateDuration(scenes, script.category); document.getElementById('viewScenes').textContent =
scenes; document.getElementById('viewCharCount').textContent = script.content.length; document.getElementById('viewDuration').textContent = formatDuration(duration); document.getElementById('viewSecondsTotal').textContent = duration; // Actualizar ruta
de clips const category = categories.find(cat =&#62; cat.name === script.category); const pathContainer = document.getElementById('categoryPathContainer'); const pathText = document.getElementById('categoryPath'); const btnCopyPath = pathContainer.querySelector('.btn-copy-path');
if (category &#38;&#38; category.path) { pathText.textContent = category.path; pathText.setAttribute('data-full-path', category.path); pathContainer.style.display = 'flex'; } else { pathContainer.style.display = 'none'; } // Actualizar ruta de exportaci&#243;n
const exportPathContainer = document.getElementById('categoryExportPathContainer'); const exportPathText = document.getElementById('categoryExportPath'); const btnCopyExportPath = exportPathContainer.querySelector('.btn-copy-export-path'); if (category
&#38;&#38; category.exportPath) { exportPathText.textContent = category.exportPath; exportPathText.setAttribute('data-full-path', category.exportPath); exportPathContainer.style.display = 'flex'; } else { exportPathContainer.style.display = 'none'; }
// Actualizar prompt (solo bot&#243;n con tooltip) const promptContainer = document.getElementById('promptContainer'); const promptText = document.getElementById('promptText'); const promptButton = promptContainer.querySelector('.btn-copy-prompt-clean');
if (category &#38;&#38; category.promptTemplate) { const resolvedPrompt = resolvePromptTemplate(category.promptTemplate, scenes); promptText.textContent = resolvedPrompt; // Establecer el tooltip con el prompt resuelto if (promptButton) { promptButton.setAttribute('data-tooltip',
resolvedPrompt); } promptContainer.style.display = 'block'; } else { promptContainer.style.display = 'none'; } // Actualizar bot&#243;n de marcar como utilizado updateMarkUsedButton(script.used); // Actualizar filteredScripts para navegaci&#243;n filteredScripts
= getFilteredScripts(); currentViewIndex = filteredScripts.findIndex(s =&#62; s.id === script.id); } function updateMarkUsedButton(isUsed) { const btn = document.getElementById('btnMarkUsed'); const text = document.getElementById('markUsedText'); if (isUsed)
{ btn.classList.add('marked'); text.textContent = 'Marcar como disponible'; } else { btn.classList.remove('marked'); text.textContent = 'Marcar como utilizado'; } } function copyCurrentScript() { const content = document.getElementById('viewContent').textContent;
navigator.clipboard.writeText(content).then(() =&#62; { const btn = event.target.closest('.btn-copy-script'); const originalText = btn.innerHTML; btn.innerHTML = ` &#60;svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62;
&#60;polyline points="20 6 9 17 4 12"&#62;&#60;/polyline&#62; &#60;/svg&#62; Copiado `; setTimeout(() =&#62; { btn.innerHTML = originalText; }, 2000); }); } function nextScript() { if (filteredScripts.length === 0) return; currentViewIndex = (currentViewIndex
+ 1) % filteredScripts.length; const script = filteredScripts[currentViewIndex]; document.getElementById('viewTitle').textContent = script.title; document.getElementById('viewCategory').textContent = script.category; document.getElementById('viewContent').textContent
= script.content; document.getElementById('viewDate').textContent = `Creado: ${formatDate(script.createdAt)}`; // Actualizar c&#225;lculos const scenes = calculateScenes(script.content); const duration = calculateDuration(scenes); document.getElementById('viewScenes').textContent
= scenes; document.getElementById('viewCharCount').textContent = script.content.length; document.getElementById('viewDuration').textContent = formatDuration(duration); document.getElementById('viewSecondsTotal').textContent = duration; // Actualizar ruta
de clips const category = categories.find(cat =&#62; cat.name === script.category); const pathContainer = document.getElementById('categoryPathContainer'); const pathText = document.getElementById('categoryPath'); const btnCopyPath = pathContainer.querySelector('.btn-copy-path');
if (category &#38;&#38; category.path) { pathText.textContent = category.path; if (btnCopyPath) { btnCopyPath.setAttribute('data-tooltip', category.path); } pathContainer.style.display = 'flex'; } else { pathContainer.style.display = 'none'; } // Actualizar
ruta de exportaci&#243;n const exportPathContainer = document.getElementById('categoryExportPathContainer'); const exportPathText = document.getElementById('categoryExportPath'); const btnCopyExportPath = exportPathContainer.querySelector('.btn-copy-export-path');
if (category &#38;&#38; category.exportPath) { exportPathText.textContent = category.exportPath; exportPathText.setAttribute('data-full-path', category.exportPath); exportPathContainer.style.display = 'flex'; } else { exportPathContainer.style.display
= 'none'; } // Actualizar prompt (solo bot&#243;n con tooltip) const promptContainer = document.getElementById('promptContainer'); const promptText = document.getElementById('promptText'); const promptButton = promptContainer.querySelector('.btn-copy-prompt-clean');
if (category &#38;&#38; category.promptTemplate) { const resolvedPrompt = resolvePromptTemplate(category.promptTemplate, scenes); promptText.textContent = resolvedPrompt; // Establecer el tooltip con el prompt resuelto if (promptButton) { promptButton.setAttribute('data-tooltip',
resolvedPrompt); } promptContainer.style.display = 'block'; } else { promptContainer.style.display = 'none'; } updateMarkUsedButton(script.used); } function prevScript() { if (filteredScripts.length === 0) return; currentViewIndex = (currentViewIndex
- 1 + filteredScripts.length) % filteredScripts.length; const script = filteredScripts[currentViewIndex]; document.getElementById('viewTitle').textContent = script.title; document.getElementById('viewCategory').textContent = script.category; document.getElementById('viewContent').textContent
= script.content; document.getElementById('viewDate').textContent = `Creado: ${formatDate(script.createdAt)}`; // Actualizar c&#225;lculos const scenes = calculateScenes(script.content); const duration = calculateDuration(scenes); document.getElementById('viewScenes').textContent
= scenes; document.getElementById('viewCharCount').textContent = script.content.length; document.getElementById('viewDuration').textContent = formatDuration(duration); document.getElementById('viewSecondsTotal').textContent = duration; // Actualizar ruta
de clips const category = categories.find(cat =&#62; cat.name === script.category); const pathContainer = document.getElementById('categoryPathContainer'); const pathText = document.getElementById('categoryPath'); const btnCopyPath = pathContainer.querySelector('.btn-copy-path');
if (category &#38;&#38; category.path) { pathText.textContent = category.path; if (btnCopyPath) { btnCopyPath.setAttribute('data-tooltip', category.path); } pathContainer.style.display = 'flex'; } else { pathContainer.style.display = 'none'; } // Actualizar
ruta de exportaci&#243;n const exportPathContainer = document.getElementById('categoryExportPathContainer'); const exportPathText = document.getElementById('categoryExportPath'); const btnCopyExportPath = exportPathContainer.querySelector('.btn-copy-export-path');
if (category &#38;&#38; category.exportPath) { exportPathText.textContent = category.exportPath; exportPathText.setAttribute('data-full-path', category.exportPath); exportPathContainer.style.display = 'flex'; } else { exportPathContainer.style.display
= 'none'; } // Actualizar prompt (solo bot&#243;n con tooltip) const promptContainer = document.getElementById('promptContainer'); const promptText = document.getElementById('promptText'); const promptButton = promptContainer.querySelector('.btn-copy-prompt-clean');
if (category &#38;&#38; category.promptTemplate) { const resolvedPrompt = resolvePromptTemplate(category.promptTemplate, scenes); promptText.textContent = resolvedPrompt; // Establecer el tooltip con el prompt resuelto if (promptButton) { promptButton.setAttribute('data-tooltip',
resolvedPrompt); } promptContainer.style.display = 'block'; } else { promptContainer.style.display = 'none'; } updateMarkUsedButton(script.used); } function handleSearch() { searchQuery = document.getElementById('searchInput').value.toLowerCase().trim();
renderScripts(); } function toggleFiltersPanel() { filtersActive = !filtersActive; const panel = document.getElementById('filtersPanel'); const btn = document.getElementById('toggleFiltersBtn'); panel.classList.toggle('active'); btn.classList.toggle('active');
} function setStatusFilter(status) { statusFilter = status; document.querySelectorAll('[data-status]').forEach(btn =&#62; { btn.classList.remove('active'); }); document.querySelector(`[data-status="${status}"]`).classList.add('active'); updateActiveFiltersCount();
renderScripts(); } function setSortFilter(sort) { sortFilter = sort; document.querySelectorAll('[data-sort]').forEach(btn =&#62; { btn.classList.remove('active'); }); document.querySelector(`[data-sort="${sort}"]`).classList.add('active'); updateActiveFiltersCount();
renderScripts(); } function updateActiveFiltersCount() { const count = (statusFilter !== 'available' ? 1 : 0) + (sortFilter !== 'recent' ? 1 : 0); const badge = document.getElementById('activeFiltersCount'); if (count &#62; 0) { badge.textContent = count;
badge.style.display = 'inline-flex'; } else { badge.style.display = 'none'; } } function getFilteredScripts() { let filtered = currentFilter === 'all' ? scripts : scripts.filter(s =&#62; s.category === currentFilter); if (statusFilter === 'available')
{ filtered = filtered.filter(s =&#62; !s.used); } else if (statusFilter === 'used') { filtered = filtered.filter(s =&#62; s.used); } if (searchQuery) { filtered = filtered.filter(s =&#62; s.title.toLowerCase().includes(searchQuery) || s.content.toLowerCase().includes(searchQuery)
); } filtered = [...filtered]; switch(sortFilter) { case 'recent': filtered.sort((a, b) =&#62; new Date(b.createdAt) - new Date(a.createdAt)); break; case 'oldest': filtered.sort((a, b) =&#62; new Date(a.createdAt) - new Date(b.createdAt)); break; case
'alpha': filtered.sort((a, b) =&#62; a.title.localeCompare(b.title, 'es')); break; case 'alpha-desc': filtered.sort((a, b) =&#62; b.title.localeCompare(a.title, 'es')); break; } return filtered; } function formatDate(dateString) { const date = new Date(dateString);
const day = date.getDate(); const months = ['ene', 'feb', 'mar', 'abr', 'may', 'jun', 'jul', 'ago', 'sep', 'oct', 'nov', 'dic']; const month = months[date.getMonth()]; const year = date.getFullYear(); const hours = date.getHours(); const minutes = date.getMinutes().toString().padStart(2,
'0'); return `${day} de ${month} de ${year}, ${hours}:${minutes}`; } function renderCategories() { const categoryList = document.getElementById('categoryList'); const allCategory = categoryList.querySelector('.category-item'); const searchInput = document.getElementById('categorySearchInput');
const currentSearchTerm = searchInput ? searchInput.value.toLowerCase().trim() : ''; categoryList.innerHTML = ''; categoryList.appendChild(allCategory); categories.forEach(cat =&#62; { const count = scripts.filter(s =&#62; s.category === cat.name).length;
const div = document.createElement('div'); div.className = 'category-item'; div.innerHTML = ` &#60;div class="category-item-content" onclick="filterCategory('${cat.name.replace(/'/g, "\\'")}')"&#62; &#60;span&#62;&#60;span class="category-icon"&#62;&#60;/span&#62;${cat.name}&#60;/span&#62;
&#60;/div&#62; &#60;div class="category-actions"&#62; &#60;button class="category-action-btn" onclick="event.stopPropagation(); openEditCategoryModal('${cat.name.replace(/'/g, "\\'")}')"&#62; &#60;svg width="14" height="14" viewBox="0 0 24 24" fill="none"
stroke="currentColor" stroke-width="2"&#62; &#60;path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"&#62;&#60;/path&#62; &#60;path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;/button&#62;
&#60;button class="category-action-btn delete" onclick="event.stopPropagation(); deleteCategory('${cat.name.replace(/'/g, "\\'")}')"&#62; &#60;svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;polyline
points="3 6 5 6 21 6"&#62;&#60;/polyline&#62; &#60;path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;/button&#62; &#60;/div&#62; &#60;span class="category-badge"&#62;${count}&#60;/span&#62;
`; categoryList.appendChild(div); }); // Reaplicar filtro de b&#250;squeda si existe if (currentSearchTerm) { filterCategoriesDisplay(currentSearchTerm); } } function renderScripts() { const grid = document.getElementById('scriptsGrid'); const filtered
= getFilteredScripts(); document.getElementById('scriptsCount').textContent = filtered.length; if (scripts.length === 0) { grid.innerHTML = ` &#60;div class="empty-state"&#62; &#60;h3&#62;No hay guiones todav&#237;a&#60;/h3&#62; &#60;p&#62;Comienza agregando
tu primer gui&#243;n&#60;/p&#62; &#60;/div&#62; `; return; } if (filtered.length === 0) { const hasUsedScripts = scripts.some(s =&#62; s.used); const isSearching = searchQuery.length &#62; 0; if (isSearching) { grid.innerHTML = ` &#60;div class="empty-state"&#62;
&#60;h3&#62;No se encontraron resultados&#60;/h3&#62; &#60;p&#62;Intenta con otros t&#233;rminos de b&#250;squeda&#60;/p&#62; &#60;/div&#62; `; } else if (hasUsedScripts) { grid.innerHTML = ` &#60;div class="empty-state"&#62; &#60;h3&#62; &#161;Excelente
trabajo!&#60;/h3&#62; &#60;p&#62;Has utilizado todos los guiones disponibles en esta categor&#237;a&#60;/p&#62; &#60;/div&#62; `; } else { grid.innerHTML = ` &#60;div class="empty-state"&#62; &#60;h3&#62;No hay guiones en esta categor&#237;a&#60;/h3&#62;
&#60;p&#62;Agrega nuevos guiones para comenzar&#60;/p&#62; &#60;/div&#62; `; } return; } grid.innerHTML = filtered.map(script =&#62; ` &#60;div class="script-card ${script.used ? 'used' : ''} ${selectionMode ? 'selection-mode' : ''} ${selectedScripts.has(script.id)
? 'selected' : ''}" onclick="${selectionMode ? `toggleScriptSelection(${script.id})` : `viewScript(${script.id})`}"&#62; &#60;div class="script-checkbox"&#62; &#60;svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62;
&#60;polyline points="20 6 9 17 4 12"&#62;&#60;/polyline&#62; &#60;/svg&#62; &#60;/div&#62; &#60;div class="script-header"&#62; &#60;div style="flex: 1;"&#62; &#60;div class="script-title"&#62;${script.title}&#60;/div&#62; &#60;/div&#62; &#60;div class="script-status-indicator"&#62;&#60;/div&#62;
&#60;/div&#62; &#60;div class="script-meta"&#62; &#60;svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;rect x="3" y="4" width="18" height="18" rx="2" ry="2"&#62;&#60;/rect&#62; &#60;line x1="16"
y1="2" x2="16" y2="6"&#62;&#60;/line&#62; &#60;line x1="8" y1="2" x2="8" y2="6"&#62;&#60;/line&#62; &#60;line x1="3" y1="10" x2="21" y2="10"&#62;&#60;/line&#62; &#60;/svg&#62; ${new Date(script.createdAt).toLocaleDateString('es-ES', { day: 'numeric',
month: 'short', year: 'numeric' })} &#60;span class="script-category-badge"&#62;${script.used ? 'Utilizado' : 'Disponible'}&#60;/span&#62; &#60;/div&#62; &#60;div class="script-content"&#62;${script.content}&#60;/div&#62; &#60;/div&#62; `).join(''); //
Actualizar estado de botones de acci&#243;n r&#225;pida updateQuickActionButtons(); } function updateStats() { const total = scripts.length; const used = scripts.filter(s =&#62; s.used).length; const available = total - used; document.getElementById('totalScripts').textContent
= total; document.getElementById('availableScripts').textContent = available; document.getElementById('usedScripts').textContent = used; document.getElementById('count-all').textContent = total; } function updateUI() { renderCategories(); renderScripts();
updateStats(); } // Funciones de Acci&#243;n R&#225;pida function quickCopyPath() { const btn = document.getElementById('btnQuickCopyPath'); const btnText = document.getElementById('quickCopyPathText'); // Obtener la categor&#237;a actual let currentCategory
= null; if (currentFilter !== 'all') { currentCategory = categories.find(cat =&#62; cat.name === currentFilter); } // Verificar si hay ruta disponible if (!currentCategory || !currentCategory.path) { alert('Esta categor&#237;a no tiene una ruta de clips
configurada'); return; } // Copiar la ruta navigator.clipboard.writeText(currentCategory.path).then(() =&#62; { btn.classList.add('copied'); btnText.textContent = '&#161;Copiado!'; setTimeout(() =&#62; { btn.classList.remove('copied'); btnText.textContent
= 'Copiar Ruta'; }, 2000); // Abrir el primer gui&#243;n disponible openFirstAvailableScript(); }).catch(err =&#62; { console.error('Error al copiar:', err); alert('No se pudo copiar la ruta'); }); } function quickCopyScript() { const btn = document.getElementById('btnQuickCopyScript');
const btnText = document.getElementById('quickCopyScriptText'); // Obtener el primer gui&#243;n filtrado const filtered = getFilteredScripts(); if (filtered.length === 0) { alert('No hay guiones disponibles para copiar'); return; } const firstScript =
filtered[0]; // Copiar el contenido del gui&#243;n navigator.clipboard.writeText(firstScript.content).then(() =&#62; { btn.classList.add('copied'); btnText.textContent = '&#161;Copiado!'; setTimeout(() =&#62; { btn.classList.remove('copied'); btnText.textContent
= 'Copiar Gui&#243;n'; }, 2000); // Abrir el gui&#243;n viewScript(firstScript.id); }).catch(err =&#62; { console.error('Error al copiar:', err); alert('No se pudo copiar el gui&#243;n'); }); } function openFirstAvailableScript() { const filtered = getFilteredScripts();
if (filtered.length === 0) { alert('No hay guiones disponibles en esta categor&#237;a'); return; } // Abrir el primer gui&#243;n viewScript(filtered[0].id); } function updateQuickActionButtons() { const btnPath = document.getElementById('btnQuickCopyPath');
const btnScript = document.getElementById('btnQuickCopyScript'); const filtered = getFilteredScripts(); const hasScripts = filtered.length &#62; 0; // Verificar si hay ruta de clips let hasPath = false; if (currentFilter !== 'all') { const currentCategory
= categories.find(cat =&#62; cat.name === currentFilter); hasPath = currentCategory &#38;&#38; currentCategory.path; } // Habilitar/deshabilitar botones btnPath.disabled = !hasPath || !hasScripts; btnScript.disabled = !hasScripts; } // Event Listeners
document.getElementById('searchInput').addEventListener('input', handleSearch); document.getElementById('newCategoryInput').addEventListener('keypress', (e) =&#62; { if (e.key === 'Enter') { e.preventDefault(); document.getElementById('newCategoryPath').focus();
} }); document.getElementById('newCategoryPath').addEventListener('keypress', (e) =&#62; { if (e.key === 'Enter') { addCategory(); } }); // ============================================ // SISTEMA CONSOLIDADO DE ATAJOS DE TECLADO - CORREGIDO // ============================================
document.addEventListener('keydown', (e) =&#62; { // ============================================ // PRIORIDAD 1: ESC - CIERRE DE MODALES (SIEMPRE FUNCIONA) // ============================================ if (e.key === 'Escape') { e.preventDefault();
// Prioridad 1: Modal de confirmaci&#243;n const confirmDialog = document.getElementById('confirmDialog'); if (confirmDialog &#38;&#38; confirmDialog.classList.contains('active')) { closeConfirmDialog(); return; } // Prioridad 2: Modal de prompts const
promptsModal = document.getElementById('promptsGeneratorModal'); if (promptsModal &#38;&#38; promptsModal.classList.contains('active')) { closePromptsGenerator(); return; } // Prioridad 3: Sidebar m&#243;vil const sidebar = document.getElementById('mainSidebar');
const overlay = document.getElementById('sidebarOverlay'); if (sidebar &#38;&#38; sidebar.classList.contains('active')) { sidebar.classList.remove('active'); overlay.classList.remove('active'); document.body.style.overflow = ''; return; } return; } //
============================================ // PRIORIDAD 2: COMANDOS CTRL+SHIFT (FUNCIONAN SIEMPRE) // ============================================ // Detectar si es un comando Ctrl+Shift const isCtrlShift = e.ctrlKey &#38;&#38; e.shiftKey; // Si NO
es Ctrl+Shift, verificar si hay campo de entrada activo if (!isCtrlShift) { const isActiveInputField = (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') &#38;&#38; document.activeElement === e.target; // Si hay campo activo y NO es Ctrl+Shift,
bloquear atajos normales if (isActiveInputField) { return; } } // ============================================ // CTRL+SHIFT+F: Copiar t&#237;tulo del guion // ============================================ if (e.ctrlKey &#38;&#38; e.shiftKey &#38;&#38;
(e.key === 'F' || e.key === 'f')) { e.preventDefault(); e.stopPropagation(); console.log(' Atajo Ctrl+Shift+F detectado'); const viewModal = document.getElementById('viewModal'); if (viewModal &#38;&#38; viewModal.classList.contains('active')) { console.log('&#9989;
Modal activo, ejecutando copyScriptTitle()'); copyScriptTitle(); } else { console.log('&#10060; Modal NO est&#225; activo'); console.log('Estado del modal:', viewModal ? 'existe pero no activo' : 'no existe'); alert('&#9888; Necesitas abrir un guion
primero para copiar su t&#237;tulo\n\nPresiona cualquier tarjeta de guion para abrirlo.'); } return; } // ============================================ // CTRL+SHIFT+G: Copiar prompt de IA // ============================================ if (e.ctrlKey &#38;&#38;
e.shiftKey &#38;&#38; (e.key === 'G' || e.key === 'g')) { e.preventDefault(); e.stopPropagation(); console.log(' Atajo Ctrl+Shift+G detectado'); const viewModal = document.getElementById('viewModal'); const promptContainer = document.getElementById('promptContainer');
console.log('Verificando modal:', viewModal ? 'existe' : 'NO existe'); console.log('Modal activo:', viewModal?.classList.contains('active')); console.log('Prompt container:', promptContainer ? 'existe' : 'NO existe'); console.log('Prompt visible:', promptContainer?.style.display
!== 'none'); if (viewModal &#38;&#38; viewModal.classList.contains('active')) { if (promptContainer &#38;&#38; promptContainer.style.display !== 'none') { console.log('&#9989; Todo OK, ejecutando copyPrompt()'); copyPrompt(); } else { console.log('&#10060;
Prompt no disponible'); alert('&#9888; Este guion no tiene prompt de IA configurado\n\nVe a Configuraci&#243;n &#8594; Prompts para IA y configura un prompt para esta categor&#237;a.'); } } else { console.log('&#10060; Modal NO est&#225; activo'); alert('&#9888;
Necesitas abrir un guion primero\n\nPresiona cualquier tarjeta de guion para abrirlo.'); } return; } // ============================================ // CTRL+SHIFT+X: Copiar ruta de clips // ============================================ if (e.ctrlKey &#38;&#38;
e.shiftKey &#38;&#38; (e.key === 'X' || e.key === 'x')) { e.preventDefault(); e.stopPropagation(); console.log(' Atajo Ctrl+Shift+X detectado'); const viewModal = document.getElementById('viewModal'); const pathContainer = document.getElementById('categoryPathContainer');
console.log('Verificando modal:', viewModal ? 'existe' : 'NO existe'); console.log('Modal activo:', viewModal?.classList.contains('active')); console.log('Path container:', pathContainer ? 'existe' : 'NO existe'); console.log('Path visible:', pathContainer?.style.display
!== 'none'); if (viewModal &#38;&#38; viewModal.classList.contains('active')) { if (pathContainer &#38;&#38; pathContainer.style.display !== 'none') { console.log('&#9989; Todo OK, ejecutando copyCategoryPath()'); copyCategoryPath(); } else { console.log('&#10060;
Ruta de clips no disponible'); alert('&#9888; Esta categor&#237;a no tiene ruta de clips configurada\n\nPara configurarla:\n1. Haz clic en el &#237;cono de editar junto al nombre de la categor&#237;a\n2. Ingresa la ruta en "Ruta de los Clips"'); } }
else { console.log('&#10060; Modal NO est&#225; activo'); // Intentar usar bot&#243;n de acci&#243;n r&#225;pida const btn = document.getElementById('btnQuickCopyPath'); if (btn &#38;&#38; !btn.disabled) { console.log('&#9989; Usando bot&#243;n de acci&#243;n
r&#225;pida'); quickCopyPath(); } else { console.log('&#10060; Bot&#243;n de acci&#243;n r&#225;pida no disponible'); alert('&#9888; Selecciona una categor&#237;a con ruta de clips configurada\n\no abre un guion para usar este atajo.'); } } return; }
// ============================================ // CTRL+SHIFT+E: Copiar ruta de exportaci&#243;n // ============================================ if (e.ctrlKey &#38;&#38; e.shiftKey &#38;&#38; (e.key === 'E' || e.key === 'e')) { e.preventDefault(); e.stopPropagation();
console.log(' Atajo Ctrl+Shift+E detectado'); const viewModal = document.getElementById('viewModal'); const exportPathContainer = document.getElementById('categoryExportPathContainer'); if (viewModal &#38;&#38; viewModal.classList.contains('active')
&#38;&#38; exportPathContainer &#38;&#38; exportPathContainer.style.display !== 'none') { console.log('&#9989; Modal activo y ruta de exportaci&#243;n disponible, ejecutando copyCategoryExportPath()'); copyCategoryExportPath(); } else { console.log('&#10060;
Modal no est&#225; activo o no hay ruta de exportaci&#243;n'); alert('&#9888; Esta categor&#237;a no tiene ruta de exportaci&#243;n configurada'); } return; } // ============================================ // CTRL+SHIFT+S: Copiar guion completo // ============================================
if (e.ctrlKey &#38;&#38; e.shiftKey &#38;&#38; (e.key === 'S' || e.key === 's')) { e.preventDefault(); e.stopPropagation(); console.log(' Atajo Ctrl+Shift+S detectado'); const viewModal = document.getElementById('viewModal'); if (viewModal &#38;&#38;
viewModal.classList.contains('active')) { console.log('&#9989; Modal activo, ejecutando copyCurrentScript()'); copyCurrentScript(); } else { const btn = document.getElementById('btnQuickCopyScript'); if (btn &#38;&#38; !btn.disabled) { console.log('&#9989;
Usando bot&#243;n de acci&#243;n r&#225;pida'); quickCopyScript(); } else { console.log('&#10060; No hay guiones disponibles'); alert('&#9888; No hay guiones disponibles para copiar'); } } return; } // ============================================ //
NAVEGACI&#211;N EN MODAL DE PROMPTS // ============================================ const promptsModal = document.getElementById('promptsGeneratorModal'); if (promptsModal &#38;&#38; promptsModal.classList.contains('active')) { const activeState = document.getElementById('promptsActiveState');
// Enter: Siguiente prompt if (e.key === 'Enter' &#38;&#38; activeState &#38;&#38; activeState.classList.contains('active')) { e.preventDefault(); nextPrompt(); return; } // Ctrl+C: Copiar prompt actual (solo si NO hay selecci&#243;n) if (e.ctrlKey &#38;&#38;
(e.key === 'c' || e.key === 'C') &#38;&#38; activeState &#38;&#38; activeState.classList.contains('active')) { const selection = window.getSelection().toString(); if (!selection) { e.preventDefault(); copyCurrentPrompt(); return; } } } // ============================================
// NAVEGACI&#211;N CON FLECHAS (solo si modal est&#225; abierto) // ============================================ const viewModal = document.getElementById('viewModal'); if (viewModal &#38;&#38; viewModal.classList.contains('active')) { if (e.key === 'ArrowLeft')
{ e.preventDefault(); prevScript(); return; } if (e.key === 'ArrowRight') { e.preventDefault(); nextScript(); return; } } }); function handleBulkFileSelect(event) { const file = event.target.files[0]; const label = document.getElementById('fileInputLabel');
const labelText = document.getElementById('fileInputText'); if (file) { const reader = new FileReader(); reader.onload = function(e) { const content = e.target.result; document.getElementById('bulkScriptContent').value = content; // Actualizar visual
del bot&#243;n label.classList.add('has-file'); labelText.textContent = `&#10003; ${file.name}`; }; reader.onerror = function() { showBulkResult('error', 'Error al leer el archivo'); resetBulkFileInput(); }; reader.readAsText(file); } else { resetBulkFileInput();
} } function resetBulkFileInput() { const label = document.getElementById('fileInputLabel'); const labelText = document.getElementById('fileInputText'); label.classList.remove('has-file'); labelText.textContent = 'Seleccionar archivo .txt'; document.getElementById('bulkFileInput').value
= ''; } function agregarGuionesMasivos() { const bulkContent = document.getElementById('bulkScriptContent').value.trim(); const category = document.getElementById('bulkCategory').value.trim() || 'General'; const resultDiv = document.getElementById('bulkResult');
const btn = document.getElementById('btnBulkAdd'); // Validar que hay contenido if (!bulkContent) { showBulkResult('warning', 'Por favor, pega guiones o carga un archivo'); return; } // Deshabilitar bot&#243;n durante el proceso btn.disabled = true; btn.innerHTML
= '&#60;span&#62;Procesando...&#60;/span&#62;'; // Dividir por el separador --- const guionesRaw = bulkContent.split('---'); // Limpiar y filtrar guiones vac&#237;os const guiones = guionesRaw .map(g =&#62; g.trim()) .filter(g =&#62; g.length &#62; 0);
if (guiones.length === 0) { showBulkResult('warning', 'No se encontraron guiones v&#225;lidos'); resetBulkButton(); return; } // Asegurar que la categor&#237;a existe if (!categories.some(cat =&#62; cat.name === category)) { categories.push({ name: category,
path: '' }); } // Contadores let agregados = 0; let duplicados = 0; // Procesar cada guion guiones.forEach((contenidoRaw, index) =&#62; { // --- APLICAR FILTROS --- const contenido = processTextReplacement(contenidoRaw.trim(), category); // -----------------------
// Verificar si ya existe (comparando contenido exacto en la misma categor&#237;a) const existe = scripts.some(s =&#62; s.content.trim() === contenido &#38;&#38; // Ya comparamos con el contenido filtrado s.category === category ); if (!existe) { // Crear
t&#237;tulo autom&#225;tico const titulo = `${category} ${scripts.filter(s =&#62; s.category === category).length + agregados + 1}`; // Agregar guion scripts.push({ id: Date.now() + index, // Asegurar IDs &#250;nicos title: titulo, category: category,
content: contenido, used: false, createdAt: new Date().toISOString() }); agregados++; } else { duplicados++; } }); // Guardar y actualizar UI if (agregados &#62; 0) { saveData(); updateUI(); } // Mostrar resultado let mensaje = ''; if (agregados &#62;
0 &#38;&#38; duplicados === 0) { mensaje = `&#10003; ${agregados} guion(es) agregado(s) exitosamente`; showBulkResult('success', mensaje); } else if (agregados &#62; 0 &#38;&#38; duplicados &#62; 0) { mensaje = `&#10003; ${agregados} agregado(s), ${duplicados}
duplicado(s) omitido(s)`; showBulkResult('warning', mensaje); } else if (agregados === 0 &#38;&#38; duplicados &#62; 0) { mensaje = `&#9888; Todos los guiones ya existen (${duplicados} duplicados)`; showBulkResult('warning', mensaje); } // Limpiar campos
document.getElementById('bulkScriptContent').value = ''; resetBulkFileInput(); // Restaurar bot&#243;n setTimeout(() =&#62; { resetBulkButton(); }, 2000); } function showBulkResult(type, message) { const resultDiv = document.getElementById('bulkResult');
const resultText = document.getElementById('bulkResultText'); resultDiv.className = 'bulk-result ' + type; resultText.textContent = message; // Ocultar despu&#233;s de 5 segundos setTimeout(() =&#62; { resultDiv.className = 'bulk-result'; }, 5000); }
function resetBulkButton() { const btn = document.getElementById('btnBulkAdd'); btn.disabled = false; btn.innerHTML = ` &#60;svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;path d="M21 15v4a2
2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"&#62;&#60;/path&#62; &#60;polyline points="17 8 12 3 7 8"&#62;&#60;/polyline&#62; &#60;line x1="12" y1="3" x2="12" y2="15"&#62;&#60;/line&#62; &#60;/svg&#62; Agregar Guiones Masivos `; } // ============================================
// FIN DE FUNCIONES DE CARGA MASIVA // ============================================ // ============================================ // FUNCIONES DE CONFIGURACI&#211;N // ============================================ function openConfigModal() { // Cargar
valores para Contenido Corto document.getElementById('configCharactersShort').value = config.formulas.short.charactersPerScene; document.getElementById('configSecondsShort').value = config.formulas.short.secondsPerScene; // Cargar valores para Contenido
Largo document.getElementById('configCharactersLong').value = config.formulas.long.charactersPerScene; document.getElementById('configSecondsLong').value = config.formulas.long.secondsPerScene; // Cargar valor de Coherencia document.getElementById('configSceneCoherenceLength').value
= config.sceneCoherenceLength; updateConfigDisplay(); renderConfigPrompts(); renderConfigFilters(); // Asegurarse de que los filtros tambi&#233;n se rendericen document.getElementById('configModal').classList.add('active'); } // Despu&#233;s: function
updateConfigDisplay() { // Contenido Corto const charsShort = document.getElementById('configCharactersShort').value; const secondsShort = document.getElementById('configSecondsShort').value; document.getElementById('configCharactersShortDisplay').textContent
= charsShort; document.getElementById('configSecondsShortDisplay').innerHTML = `${secondsShort}&#60;span style="font-size: 14px;"&#62;s&#60;/span&#62;`; // Contenido Largo const charsLong = document.getElementById('configCharactersLong').value; const
secondsLong = document.getElementById('configSecondsLong').value; document.getElementById('configCharactersLongDisplay').textContent = charsLong; document.getElementById('configSecondsLongDisplay').innerHTML = `${secondsLong}&#60;span style="font-size:
14px;"&#62;s&#60;/span&#62;`; // Coherencia const coherence = document.getElementById('configSceneCoherenceLength').value; document.getElementById('configCoherenceDisplay').innerHTML = `${coherence}&#60;span style="font-size: 14px; font-weight: 400; color:
#737373;"&#62; escenas&#60;/span&#62;`; } function renderConfigPrompts() { const container = document.getElementById('configPromptsContainer'); if (categories.length === 0) { container.innerHTML = ` &#60;div style="text-align: center; padding: 48px 20px;
color: #a3a3a3;"&#62; &#60;svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" style="margin: 0 auto 16px; opacity: 0.5;"&#62; &#60;path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2
2 0 0 1 2 2z"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;p style="font-size: 14px; margin: 0;"&#62;No hay categor&#237;as creadas todav&#237;a&#60;/p&#62; &#60;p style="font-size: 12px; margin-top: 4px; color: #d4d4d4;"&#62;Crea una categor&#237;a para configurar
sus prompts de IA&#60;/p&#62; &#60;/div&#62; `; return; } container.innerHTML = categories.map((cat, index) =&#62; { const scriptCount = scripts.filter(s =&#62; s.category === cat.name).length; return ` &#60;div class="prompt-category-card"&#62; &#60;div
class="prompt-category-header" onclick="togglePromptCard(${index})"&#62; &#60;div class="prompt-category-info"&#62; &#60;div class="prompt-category-icon"&#62; &#60;svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"&#62;
&#60;path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;/div&#62; &#60;div&#62; &#60;div class="prompt-category-title"&#62;${cat.name}&#60;/div&#62; &#60;div class="prompt-category-count"&#62;${scriptCount}
guion${scriptCount !== 1 ? 'es' : ''}&#60;/div&#62; &#60;/div&#62; &#60;/div&#62; &#60;svg class="prompt-chevron" id="chevron_${index}" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;polyline points="6
9 12 15 18 9"&#62;&#60;/polyline&#62; &#60;/svg&#62; &#60;/div&#62; &#60;div class="prompt-category-body" id="promptBody_${index}"&#62; &#60;textarea id="configPrompt_${index}" class="prompt-textarea" placeholder="Escribe el prompt de generaci&#243;n
aqu&#237;..." &#62;${cat.promptTemplate || DEFAULT_PROMPT_TEMPLATE}&#60;/textarea&#62; &#60;div class="prompt-hint"&#62; &#60;svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;circle cx="12" cy="12"
r="10"&#62;&#60;/circle&#62; &#60;line x1="12" y1="16" x2="12" y2="12"&#62;&#60;/line&#62; &#60;line x1="12" y1="8" x2="12.01" y2="8"&#62;&#60;/line&#62; &#60;/svg&#62; &#60;span&#62;Usa &#60;code&#62;(X)&#60;/code&#62; donde quieras que aparezca el n&#250;mero
de escenas&#60;/span&#62; &#60;/div&#62; &#60;/div&#62; &#60;/div&#62; `; }).join(''); } // Funci&#243;n para expandir/colapsar tarjetas de prompts function togglePromptCard(index) { const body = document.getElementById(`promptBody_${index}`); const chevron
= document.getElementById(`chevron_${index}`); const header = body.previousElementSibling; body.classList.toggle('active'); chevron.classList.toggle('active'); header.classList.toggle('active'); } function saveConfiguration() { // Guardar valores de f&#243;rmula
para Contenido Corto config.formulas.short.charactersPerScene = parseInt(document.getElementById('configCharactersShort').value); config.formulas.short.secondsPerScene = parseInt(document.getElementById('configSecondsShort').value); // Guardar valores
de f&#243;rmula para Contenido Largo config.formulas.long.charactersPerScene = parseInt(document.getElementById('configCharactersLong').value); config.formulas.long.secondsPerScene = parseInt(document.getElementById('configSecondsLong').value); // Guardar
valor de Coherencia config.sceneCoherenceLength = parseInt(document.getElementById('configSceneCoherenceLength').value); categories.forEach((cat, index) =&#62; { const promptTextarea = document.getElementById(`configPrompt_${index}`); if (promptTextarea)
{ cat.promptTemplate = promptTextarea.value.trim() || DEFAULT_PROMPT_TEMPLATE; } }); // Guardar en localStorage saveData(); // Cerrar modal closeModal('configModal'); // Mostrar confirmaci&#243;n const btn = event.target; const originalHTML = btn.innerHTML;
btn.innerHTML = ` &#60;svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 6px;"&#62; &#60;polyline points="20 6 9 17 4 12"&#62;&#60;/polyline&#62; &#60;/svg&#62; &#161;Guardado! `; btn.style.background
= '#22c55e'; setTimeout(() =&#62; { btn.innerHTML = originalHTML; btn.style.background = ''; }, 2000); // Si hay un guion abierto, actualizar sus c&#225;lculos const viewModal = document.getElementById('viewModal'); if (viewModal.classList.contains('active')
&#38;&#38; currentViewIndex &#62;= 0 &#38;&#38; filteredScripts[currentViewIndex]) { const script = filteredScripts[currentViewIndex]; // Recalcular const scenes = calculateScenes(script.content); const duration = calculateDuration(scenes); document.getElementById('viewScenes').textContent
= scenes; document.getElementById('viewDuration').textContent = formatDuration(duration); document.getElementById('viewSecondsTotal').textContent = duration; // Actualizar prompt si existe const category = categories.find(cat =&#62; cat.name === script.category);
const promptText = document.getElementById('promptText'); const promptContainer = document.getElementById('promptContainer'); if (category &#38;&#38; category.promptTemplate &#38;&#38; promptContainer.style.display !== 'none') { const resolvedPrompt =
resolvePromptTemplate(category.promptTemplate, scenes); promptText.textContent = resolvedPrompt; } } } // ============================================ // FIN DE FUNCIONES DE CONFIGURACI&#211;N // ============================================ // Funci&#243;n
para cambiar entre pesta&#241;as de configuraci&#243;n function switchConfigTab(tabName) { // Actualizar botones de pesta&#241;as const tabs = document.querySelectorAll('.config-tab-button'); tabs.forEach(tab =&#62; tab.classList.remove('active')); //
Actualizar contenido de pesta&#241;as const contents = document.querySelectorAll('.config-tab-content'); contents.forEach(content =&#62; content.classList.remove('active')); if (tabName === 'formulas') { tabs[0].classList.add('active'); document.getElementById('configTabFormulas').classList.add('active');
} else if (tabName === 'prompts') { tabs[1].classList.add('active'); document.getElementById('configTabPrompts').classList.add('active'); } else if (tabName === 'filters') { // &#60;--- NUEVO BLOQUE tabs[2].classList.add('active'); document.getElementById('configTabFilters').classList.add('active');
renderConfigFilters(); // Funci&#243;n que crearemos en el siguiente paso } } // ============================================ // SISTEMA DE CONFIRMACI&#195;N IN-APP // ============================================ // ============================================
// L&#211;GICA DE FILTROS Y REEMPLAZO (NUEVO) // ============================================ function renderConfigFilters() { // 1. Renderizar selector de categor&#237;as const catSelector = document.getElementById('newFilterCategories'); if(catSelector)
{ catSelector.innerHTML = ''; // Opci&#243;n "Todas" const allOption = document.createElement('div'); allOption.className = 'cat-tag-option'; allOption.textContent = 'Todas'; allOption.onclick = function() { // Si seleccionas "Todas", desmarca las dem&#225;s
const siblings = this.parentElement.children; for(let el of siblings) el.classList.remove('selected'); this.classList.add('selected'); }; catSelector.appendChild(allOption); categories.forEach(cat =&#62; { const opt = document.createElement('div'); opt.className
= 'cat-tag-option'; opt.textContent = cat.name; opt.dataset.value = cat.name; opt.onclick = function() { // Si seleccionas una espec&#237;fica, desmarca "Todas" allOption.classList.remove('selected'); this.classList.toggle('selected'); }; catSelector.appendChild(opt);
}); } // 2. Renderizar lista de filtros activos const list = document.getElementById('activeFiltersList'); if(list) { list.innerHTML = ''; if (wordFilters.length === 0) { list.innerHTML = '&#60;div style="text-align:center; padding: 20px; color:#a3a3a3;
font-size:13px;"&#62;No hay reglas de reemplazo activas&#60;/div&#62;'; return; } wordFilters.forEach((filter, index) =&#62; { const item = document.createElement('div'); item.className = 'filter-item-card'; // Mostrar categor&#237;as bonitas const catsDisplay
= filter.categories.includes('all') ? '&#60;span class="mini-cat-badge"&#62;Todas las categor&#237;as&#60;/span&#62;' : filter.categories.map(c =&#62; `&#60;span class="mini-cat-badge"&#62;${c}&#60;/span&#62;`).join(''); item.innerHTML = ` &#60;div style="flex:1;"&#62;
&#60;div class="filter-words-display"&#62; &#60;span&#62;${filter.original}&#60;/span&#62; &#60;svg class="filter-replacement-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62; &#60;line x1="5" y1="12"
x2="19" y2="12"&#62;&#60;/line&#62; &#60;polyline points="12 5 19 12 12 19"&#62;&#60;/polyline&#62; &#60;/svg&#62; &#60;span style="color: #2563eb;"&#62;${filter.replacement}&#60;/span&#62; &#60;/div&#62; &#60;div class="filter-categories-badges"&#62;
${catsDisplay} &#60;/div&#62; &#60;/div&#62; &#60;button class="icon-btn delete" onclick="deleteFilter(${index})" title="Eliminar regla" style="width:32px; height:32px;"&#62; &#60;svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
stroke-width="2"&#62; &#60;polyline points="3 6 5 6 21 6"&#62;&#60;/polyline&#62; &#60;path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"&#62;&#60;/path&#62; &#60;/svg&#62; &#60;/button&#62; `; list.appendChild(item);
}); } } function addNewFilter() { const original = document.getElementById('newFilterOriginal').value.trim(); const replacement = document.getElementById('newFilterReplacement').value.trim(); // Obtener categor&#237;as seleccionadas const selectedCats
= []; const options = document.querySelectorAll('#newFilterCategories .cat-tag-option.selected'); options.forEach(opt =&#62; { if (opt.textContent === 'Todas') selectedCats.push('all'); else selectedCats.push(opt.dataset.value); }); if (!original || !replacement)
{ alert('Por favor completa la palabra original y su reemplazo.'); return; } if (selectedCats.length === 0) { alert('Selecciona al menos una categor&#237;a para aplicar el filtro.'); return; } wordFilters.push({ id: Date.now(), original, replacement,
categories: selectedCats }); saveData(); renderConfigFilters(); // Limpiar inputs document.getElementById('newFilterOriginal').value = ''; document.getElementById('newFilterReplacement').value = ''; document.querySelectorAll('.cat-tag-option').forEach(el
=&#62; el.classList.remove('selected')); } function deleteFilter(index) { if(confirm('&#191;Eliminar esta regla de reemplazo?')) { wordFilters.splice(index, 1); saveData(); renderConfigFilters(); } } // FUNCI&#211;N DE PROCESAMIENTO PRINCIPAL (El Cerebro)
function processTextReplacement(text, categoryName) { if (!text) return text; let processedText = text; wordFilters.forEach(filter =&#62; { // Verificar si aplica a esta categor&#237;a o a "todas" const applies = filter.categories.includes('all') || filter.categories.includes(categoryName);
if (applies) { // Crear Regex Global Case-Insensitive para reemplazar todas las ocurrencias // Escapamos caracteres especiales para evitar errores de regex const escapedOriginal = filter.original.replace(/[.*+?^${}()|[\]\\]/g, '\\$&#38;'); // Usamos 'gi'
para que sea global e ignore may&#250;sculas/min&#250;sculas const regex = new RegExp(escapedOriginal, 'gi'); processedText = processedText.replace(regex, filter.replacement); } }); return processedText; } function showConfirmDialog(title, message, callback)
{ confirmCallback = callback; document.getElementById('confirmTitle').textContent = title; document.getElementById('confirmMessage').textContent = message; document.getElementById('confirmDialog').classList.add('active'); } function closeConfirmDialog()
{ document.getElementById('confirmDialog').classList.remove('active'); confirmCallback = null; } function confirmDelete() { if (confirmCallback) { confirmCallback(); closeConfirmDialog(); } } // ============================================ // SISTEMA
DE SELECCI&#195;N M&#195;LTIPLE // ============================================ function toggleSelectionMode() { selectionMode = !selectionMode; selectedScripts.clear(); const btn = document.getElementById('btnSelectMode'); const bar = document.getElementById('selectionModeBar');
if (selectionMode) { btn.classList.add('active'); bar.classList.add('active'); } else { btn.classList.remove('active'); bar.classList.remove('active'); } updateSelectionCount(); renderScripts(); } function cancelSelectionMode() { selectionMode = false;
selectedScripts.clear(); document.getElementById('btnSelectMode').classList.remove('active'); document.getElementById('selectionModeBar').classList.remove('active'); renderScripts(); } function toggleScriptSelection(scriptId) { if (selectedScripts.has(scriptId))
{ selectedScripts.delete(scriptId); } else { selectedScripts.add(scriptId); } updateSelectionCount(); renderScripts(); } function updateSelectionCount() { const count = selectedScripts.size; document.getElementById('selectionCount').textContent = count;
} function deleteSelectedScripts() { if (selectedScripts.size === 0) { return; } const count = selectedScripts.size; const message = count === 1 ? 'Se eliminar&#225; permanentemente 1 gui&#243;n seleccionado.' : `Se eliminar&#225;n permanentemente ${count}
guiones seleccionados.`; showConfirmDialog( `&#191;Eliminar ${count} gui&#243;n${count &#62; 1 ? 'es' : ''}?`, message, () =&#62; { // Eliminar los scripts seleccionados scripts = scripts.filter(s =&#62; !selectedScripts.has(s.id)); // Limpiar selecci&#243;n
selectedScripts.clear(); // Salir del modo selecci&#243;n cancelSelectionMode(); // Guardar y actualizar saveData(); updateUI(); } ); } // ============================================ // FUNCI&#211;N PARA SIDEBAR RESPONSIVA // ============================================
function toggleSidebar() { const sidebar = document.getElementById('mainSidebar'); const overlay = document.getElementById('sidebarOverlay'); const body = document.body; sidebar.classList.toggle('active'); overlay.classList.toggle('active'); // Prevenir
scroll del body cuando sidebar est&#225; abierto if (sidebar.classList.contains('active')) { body.style.overflow = 'hidden'; } else { body.style.overflow = ''; } } // Cerrar sidebar al hacer clic en una categor&#237;a (solo en m&#243;viles) const originalFilterCategory
= window.filterCategory; window.filterCategory = function(category) { originalFilterCategory(category); // Cerrar sidebar solo si est&#225; visible (m&#243;viles) if (window.innerWidth &#60;= 900) { const sidebar = document.getElementById('mainSidebar');
const overlay = document.getElementById('sidebarOverlay'); if (sidebar &#38;&#38; sidebar.classList.contains('active')) { sidebar.classList.remove('active'); overlay.classList.remove('active'); document.body.style.overflow = ''; } } }; // ============================================
// FIN DE FUNCI&#211;N SIDEBAR RESPONSIVA // ============================================ // ============================================ // M&#211;DULO DE REFERENCIAS VISUALES // ============================================ let currentEditingCategory
= null; let tempVisualReferences = { asunto: null, escena: null, estilo: null }; // === INICIO C&#211;DIGO NUEVO === let tempCustomVisuals = { asunto: null, escena: null, estilo: null }; // === FIN C&#211;DIGO NUEVO === function loadVisualReferences(references)
{ tempVisualReferences = { asunto: references.asunto || null, escena: references.escena || null, estilo: references.estilo || null }; // Cargar vista previa de cada referencia ['asunto', 'escena', 'estilo'].forEach(type =&#62; { const preview = document.getElementById(`preview${type.charAt(0).toUpperCase()
+ type.slice(1)}`); const btnRemove = document.getElementById(`btnRemove${type.charAt(0).toUpperCase() + type.slice(1)}`); if (tempVisualReferences[type]) { // Mostrar imagen preview.innerHTML = `&#60;img src="${tempVisualReferences[type]}" alt="Referencia
${type}"&#62;`; preview.classList.add('has-image'); btnRemove.disabled = false; } else { // Mostrar placeholder resetReferencePreview(type); } }); } function handleReferenceUpload(type, event) { const file = event.target.files[0]; if (!file) return; //
Validar que sea una imagen if (!file.type.startsWith('image/')) { alert('Por favor, selecciona un archivo de imagen v&#225;lido'); event.target.value = ''; return; } // Validar tama&#241;o (m&#225;ximo 5MB) if (file.size &#62; 5 * 1024 * 1024) { alert('La
imagen es demasiado grande. El tama&#241;o m&#225;ximo es 5MB'); event.target.value = ''; return; } const reader = new FileReader(); reader.onload = function(e) { const base64String = e.target.result; // Guardar en objeto temporal tempVisualReferences[type]
= base64String; // Actualizar vista previa const preview = document.getElementById(`preview${type.charAt(0).toUpperCase() + type.slice(1)}`); const btnRemove = document.getElementById(`btnRemove${type.charAt(0).toUpperCase() + type.slice(1)}`); preview.innerHTML
= `&#60;img src="${base64String}" alt="Referencia ${type}"&#62;`; preview.classList.add('has-image'); btnRemove.disabled = false; }; reader.onerror = function() { alert('Error al leer el archivo. Por favor, intenta de nuevo.'); event.target.value = '';
}; reader.readAsDataURL(file); } function removeReference(type) { // Confirmar eliminaci&#243;n const confirmed = confirm(`&#191;Eliminar la referencia de ${type}?`); if (!confirmed) return; // Limpiar del objeto temporal tempVisualReferences[type] =
null; // Resetear vista previa resetReferencePreview(type); // Limpiar input file const input = document.getElementById(`input${type.charAt(0).toUpperCase() + type.slice(1)}`); input.value = ''; } function resetReferencePreview(type) { const preview =
document.getElementById(`preview${type.charAt(0).toUpperCase() + type.slice(1)}`); const btnRemove = document.getElementById(`btnRemove${type.charAt(0).toUpperCase() + type.slice(1)}`); const placeholders = { asunto: 'Referencia del&#60;br&#62;tema principal',
escena: 'Referencia de&#60;br&#62;composici&#243;n/ambiente', estilo: 'Referencia de&#60;br&#62;est&#233;tica visual' }; preview.innerHTML = ` &#60;div class="visual-reference-placeholder"&#62; &#60;svg width="32" height="32" viewBox="0 0 24 24" fill="none"
stroke="currentColor" stroke-width="1.5"&#62; &#60;rect x="3" y="3" width="18" height="18" rx="2" ry="2"&#62;&#60;/rect&#62; &#60;circle cx="8.5" cy="8.5" r="1.5"&#62;&#60;/circle&#62; &#60;polyline points="21 15 16 10 5 21"&#62;&#60;/polyline&#62; &#60;/svg&#62;
&#60;span class="visual-reference-placeholder-text"&#62;${placeholders[type]}&#60;/span&#62; &#60;/div&#62; `; preview.classList.remove('has-image'); btnRemove.disabled = true; } function downloadReference(type, base64Data, categoryName) { // Convertir
base64 a blob const byteString = atob(base64Data.split(',')[1]); const mimeString = base64Data.split(',')[0].split(':')[1].split(';')[0]; const ab = new ArrayBuffer(byteString.length); const ia = new Uint8Array(ab); for (let i = 0; i &#60; byteString.length;
i++) { ia[i] = byteString.charCodeAt(i); } const blob = new Blob([ab], { type: mimeString }); // Crear enlace de descarga const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href = url; a.download = `${categoryName}_${type}_referencia.${mimeString.split('/')[1]}`;
document.body.appendChild(a); a.click(); document.body.removeChild(a); URL.revokeObjectURL(url); } // DESPU&#201;S (C&#243;digo nuevo y mejorado) function loadReferencesInPromptsModule() { if (currentViewIndex &#60; 0 || !filteredScripts[currentViewIndex])
{ return; } const script = filteredScripts[currentViewIndex]; const category = categories.find(cat =&#62; cat.name === script.category) || {}; // === INICIO L&#211;GICA DE PRIORIDAD NUEVA === const categoryRefs = category.visualReferences || {}; const
scriptRefs = script.customVisuals || {}; // Fusionar, dando prioridad a las referencias del guion const finalRefs = { asunto: scriptRefs.asunto || categoryRefs.asunto || null, escena: scriptRefs.escena || categoryRefs.escena || null, estilo: scriptRefs.estilo
|| categoryRefs.estilo || null, }; // === FIN L&#211;GICA DE PRIORIDAD NUEVA === const hasAnyReference = Object.values(finalRefs).some(ref =&#62; ref !== null); const panel = document.getElementById('promptsReferencesPanel'); if (!hasAnyReference) { panel.style.display
= 'none'; return; } panel.style.display = 'block'; const referencesHTML = ['asunto', 'escena', 'estilo'] .filter(type =&#62; finalRefs[type]) .map(type =&#62; { // ... (El resto de la l&#243;gica de renderizado de esta funci&#243;n permanece igual) ...
const labels = { asunto: 'Asunto', escena: 'Escena', estilo: 'Estilo' }; const icons = { asunto: '&#60;circle cx="12" cy="12" r="10"&#62;&#60;/circle&#62;&#60;circle cx="12" cy="12" r="3"&#62;&#60;/circle&#62;', escena: '&#60;rect x="2" y="7" width="20"
height="14" rx="2" ry="2"&#62;&#60;/rect&#62;&#60;path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"&#62;&#60;/path&#62;', estilo: '&#60;path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"&#62;&#60;/path&#62;' }; const accentColors = { asunto:
'#8b5cf6', escena: '#3b82f6', estilo: '#10b981' }; return ` &#60;div class="prompts-reference-item" style="border-left: 3px solid ${accentColors[type]};"&#62; &#60;div class="prompts-reference-image-container"&#62; &#60;img src="${finalRefs[type]}" alt="Referencia
${type}"&#62; &#60;/div&#62; &#60;button class="btn-download-reference-minimal" onclick="downloadReference('${type}', \`${finalRefs[type]}\`, '${category.name}')" style="background: ${accentColors[type]}15; color: ${accentColors[type]}; border-color:
${accentColors[type]}40;"&#62; &#60;svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"&#62;${icons[type]}&#60;/svg&#62; &#60;span style="font-weight: 600;"&#62;${labels[type]}&#60;/span&#62; &#60;svg width="12"
height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-left: auto;"&#62;&#60;path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"&#62;&#60;/path&#62;&#60;polyline points="7 10 12 15 17 10"&#62;&#60;/polyline&#62;&#60;line
x1="12" y1="15" x2="12" y2="3"&#62;&#60;/line&#62;&#60;/svg&#62; &#60;/button&#62; &#60;/div&#62; `; }) .join(''); const grid = document.getElementById('promptsReferencesGrid'); if (referencesHTML) { grid.innerHTML = referencesHTML; } else { grid.innerHTML
= '&#60;div class="prompts-references-empty"&#62;No hay referencias visuales.&#60;/div&#62;'; } } // ============================================ // FIN DEL M&#211;DULO DE REFERENCIAS VISUALES // ============================================ // ============================================
// GESTI&#211;N DE EXPANSI&#211;N DE PROMPTS LARGOS // ============================================ function togglePromptExpansion() { const contentEl = document.getElementById('promptsCurrentContent'); const btn = document.getElementById('promptsReadMoreBtn');
const btnText = document.getElementById('readMoreBtnText'); contentEl.classList.toggle('expanded'); btn.classList.toggle('expanded'); if (contentEl.classList.contains('expanded')) { btnText.textContent = 'Mostrar Menos'; } else { btnText.textContent =
'Leer M&#225;s'; // Scroll suave al inicio del prompt contentEl.scrollTop = 0; } } function checkPromptHeight() { const contentEl = document.getElementById('promptsCurrentContent'); const btn = document.getElementById('promptsReadMoreBtn'); if (!contentEl
|| !btn) return; // Resetear estado antes de medir contentEl.classList.remove('expanded'); btn.classList.remove('expanded', 'visible'); document.getElementById('readMoreBtnText').textContent = 'Leer M&#225;s'; // Forzar reflow para obtener medidas correctas
contentEl.offsetHeight; // Verificar si el contenido excede la altura m&#225;xima const isOverflowing = contentEl.scrollHeight &#62; contentEl.clientHeight + 20; // +20 de margen if (isOverflowing) { btn.classList.add('visible'); } else { btn.classList.remove('visible');
} } // ============================================ // FIN DE GESTI&#211;N DE EXPANSI&#211;N // ============================================ // Initialize initializeData(); // ============================================ // M&#211;DULO DE GENERACI&#211;N
DE IM&#193;GENES/VIDEO // ============================================ let promptsList = []; let currentPromptIndex = 0; function openPromptsGenerator() { resetPromptsGenerator(); document.getElementById('promptsGeneratorModal').classList.add('active');
loadReferencesInPromptsModule(); document.getElementById('promptsPasteArea').focus(); } function closePromptsGenerator() { document.getElementById('promptsGeneratorModal').classList.remove('active'); } function resetPromptsGenerator() { promptsList =
[]; currentPromptIndex = 0; document.getElementById('promptsPasteArea').value = ''; document.getElementById('promptsWaitingState').classList.add('active'); document.getElementById('promptsActiveState').classList.remove('active'); document.getElementById('promptsCompletedState').classList.remove('active');
} function processPromptsFromTextArea() { const content = document.getElementById('promptsPasteArea').value; const btn = document.getElementById('promptsProcessBtn'); const originalHTML = btn.innerHTML; if (!content || content.trim().length === 0) { alert('El
&#225;rea de texto est&#225; vac&#237;a. Pega los prompts antes de procesar.'); return; } btn.disabled = true; btn.innerHTML = '&#60;span&#62;Procesando...&#60;/span&#62;'; // --- INICIO DE LA MEJORA INTELIGENTE --- // 1. Detecci&#243;n de formato: &#191;Es
una lista numerada? const isNumberedList = /^\s*\d+\.\s/m.test(content); if (isNumberedList) { console.log("Formato de lista numerada detectado."); // L&#243;gica original para listas numeradas const cleanedContent = content.replace(/\*/g, ''); const
promptBlocks = cleanedContent.split(/(?=^\s*\d+\.\s)/m); promptsList = promptBlocks.map(b =&#62; b.trim()).filter(b =&#62; b &#38;&#38; /^\s*\d+\.\s/.test(b)); } else { console.log("Formato de p&#225;rrafos detectado. Procesando por saltos de l&#237;nea.");
// 2. Nueva l&#243;gica para p&#225;rrafos separados por saltos de l&#237;nea // Divide por una o m&#225;s l&#237;neas en blanco, limpia cada p&#225;rrafo y filtra los vac&#237;os. promptsList = content.split(/\n\s*\n+/) .map(p =&#62; p.trim()) .filter(p
=&#62; p.length &#62; 0); } // --- FIN DE LA MEJORA INTELIGENTE --- if (promptsList.length === 0) { // Mensaje de error m&#225;s gen&#233;rico y &#250;til alert('No se detectaron prompts v&#225;lidos. Aseg&#250;rate de que sea una lista numerada (1.,
2., ...) o p&#225;rrafos separados por l&#237;neas en blanco.'); btn.disabled = false; btn.innerHTML = originalHTML; return; } currentPromptIndex = 0; copyPromptToClipboard(promptsList[0]); showCurrentPrompt(); document.getElementById('promptsWaitingState').classList.remove('active');
document.getElementById('promptsActiveState').classList.add('active'); btn.disabled = false; btn.innerHTML = originalHTML; } // *** NUEVA FUNCI&#211;N *** // Lee del portapapeles, lo pega en el textarea y procesa. async function pasteAndProcessFromClipboard()
{ try { // Solicitar permiso y leer el portapapeles const clipboardText = await navigator.clipboard.readText(); if (!clipboardText || clipboardText.trim().length === 0) { alert('El portapapeles est&#225; vac&#237;o.'); return; } // Poner el texto en el
textarea document.getElementById('promptsPasteArea').value = clipboardText; // Llamar a la funci&#243;n de procesamiento existente processPromptsFromTextArea(); } catch (err) { console.error('Error al leer el portapapeles:', err); alert('No se pudo acceder
al portapapeles. Aseg&#250;rate de haber concedido los permisos necesarios al navegador.'); } } async function copyPromptToClipboard(promptText) { try { await navigator.clipboard.writeText(promptText); } catch (err) { console.error('Error al copiar autom&#225;ticamente:',
err); } } function showCurrentPrompt() { const prompt = promptsList[currentPromptIndex]; // Limpiamos el prompt de n&#250;meros y asteriscos para mostrarlo limpio const match = prompt.match(/^\s*\d+\.\s*(.*)$/s); const displayText = match ? match[1].trim().replace(/\*/g,
'') : prompt.trim().replace(/\*/g, ''); document.getElementById('promptsCurrentContent').textContent = displayText; document.getElementById('promptsCurrentBadge').textContent = `Prompt ${currentPromptIndex + 1} de ${promptsList.length}`; // --- NUEVA
L&#211;GICA DEL LED DE COHERENCIA --- const led = document.getElementById('sceneCoherenceLed'); const cycleLength = config.sceneCoherenceLength; // Si el ciclo es 0 o 1, la funci&#243;n est&#225; desactivada. El LED permanece apagado (gris). if (cycleLength
&#60;= 1) { led.className = 'scene-coherence-led'; led.title = 'Ciclo de coherencia desactivado.'; } else { // El &#237;ndice dentro del ciclo actual (0 es el primero, 1 es el segundo, etc.) const indexInCycle = currentPromptIndex % cycleLength; if (indexInCycle
=== 0) { // Es el PRIMER prompt del ciclo: LED de CREACI&#211;N (Naranja) led.className = 'scene-coherence-led creation'; led.title = `NUEVO CICLO: Crea una nueva escena base (${currentPromptIndex + 1}/${promptsList.length})`; } else { // Es un prompt
DENTRO del ciclo: LED de COHERENCIA (Verde) led.className = 'scene-coherence-led coherence'; led.title = `MANTENER COHERENCIA: Sigue el estilo de la escena anterior (${indexInCycle + 1}/${cycleLength})`; } } // --- FIN DE LA NUEVA L&#211;GICA --- setTimeout(checkPromptHeight,
50); const nextBtn = document.getElementById('promptsNextBtn'); const nextBtnText = document.getElementById('promptsNextBtnText'); if (currentPromptIndex === promptsList.length - 1) { nextBtnText.textContent = 'Finalizar'; nextBtn.classList.add('finish');
} else { nextBtnText.textContent = 'Siguiente Prompt'; nextBtn.classList.remove('finish'); } document.getElementById('promptsPrevBtn').disabled = currentPromptIndex === 0; const copyBtn = document.getElementById('promptsCopyBtn'); copyBtn.classList.remove('copied');
document.getElementById('promptsCopyBtnText').textContent = 'Copiar Prompt'; } async function copyCurrentPrompt() { if (!promptsList[currentPromptIndex]) return; await copyPromptToClipboard(promptsList[currentPromptIndex]); const copyBtn = document.getElementById('promptsCopyBtn');
copyBtn.classList.add('copied'); document.getElementById('promptsCopyBtnText').textContent = '&#161;Copiado!'; } async function nextPrompt() { if (currentPromptIndex &#60; promptsList.length - 1) { currentPromptIndex++; await copyPromptToClipboard(promptsList[currentPromptIndex]);
showCurrentPrompt(); } else { showCompletedState(); } } async function prevPrompt() { if (currentPromptIndex &#62; 0) { currentPromptIndex--; await copyPromptToClipboard(promptsList[currentPromptIndex]); showCurrentPrompt(); } } function showCompletedState()
{ document.getElementById('promptsActiveState').classList.remove('active'); document.getElementById('promptsCompletedState').classList.add('active'); } // ============================================ // GESTI&#211;N DE EXPANSI&#211;N DE PROMPTS LARGOS
// ============================================ function togglePromptExpansion() { const contentEl = document.getElementById('promptsCurrentContent'); const btn = document.getElementById('promptsReadMoreBtn'); contentEl.classList.toggle('expanded'); btn.classList.toggle('expanded');
btn.querySelector('span').textContent = contentEl.classList.contains('expanded') ? 'Mostrar Menos' : 'Leer M&#225;s'; if (!contentEl.classList.contains('expanded')) contentEl.scrollTop = 0; } function checkPromptHeight() { const contentEl = document.getElementById('promptsCurrentContent');
const btn = document.getElementById('promptsReadMoreBtn'); if (!contentEl || !btn) return; contentEl.classList.remove('expanded'); btn.classList.remove('expanded', 'visible'); btn.querySelector('span').textContent = 'Leer M&#225;s'; const isOverflowing
= contentEl.scrollHeight &#62; contentEl.clientHeight; if (isOverflowing) { btn.classList.add('visible'); } } function selectCategoryType(selectedButton, containerId) { const container = document.getElementById(containerId); container.querySelectorAll('.filter-option').forEach(btn
=&#62; btn.classList.remove('active')); selectedButton.classList.add('active'); } // === INICIO C&#211;DIGO NUEVO: L&#243;gica del editor de referencias personalizadas === function loadCustomVisualsEditor(customRefs, categoryRefs) { customRefs = customRefs
|| {}; categoryRefs = categoryRefs || {}; // Inicializar estado temporal tempCustomVisuals = { asunto: customRefs.asunto || null, escena: customRefs.escena || null, estilo: customRefs.estilo || null, }; ['asunto', 'escena', 'estilo'].forEach(type =&#62;
{ const previewEl = document.getElementById(`editScriptPreview${type.charAt(0).toUpperCase() + type.slice(1)}`); const btnRemoveEl = document.getElementById(`editScriptBtnRemove${type.charAt(0).toUpperCase() + type.slice(1)}`); const inputEl = document.getElementById(`editScriptInput${type.charAt(0).toUpperCase()
+ type.slice(1)}`); // Limpiar input de archivo if (inputEl) inputEl.value = ''; // Prioridad 1: Mostrar referencia personalizada si existe if (tempCustomVisuals[type]) { previewEl.innerHTML = `&#60;img src="${tempCustomVisuals[type]}" alt="Referencia
personalizada de ${type}"&#62;`; previewEl.classList.remove('fallback-preview'); btnRemoveEl.disabled = false; } // Prioridad 2: Mostrar referencia de categor&#237;a como gu&#237;a else if (categoryRefs[type]) { previewEl.innerHTML = `&#60;img src="${categoryRefs[type]}"
alt="Referencia de categor&#237;a (por defecto)"&#62;`; previewEl.classList.add('fallback-preview'); btnRemoveEl.disabled = true; // No se puede quitar la de la categor&#237;a desde aqu&#237; } // Prioridad 3: Mostrar placeholder si no hay ninguna else
{ previewEl.innerHTML = ` &#60;div class="visual-reference-placeholder"&#62; &#60;svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"&#62;&#60;rect x="3" y="3" width="18" height="18" rx="2" ry="2"&#62;&#60;/rect&#62;&#60;circle
cx="8.5" cy="8.5" r="1.5"&#62;&#60;/circle&#62;&#60;polyline points="21 15 16 10 5 21"&#62;&#60;/polyline&#62;&#60;/svg&#62; &#60;span class="visual-reference-placeholder-text"&#62;Sin referencia&#60;/span&#62; &#60;/div&#62;`; previewEl.classList.remove('fallback-preview');
btnRemoveEl.disabled = true; } }); } function handleCustomReferenceUpload(type, event) { const file = event.target.files[0]; if (!file) return; if (!file.type.startsWith('image/')) { alert('Por favor, selecciona un archivo de imagen.'); return; } if (file.size
&#62; 5 * 1024 * 1024) { // 5MB limit alert('La imagen es demasiado grande. El l&#237;mite es 5MB.'); return; } const reader = new FileReader(); reader.onload = function(e) { const base64String = e.target.result; tempCustomVisuals[type] = base64String;
// Actualizar UI const previewEl = document.getElementById(`editScriptPreview${type.charAt(0).toUpperCase() + type.slice(1)}`); const btnRemoveEl = document.getElementById(`editScriptBtnRemove${type.charAt(0).toUpperCase() + type.slice(1)}`); previewEl.innerHTML
= `&#60;img src="${base64String}" alt="Nueva referencia de ${type}"&#62;`; previewEl.classList.remove('fallback-preview'); btnRemoveEl.disabled = false; }; reader.readAsDataURL(file); } function removeCustomReference(type) { if (confirm(`&#191;Quitar
la referencia personalizada para "${type}"? Se usar&#225; la de la categor&#237;a si existe.`)) { tempCustomVisuals[type] = null; // Volver a cargar el editor para que muestre el fallback de la categor&#237;a o el placeholder const scriptId = parseInt(document.getElementById('editScriptId').value);
const script = scripts.find(s =&#62; s.id === scriptId); const category = categories.find(cat =&#62; cat.name === script.category) || {}; // Creamos un objeto `customRefs` actualizado para la recarga const updatedCustomRefs = { ...script.customVisuals
}; delete updatedCustomRefs[type]; // Eliminamos la clave para que la funci&#243;n sepa que ya no existe loadCustomVisualsEditor(updatedCustomRefs, category.visualReferences); } } // === FIN C&#211;DIGO NUEVO === &#60;/script&#62; &#60;/body&#62; &#60;/html&#62;
